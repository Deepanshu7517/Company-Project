(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Ts,ie,ac,Sr,ll,lc,uc,cc,Ho,uo,co,hc,Xn={},dc=[],xd=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ui=Array.isArray;function qt(r,e){for(var t in e)r[t]=e[t];return r}function qo(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function re(r,e,t){var n,i,s,a={};for(s in e)s=="key"?n=e[s]:s=="ref"?i=e[s]:a[s]=e[s];if(arguments.length>2&&(a.children=arguments.length>3?Ts.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(s in r.defaultProps)a[s]===void 0&&(a[s]=r.defaultProps[s]);return Ki(r,a,n,i,null)}function Ki(r,e,t,n,i){var s={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++ac,__i:-1,__u:0};return i==null&&ie.vnode!=null&&ie.vnode(s),s}function It(r){return r.children}function xt(r,e){this.props=r,this.context=e}function un(r,e){if(e==null)return r.__?un(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?un(r):null}function fc(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return fc(r)}}function ho(r){(!r.__d&&(r.__d=!0)&&Sr.push(r)&&!os.__r++||ll!=ie.debounceRendering)&&((ll=ie.debounceRendering)||lc)(os)}function os(){for(var r,e,t,n,i,s,a,l=1;Sr.length;)Sr.length>l&&Sr.sort(uc),r=Sr.shift(),l=Sr.length,r.__d&&(t=void 0,i=(n=(e=r).__v).__e,s=[],a=[],e.__P&&((t=qt({},n)).__v=n.__v+1,ie.vnode&&ie.vnode(t),Wo(e.__P,t,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,s,i??un(n),!!(32&n.__u),a),t.__v=n.__v,t.__.__k[t.__i]=t,gc(s,t,a),t.__e!=i&&fc(t)));os.__r=0}function pc(r,e,t,n,i,s,a,l,c,h,p){var f,g,E,C,M,V,x,k=n&&n.__k||dc,F=e.length;for(c=kd(t,e,k,c,F),f=0;f<F;f++)(E=t.__k[f])!=null&&(g=E.__i==-1?Xn:k[E.__i]||Xn,E.__i=f,V=Wo(r,E,g,i,s,a,l,c,h,p),C=E.__e,E.ref&&g.ref!=E.ref&&(g.ref&&Go(g.ref,null,E),p.push(E.ref,E.__c||C,E)),M==null&&C!=null&&(M=C),(x=!!(4&E.__u))||g.__k===E.__k?c=mc(E,c,r,x):typeof E.type=="function"&&V!==void 0?c=V:C&&(c=C.nextSibling),E.__u&=-7);return t.__e=M,c}function kd(r,e,t,n,i){var s,a,l,c,h,p=t.length,f=p,g=0;for(r.__k=new Array(i),s=0;s<i;s++)(a=e[s])!=null&&typeof a!="boolean"&&typeof a!="function"?(c=s+g,(a=r.__k[s]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?Ki(null,a,null,null,null):ui(a)?Ki(It,{children:a},null,null,null):a.constructor==null&&a.__b>0?Ki(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=r,a.__b=r.__b+1,l=null,(h=a.__i=Ld(a,t,c,f))!=-1&&(f--,(l=t[h])&&(l.__u|=2)),l==null||l.__v==null?(h==-1&&(i>p?g--:i<p&&g++),typeof a.type!="function"&&(a.__u|=4)):h!=c&&(h==c-1?g--:h==c+1?g++:(h>c?g--:g++,a.__u|=4))):r.__k[s]=null;if(f)for(s=0;s<p;s++)(l=t[s])!=null&&(2&l.__u)==0&&(l.__e==n&&(n=un(l)),yc(l,l));return n}function mc(r,e,t,n){var i,s;if(typeof r.type=="function"){for(i=r.__k,s=0;i&&s<i.length;s++)i[s]&&(i[s].__=r,e=mc(i[s],e,t,n));return e}r.__e!=e&&(n&&(e&&r.type&&!e.parentNode&&(e=un(r)),t.insertBefore(r.__e,e||null)),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function as(r,e){return e=e||[],r==null||typeof r=="boolean"||(ui(r)?r.some(function(t){as(t,e)}):e.push(r)),e}function Ld(r,e,t,n){var i,s,a,l=r.key,c=r.type,h=e[t],p=h!=null&&(2&h.__u)==0;if(h===null&&r.key==null||p&&l==h.key&&c==h.type)return t;if(n>(p?1:0)){for(i=t-1,s=t+1;i>=0||s<e.length;)if((h=e[a=i>=0?i--:s++])!=null&&(2&h.__u)==0&&l==h.key&&c==h.type)return a}return-1}function ul(r,e,t){e[0]=="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||xd.test(e)?t:t+"px"}function Fi(r,e,t,n,i){var s,a;e:if(e=="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||ul(r.style,e,"");if(t)for(e in t)n&&t[e]==n[e]||ul(r.style,e,t[e])}else if(e[0]=="o"&&e[1]=="n")s=e!=(e=e.replace(cc,"$1")),a=e.toLowerCase(),e=a in r||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),r.l||(r.l={}),r.l[e+s]=t,t?n?t.u=n.u:(t.u=Ho,r.addEventListener(e,s?co:uo,s)):r.removeEventListener(e,s?co:uo,s);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function cl(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=Ho++;else if(e.t<t.u)return;return t(ie.event?ie.event(e):e)}}}function Wo(r,e,t,n,i,s,a,l,c,h){var p,f,g,E,C,M,V,x,k,F,J,Q,P,I,_,y,T,A=e.type;if(e.constructor!=null)return null;128&t.__u&&(c=!!(32&t.__u),s=[l=e.__e=t.__e]),(p=ie.__b)&&p(e);e:if(typeof A=="function")try{if(x=e.props,k="prototype"in A&&A.prototype.render,F=(p=A.contextType)&&n[p.__c],J=p?F?F.props.value:p.__:n,t.__c?V=(f=e.__c=t.__c).__=f.__E:(k?e.__c=f=new A(x,J):(e.__c=f=new xt(x,J),f.constructor=A,f.render=Od),F&&F.sub(f),f.props=x,f.state||(f.state={}),f.context=J,f.__n=n,g=f.__d=!0,f.__h=[],f._sb=[]),k&&f.__s==null&&(f.__s=f.state),k&&A.getDerivedStateFromProps!=null&&(f.__s==f.state&&(f.__s=qt({},f.__s)),qt(f.__s,A.getDerivedStateFromProps(x,f.__s))),E=f.props,C=f.state,f.__v=e,g)k&&A.getDerivedStateFromProps==null&&f.componentWillMount!=null&&f.componentWillMount(),k&&f.componentDidMount!=null&&f.__h.push(f.componentDidMount);else{if(k&&A.getDerivedStateFromProps==null&&x!==E&&f.componentWillReceiveProps!=null&&f.componentWillReceiveProps(x,J),!f.__e&&f.shouldComponentUpdate!=null&&f.shouldComponentUpdate(x,f.__s,J)===!1||e.__v==t.__v){for(e.__v!=t.__v&&(f.props=x,f.state=f.__s,f.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(R){R&&(R.__=e)}),Q=0;Q<f._sb.length;Q++)f.__h.push(f._sb[Q]);f._sb=[],f.__h.length&&a.push(f);break e}f.componentWillUpdate!=null&&f.componentWillUpdate(x,f.__s,J),k&&f.componentDidUpdate!=null&&f.__h.push(function(){f.componentDidUpdate(E,C,M)})}if(f.context=J,f.props=x,f.__P=r,f.__e=!1,P=ie.__r,I=0,k){for(f.state=f.__s,f.__d=!1,P&&P(e),p=f.render(f.props,f.state,f.context),_=0;_<f._sb.length;_++)f.__h.push(f._sb[_]);f._sb=[]}else do f.__d=!1,P&&P(e),p=f.render(f.props,f.state,f.context),f.state=f.__s;while(f.__d&&++I<25);f.state=f.__s,f.getChildContext!=null&&(n=qt(qt({},n),f.getChildContext())),k&&!g&&f.getSnapshotBeforeUpdate!=null&&(M=f.getSnapshotBeforeUpdate(E,C)),y=p,p!=null&&p.type===It&&p.key==null&&(y=_c(p.props.children)),l=pc(r,ui(y)?y:[y],e,t,n,i,s,a,l,c,h),f.base=e.__e,e.__u&=-161,f.__h.length&&a.push(f),V&&(f.__E=f.__=null)}catch(R){if(e.__v=null,c||s!=null)if(R.then){for(e.__u|=c?160:128;l&&l.nodeType==8&&l.nextSibling;)l=l.nextSibling;s[s.indexOf(l)]=null,e.__e=l}else{for(T=s.length;T--;)qo(s[T]);fo(e)}else e.__e=t.__e,e.__k=t.__k,R.then||fo(e);ie.__e(R,e,t)}else s==null&&e.__v==t.__v?(e.__k=t.__k,e.__e=t.__e):l=e.__e=Md(t.__e,e,t,n,i,s,a,c,h);return(p=ie.diffed)&&p(e),128&e.__u?void 0:l}function fo(r){r&&r.__c&&(r.__c.__e=!0),r&&r.__k&&r.__k.forEach(fo)}function gc(r,e,t){for(var n=0;n<t.length;n++)Go(t[n],t[++n],t[++n]);ie.__c&&ie.__c(e,r),r.some(function(i){try{r=i.__h,i.__h=[],r.some(function(s){s.call(i)})}catch(s){ie.__e(s,i.__v)}})}function _c(r){return typeof r!="object"||r==null||r.__b&&r.__b>0?r:ui(r)?r.map(_c):qt({},r)}function Md(r,e,t,n,i,s,a,l,c){var h,p,f,g,E,C,M,V=t.props,x=e.props,k=e.type;if(k=="svg"?i="http://www.w3.org/2000/svg":k=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),s!=null){for(h=0;h<s.length;h++)if((E=s[h])&&"setAttribute"in E==!!k&&(k?E.localName==k:E.nodeType==3)){r=E,s[h]=null;break}}if(r==null){if(k==null)return document.createTextNode(x);r=document.createElementNS(i,k,x.is&&x),l&&(ie.__m&&ie.__m(e,s),l=!1),s=null}if(k==null)V===x||l&&r.data==x||(r.data=x);else{if(s=s&&Ts.call(r.childNodes),V=t.props||Xn,!l&&s!=null)for(V={},h=0;h<r.attributes.length;h++)V[(E=r.attributes[h]).name]=E.value;for(h in V)if(E=V[h],h!="children"){if(h=="dangerouslySetInnerHTML")f=E;else if(!(h in x)){if(h=="value"&&"defaultValue"in x||h=="checked"&&"defaultChecked"in x)continue;Fi(r,h,null,E,i)}}for(h in x)E=x[h],h=="children"?g=E:h=="dangerouslySetInnerHTML"?p=E:h=="value"?C=E:h=="checked"?M=E:l&&typeof E!="function"||V[h]===E||Fi(r,h,E,V[h],i);if(p)l||f&&(p.__html==f.__html||p.__html==r.innerHTML)||(r.innerHTML=p.__html),e.__k=[];else if(f&&(r.innerHTML=""),pc(e.type=="template"?r.content:r,ui(g)?g:[g],e,t,n,k=="foreignObject"?"http://www.w3.org/1999/xhtml":i,s,a,s?s[0]:t.__k&&un(t,0),l,c),s!=null)for(h=s.length;h--;)qo(s[h]);l||(h="value",k=="progress"&&C==null?r.removeAttribute("value"):C!=null&&(C!==r[h]||k=="progress"&&!C||k=="option"&&C!=V[h])&&Fi(r,h,C,V[h],i),h="checked",M!=null&&M!=r[h]&&Fi(r,h,M,V[h],i))}return r}function Go(r,e,t){try{if(typeof r=="function"){var n=typeof r.__u=="function";n&&r.__u(),n&&e==null||(r.__u=r(e))}else r.current=e}catch(i){ie.__e(i,t)}}function yc(r,e,t){var n,i;if(ie.unmount&&ie.unmount(r),(n=r.ref)&&(n.current&&n.current!=r.__e||Go(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(s){ie.__e(s,e)}n.base=n.__P=null}if(n=r.__k)for(i=0;i<n.length;i++)n[i]&&yc(n[i],e,t||typeof r.type!="function");t||qo(r.__e),r.__c=r.__=r.__e=void 0}function Od(r,e,t){return this.constructor(r,t)}function Fd(r,e,t){var n,i,s,a;e==document&&(e=document.documentElement),ie.__&&ie.__(r,e),i=(n=!1)?null:e.__k,s=[],a=[],Wo(e,r=e.__k=re(It,null,[r]),i||Xn,Xn,e.namespaceURI,i?null:e.firstChild?Ts.call(e.childNodes):null,s,i?i.__e:e.firstChild,n,a),gc(s,r,a)}function _t(r){function e(t){var n,i;return this.getChildContext||(n=new Set,(i={})[e.__c]=this,this.getChildContext=function(){return i},this.componentWillUnmount=function(){n=null},this.shouldComponentUpdate=function(s){this.props.value!=s.value&&n.forEach(function(a){a.__e=!0,ho(a)})},this.sub=function(s){n.add(s);var a=s.componentWillUnmount;s.componentWillUnmount=function(){n&&n.delete(s),a&&a.call(s)}}),t.children}return e.__c="__cC"+hc++,e.__=r,e.Provider=e.__l=(e.Consumer=function(t,n){return t.children(n)}).contextType=e,e}Ts=dc.slice,ie={__e:function(r,e,t,n){for(var i,s,a;e=e.__;)if((i=e.__c)&&!i.__)try{if((s=i.constructor)&&s.getDerivedStateFromError!=null&&(i.setState(s.getDerivedStateFromError(r)),a=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(r,n||{}),a=i.__d),a)return i.__E=i}catch(l){r=l}throw r}},ac=0,xt.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=qt({},this.state),typeof r=="function"&&(r=r(qt({},t),this.props)),r&&qt(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),ho(this))},xt.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),ho(this))},xt.prototype.render=It,Sr=[],lc=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,uc=function(r,e){return r.__v.__b-e.__v.__b},os.__r=0,cc=/(PointerCapture)$|Capture$/i,Ho=0,uo=cl(!1),co=cl(!0),hc=0;var Ud=0;function ee(r,e,t,n,i,s){e||(e={});var a,l,c=e;if("ref"in c)for(l in c={},e)l=="ref"?a=e[l]:c[l]=e[l];var h={type:r,props:c,key:t,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--Ud,__i:-1,__u:0,__source:i,__self:s};if(typeof r=="function"&&(a=r.defaultProps))for(l in a)c[l]===void 0&&(c[l]=a[l]);return ie.vnode&&ie.vnode(h),h}var Nr,be,Ws,hl,Jn=0,vc=[],xe=ie,dl=xe.__b,fl=xe.__r,pl=xe.diffed,ml=xe.__c,gl=xe.unmount,_l=xe.__;function ci(r,e){xe.__h&&xe.__h(be,r,Jn||e),Jn=0;var t=be.__H||(be.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({}),t.__[r]}function it(r){return Jn=1,$d(wc,r)}function $d(r,e,t){var n=ci(Nr++,2);if(n.t=r,!n.__c&&(n.__=[t?t(e):wc(void 0,e),function(l){var c=n.__N?n.__N[0]:n.__[0],h=n.t(c,l);c!==h&&(n.__N=[h,n.__[1]],n.__c.setState({}))}],n.__c=be,!be.__f)){var i=function(l,c,h){if(!n.__c.__H)return!0;var p=n.__c.__H.__.filter(function(g){return!!g.__c});if(p.every(function(g){return!g.__N}))return!s||s.call(this,l,c,h);var f=n.__c.props!==l;return p.forEach(function(g){if(g.__N){var E=g.__[0];g.__=g.__N,g.__N=void 0,E!==g.__[0]&&(f=!0)}}),s&&s.call(this,l,c,h)||f};be.__f=!0;var s=be.shouldComponentUpdate,a=be.componentWillUpdate;be.componentWillUpdate=function(l,c,h){if(this.__e){var p=s;s=void 0,i(l,c,h),s=p}a&&a.call(this,l,c,h)},be.shouldComponentUpdate=i}return n.__N||n.__}function Wt(r,e){var t=ci(Nr++,3);!xe.__s&&Ko(t.__H,e)&&(t.__=r,t.u=e,be.__H.__h.push(t))}function Ec(r,e){var t=ci(Nr++,4);!xe.__s&&Ko(t.__H,e)&&(t.__=r,t.u=e,be.__h.push(t))}function Is(r){return Jn=5,mt(function(){return{current:r}},[])}function mt(r,e){var t=ci(Nr++,7);return Ko(t.__H,e)&&(t.__=r(),t.__H=e,t.__h=r),t.__}function cn(r,e){return Jn=8,mt(function(){return r},e)}function ye(r){var e=be.context[r.__c],t=ci(Nr++,9);return t.c=r,e?(t.__==null&&(t.__=!0,e.sub(be)),e.props.value):r.__}function Bd(){for(var r;r=vc.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(Qi),r.__H.__h.forEach(po),r.__H.__h=[]}catch(e){r.__H.__h=[],xe.__e(e,r.__v)}}xe.__b=function(r){be=null,dl&&dl(r)},xe.__=function(r,e){r&&e.__k&&e.__k.__m&&(r.__m=e.__k.__m),_l&&_l(r,e)},xe.__r=function(r){fl&&fl(r),Nr=0;var e=(be=r.__c).__H;e&&(Ws===be?(e.__h=[],be.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.u=t.__N=void 0})):(e.__h.forEach(Qi),e.__h.forEach(po),e.__h=[],Nr=0)),Ws=be},xe.diffed=function(r){pl&&pl(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(vc.push(e)!==1&&hl===xe.requestAnimationFrame||((hl=xe.requestAnimationFrame)||jd)(Bd)),e.__H.__.forEach(function(t){t.u&&(t.__H=t.u),t.u=void 0})),Ws=be=null},xe.__c=function(r,e){e.some(function(t){try{t.__h.forEach(Qi),t.__h=t.__h.filter(function(n){return!n.__||po(n)})}catch(n){e.some(function(i){i.__h&&(i.__h=[])}),e=[],xe.__e(n,t.__v)}}),ml&&ml(r,e)},xe.unmount=function(r){gl&&gl(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{Qi(n)}catch(i){e=i}}),t.__H=void 0,e&&xe.__e(e,t.__v))};var yl=typeof requestAnimationFrame=="function";function jd(r){var e,t=function(){clearTimeout(n),yl&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,35);yl&&(e=requestAnimationFrame(t))}function Qi(r){var e=be,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),be=e}function po(r){var e=be;r.__c=r.__(),be=e}function Ko(r,e){return!r||r.length!==e.length||e.some(function(t,n){return t!==r[n]})}function wc(r,e){return typeof e=="function"?e(r):e}function Tc(r,e){for(var t in e)r[t]=e[t];return r}function mo(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function vl(r){r()}function El(r,e){this.props=r,this.context=e}function zd(r,e){function t(i){var s=this.props.ref,a=s==i.ref;return!a&&s&&(s.call?s(null):s.current=null),e?!e(this.props,i)||!a:mo(this.props,i)}function n(i){return this.shouldComponentUpdate=t,re(r,i)}return n.displayName="Memo("+(r.displayName||r.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n.type=r,n}(El.prototype=new xt).isPureReactComponent=!0,El.prototype.shouldComponentUpdate=function(r,e){return mo(this.props,r)||mo(this.state,e)};var wl=ie.__b;ie.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),wl&&wl(r)};var Hd=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Qo(r){function e(t){var n=Tc({},t);return delete n.ref,r(n,t.ref||null)}return e.$$typeof=Hd,e.render=r,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(r.displayName||r.name)+")",e}var qd=ie.__e;ie.__e=function(r,e,t,n){if(r.then){for(var i,s=e;s=s.__;)if((i=s.__c)&&i.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),i.__c(r,e)}qd(r,e,t,n)};var Tl=ie.unmount;function Ic(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=Tc({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c.__e=!0,r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return Ic(n,e,t)})),r}function Ac(r,e,t){return r&&t&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return Ac(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.appendChild(r.__e),r.__c.__e=!0,r.__c.__P=t)),r}function Gs(){this.__u=0,this.o=null,this.__b=null}function Rc(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function Ui(){this.i=null,this.l=null}ie.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&32&r.__u&&(r.type=null),Tl&&Tl(r)},(Gs.prototype=new xt).__c=function(r,e){var t=e.__c,n=this;n.o==null&&(n.o=[]),n.o.push(t);var i=Rc(n.__v),s=!1,a=function(){s||(s=!0,t.__R=null,i?i(l):l())};t.__R=a;var l=function(){if(!--n.__u){if(n.state.__a){var c=n.state.__a;n.__v.__k[0]=Ac(c,c.__c.__P,c.__c.__O)}var h;for(n.setState({__a:n.__b=null});h=n.o.pop();)h.forceUpdate()}};n.__u++||32&e.__u||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(a,a)},Gs.prototype.componentWillUnmount=function(){this.o=[]},Gs.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=Ic(this.__b,t,n.__O=n.__P)}this.__b=null}var i=e.__a&&re(It,null,r.fallback);return i&&(i.__u&=-33),[re(It,null,e.__a?null:r.children),i]};var Il=function(r,e,t){if(++t[1]===t[0]&&r.l.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.l.size))for(t=r.i;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.i=t=t[2]}};(Ui.prototype=new xt).__a=function(r){var e=this,t=Rc(e.__v),n=e.l.get(r);return n[0]++,function(i){var s=function(){e.props.revealOrder?(n.push(i),Il(e,r,n)):i()};t?t(s):s()}},Ui.prototype.render=function(r){this.i=null,this.l=new Map;var e=as(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.l.set(e[t],this.i=[1,0,this.i]);return r.children},Ui.prototype.componentDidUpdate=Ui.prototype.componentDidMount=function(){var r=this;this.l.forEach(function(e,t){Il(r,t,e)})};var Wd=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Gd=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Kd=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Qd=/[A-Z0-9]/g,Yd=typeof document<"u",Xd=function(r){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(r)};xt.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(xt.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var Al=ie.event;function Jd(){}function Zd(){return this.cancelBubble}function ef(){return this.defaultPrevented}ie.event=function(r){return Al&&(r=Al(r)),r.persist=Jd,r.isPropagationStopped=Zd,r.isDefaultPrevented=ef,r.nativeEvent=r};var tf={enumerable:!1,configurable:!0,get:function(){return this.class}},Rl=ie.vnode;ie.vnode=function(r){typeof r.type=="string"&&(function(e){var t=e.props,n=e.type,i={},s=n.indexOf("-")===-1;for(var a in t){var l=t[a];if(!(a==="value"&&"defaultValue"in t&&l==null||Yd&&a==="children"&&n==="noscript"||a==="class"||a==="className")){var c=a.toLowerCase();a==="defaultValue"&&"value"in t&&t.value==null?a="value":a==="download"&&l===!0?l="":c==="translate"&&l==="no"?l=!1:c[0]==="o"&&c[1]==="n"?c==="ondoubleclick"?a="ondblclick":c!=="onchange"||n!=="input"&&n!=="textarea"||Xd(t.type)?c==="onfocus"?a="onfocusin":c==="onblur"?a="onfocusout":Kd.test(a)&&(a=c):c=a="oninput":s&&Gd.test(a)?a=a.replace(Qd,"-$&").toLowerCase():l===null&&(l=void 0),c==="oninput"&&i[a=c]&&(a="oninputCapture"),i[a]=l}}n=="select"&&i.multiple&&Array.isArray(i.value)&&(i.value=as(t.children).forEach(function(h){h.props.selected=i.value.indexOf(h.props.value)!=-1})),n=="select"&&i.defaultValue!=null&&(i.value=as(t.children).forEach(function(h){h.props.selected=i.multiple?i.defaultValue.indexOf(h.props.value)!=-1:i.defaultValue==h.props.value})),t.class&&!t.className?(i.class=t.class,Object.defineProperty(i,"className",tf)):(t.className&&!t.class||t.class&&t.className)&&(i.class=i.className=t.className),e.props=i})(r),r.$$typeof=Wd,Rl&&Rl(r)};var bl=ie.__r;ie.__r=function(r){bl&&bl(r),r.__c};var Sl=ie.diffed;ie.diffed=function(r){Sl&&Sl(r);var e=r.props,t=r.__e;t!=null&&r.type==="textarea"&&"value"in e&&e.value!==t.value&&(t.value=e.value==null?"":e.value)};var rf=function(r,e){return r(e)};/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var bc=r=>{throw TypeError(r)},nf=(r,e,t)=>e.has(r)||bc("Cannot "+t),Ks=(r,e,t)=>(nf(r,e,"read from private field"),t?t.call(r):e.get(r)),sf=(r,e,t)=>e.has(r)?bc("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Cl="popstate";function of(r={}){function e(n,i){let{pathname:s,search:a,hash:l}=n.location;return Zn("",{pathname:s,search:a,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:dr(i)}return lf(e,t,null,r)}function oe(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function Be(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function af(){return Math.random().toString(36).substring(2,10)}function Pl(r,e){return{usr:r.state,key:r.key,idx:e}}function Zn(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?vr(e):e,state:t,key:e&&e.key||n||af()}}function dr({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function vr(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function lf(r,e,t,n={}){let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,l="POP",c=null,h=p();h==null&&(h=0,a.replaceState({...a.state,idx:h},""));function p(){return(a.state||{idx:null}).idx}function f(){l="POP";let V=p(),x=V==null?null:V-h;h=V,c&&c({action:l,location:M.location,delta:x})}function g(V,x){l="PUSH";let k=Zn(M.location,V,x);h=p()+1;let F=Pl(k,h),J=M.createHref(k);try{a.pushState(F,"",J)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;i.location.assign(J)}s&&c&&c({action:l,location:M.location,delta:1})}function E(V,x){l="REPLACE";let k=Zn(M.location,V,x);h=p();let F=Pl(k,h),J=M.createHref(k);a.replaceState(F,"",J),s&&c&&c({action:l,location:M.location,delta:0})}function C(V){return Sc(V)}let M={get action(){return l},get location(){return r(i,a)},listen(V){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Cl,f),c=V,()=>{i.removeEventListener(Cl,f),c=null}},createHref(V){return e(i,V)},createURL:C,encodeLocation(V){let x=C(V);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:g,replace:E,go(V){return a.go(V)}};return M}function Sc(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),oe(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:dr(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}var Bn,Dl=class{constructor(r){if(sf(this,Bn,new Map),r)for(let[e,t]of r)this.set(e,t)}get(r){if(Ks(this,Bn).has(r))return Ks(this,Bn).get(r);if(r.defaultValue!==void 0)return r.defaultValue;throw new Error("No value found for context")}set(r,e){Ks(this,Bn).set(r,e)}};Bn=new WeakMap;var uf=new Set(["lazy","caseSensitive","path","id","index","children"]);function cf(r){return uf.has(r)}var hf=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function df(r){return hf.has(r)}function ff(r){return r.index===!0}function ei(r,e,t=[],n={},i=!1){return r.map((s,a)=>{let l=[...t,String(a)],c=typeof s.id=="string"?s.id:l.join("-");if(oe(s.index!==!0||!s.children,"Cannot specify children on an index route"),oe(i||!n[c],`Found a route id collision on id "${c}".  Route id's must be globally unique within Data Router usages`),ff(s)){let h={...s,...e(s),id:c};return n[c]=h,h}else{let h={...s,...e(s),id:c,children:void 0};return n[c]=h,s.children&&(h.children=ei(s.children,e,l,n,i)),h}})}function nr(r,e,t="/"){return Yi(r,e,t,!1)}function Yi(r,e,t,n){let i=typeof e=="string"?vr(e):e,s=gt(i.pathname||"/",t);if(s==null)return null;let a=Cc(r);mf(a);let l=null;for(let c=0;l==null&&c<a.length;++c){let h=bf(s);l=Af(a[c],h,n)}return l}function pf(r,e){let{route:t,pathname:n,params:i}=r;return{id:t.id,pathname:n,params:i,data:e[t.id],loaderData:e[t.id],handle:t.handle}}function Cc(r,e=[],t=[],n="",i=!1){let s=(a,l,c=i,h)=>{let p={relativePath:h===void 0?a.path||"":h,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&c)return;oe(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let f=kt([n,p.relativePath]),g=t.concat(p);a.children&&a.children.length>0&&(oe(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),Cc(a.children,e,g,f,c)),!(a.path==null&&!a.index)&&e.push({path:f,score:Tf(f,a.index),routesMeta:g})};return r.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))s(a,l);else for(let c of Pc(a.path))s(a,l,!0,c)}),e}function Pc(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=Pc(n.join("/")),l=[];return l.push(...a.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...a),l.map(c=>r.startsWith("/")&&c===""?"/":c)}function mf(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:If(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var gf=/^:[\w-]+$/,_f=3,yf=2,vf=1,Ef=10,wf=-2,Vl=r=>r==="*";function Tf(r,e){let t=r.split("/"),n=t.length;return t.some(Vl)&&(n+=wf),e&&(n+=yf),t.filter(i=>!Vl(i)).reduce((i,s)=>i+(gf.test(s)?_f:s===""?vf:Ef),n)}function If(r,e){return r.length===e.length&&r.slice(0,-1).every((n,i)=>n===e[i])?r[r.length-1]-e[e.length-1]:0}function Af(r,e,t=!1){let{routesMeta:n}=r,i={},s="/",a=[];for(let l=0;l<n.length;++l){let c=n[l],h=l===n.length-1,p=s==="/"?e:e.slice(s.length)||"/",f=ls({path:c.relativePath,caseSensitive:c.caseSensitive,end:h},p),g=c.route;if(!f&&h&&t&&!n[n.length-1].route.index&&(f=ls({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},p)),!f)return null;Object.assign(i,f.params),a.push({params:i,pathname:kt([s,f.pathname]),pathnameBase:Df(kt([s,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(s=kt([s,f.pathnameBase]))}return a}function ls(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=Rf(r.path,r.caseSensitive,r.end),i=e.match(t);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:f},g)=>{if(p==="*"){let C=l[g]||"";a=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const E=l[g];return f&&!E?h[p]=void 0:h[p]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:a,pattern:r}}function Rf(r,e=!1,t=!0){Be(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],i="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),i+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":r!==""&&r!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function bf(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Be(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function gt(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function Sf({basename:r,pathname:e}){return e==="/"?r:kt([r,e])}function Cf(r,e="/"){let{pathname:t,search:n="",hash:i=""}=typeof r=="string"?vr(r):r;return{pathname:t?t.startsWith("/")?t:Pf(t,e):e,search:Vf(n),hash:Nf(i)}}function Pf(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function Qs(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Dc(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Yo(r){let e=Dc(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Xo(r,e,t,n=!1){let i;typeof r=="string"?i=vr(r):(i={...r},oe(!i.pathname||!i.pathname.includes("?"),Qs("?","pathname","search",i)),oe(!i.pathname||!i.pathname.includes("#"),Qs("#","pathname","hash",i)),oe(!i.search||!i.search.includes("#"),Qs("#","search","hash",i)));let s=r===""||i.pathname==="",a=s?"/":i.pathname,l;if(a==null)l=t;else{let f=e.length-1;if(!n&&a.startsWith("..")){let g=a.split("/");for(;g[0]==="..";)g.shift(),f-=1;i.pathname=g.join("/")}l=f>=0?e[f]:"/"}let c=Cf(i,l),h=a&&a!=="/"&&a.endsWith("/"),p=(s||a===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(h||p)&&(c.pathname+="/"),c}var kt=r=>r.join("/").replace(/\/\/+/g,"/"),Df=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),Vf=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,Nf=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,us=class{constructor(r,e,t,n=!1){this.status=r,this.statusText=e||"",this.internal=n,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function ti(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var Vc=["POST","PUT","PATCH","DELETE"],xf=new Set(Vc),kf=["GET",...Vc],Lf=new Set(kf),Mf=new Set([301,302,303,307,308]),Of=new Set([307,308]),Ys={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Ff={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Fn={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Uf=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jo=r=>Uf.test(r),$f=r=>({hasErrorBoundary:!!r.hasErrorBoundary}),Nc="remix-router-transitions",xc=Symbol("ResetLoaderData");function Bf(r){const e=r.window?r.window:typeof window<"u"?window:void 0,t=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u";oe(r.routes.length>0,"You must provide a non-empty routes array to createRouter");let n=r.hydrationRouteProperties||[],i=r.mapRouteProperties||$f,s={},a=ei(r.routes,i,void 0,s),l,c=r.basename||"/";c.startsWith("/")||(c=`/${c}`);let h=r.dataStrategy||Wf,p={...r.future},f=null,g=new Set,E=null,C=null,M=null,V=r.hydrationData!=null,x=nr(a,r.history.location,c),k=!1,F=null,J;if(x==null&&!r.patchRoutesOnNavigation){let w=pt(404,{pathname:r.history.location.pathname}),{matches:b,route:D}=$i(a);J=!0,x=b,F={[D.id]:w}}else if(x&&!r.hydrationData&&ft(x,a,r.history.location.pathname).active&&(x=null),x)if(x.some(w=>w.route.lazy))J=!1;else if(!x.some(w=>w.route.loader))J=!0;else{let w=r.hydrationData?r.hydrationData.loaderData:null,b=r.hydrationData?r.hydrationData.errors:null;if(b){let D=x.findIndex(O=>b[O.route.id]!==void 0);J=x.slice(0,D+1).every(O=>!_o(O.route,w,b))}else J=x.every(D=>!_o(D.route,w,b))}else{J=!1,x=[];let w=ft(null,a,r.history.location.pathname);w.active&&w.matches&&(k=!0,x=w.matches)}let Q,P={historyAction:r.history.action,location:r.history.location,matches:x,initialized:J,navigation:Ys,restoreScrollPosition:r.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:r.hydrationData&&r.hydrationData.loaderData||{},actionData:r.hydrationData&&r.hydrationData.actionData||null,errors:r.hydrationData&&r.hydrationData.errors||F,fetchers:new Map,blockers:new Map},I="POP",_=!1,y,T=!1,A=new Map,R=null,v=!1,de=!1,qe=new Set,me=new Map,We=0,Me=-1,nt=new Map,Ke=new Set,at=new Map,je=new Map,ve=new Set,Ut=new Map,At,Er=null;function Or(){if(f=r.history.listen(({action:w,location:b,delta:D})=>{if(At){At(),At=void 0;return}Be(Ut.size===0||D!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let O=zr({currentLocation:P.location,nextLocation:b,historyAction:w});if(O&&D!=null){let U=new Promise(z=>{At=z});r.history.go(D*-1),jr(O,{state:"blocked",location:b,proceed(){jr(O,{state:"proceeding",proceed:void 0,reset:void 0,location:b}),U.then(()=>r.history.go(D))},reset(){let z=new Map(P.blockers);z.set(O,Fn),Ne({blockers:z})}});return}return vt(w,b)}),t){ap(e,A);let w=()=>lp(e,A);e.addEventListener("pagehide",w),R=()=>e.removeEventListener("pagehide",w)}return P.initialized||vt("POP",P.location,{initialHydration:!0}),Q}function Fs(){f&&f(),R&&R(),g.clear(),y&&y.abort(),P.fetchers.forEach((w,b)=>Br(b)),P.blockers.forEach((w,b)=>Ai(b))}function Us(w){return g.add(w),()=>g.delete(w)}function Ne(w,b={}){w.matches&&(w.matches=w.matches.map(U=>{let z=s[U.route.id],G=U.route;return G.element!==z.element||G.errorElement!==z.errorElement||G.hydrateFallbackElement!==z.hydrateFallbackElement?{...U,route:z}:U})),P={...P,...w};let D=[],O=[];P.fetchers.forEach((U,z)=>{U.state==="idle"&&(ve.has(z)?D.push(z):O.push(z))}),ve.forEach(U=>{!P.fetchers.has(U)&&!me.has(U)&&D.push(U)}),[...g].forEach(U=>U(P,{deletedFetchers:D,viewTransitionOpts:b.viewTransitionOpts,flushSync:b.flushSync===!0})),D.forEach(U=>Br(U)),O.forEach(U=>P.fetchers.delete(U))}function yt(w,b,{flushSync:D}={}){let O=P.actionData!=null&&P.navigation.formMethod!=null&&ut(P.navigation.formMethod)&&P.navigation.state==="loading"&&w.state?._isRedirect!==!0,U;b.actionData?Object.keys(b.actionData).length>0?U=b.actionData:U=null:O?U=P.actionData:U=null;let z=b.loaderData?Bl(P.loaderData,b.loaderData,b.matches||[],b.errors):P.loaderData,G=P.blockers;G.size>0&&(G=new Map(G),G.forEach((K,W)=>G.set(W,Fn)));let H=v?!1:qr(w,b.matches||P.matches),q=_===!0||P.navigation.formMethod!=null&&ut(P.navigation.formMethod)&&w.state?._isRedirect!==!0;l&&(a=l,l=void 0),v||I==="POP"||(I==="PUSH"?r.history.push(w,w.state):I==="REPLACE"&&r.history.replace(w,w.state));let Z;if(I==="POP"){let K=A.get(P.location.pathname);K&&K.has(w.pathname)?Z={currentLocation:P.location,nextLocation:w}:A.has(w.pathname)&&(Z={currentLocation:w,nextLocation:P.location})}else if(T){let K=A.get(P.location.pathname);K?K.add(w.pathname):(K=new Set([w.pathname]),A.set(P.location.pathname,K)),Z={currentLocation:P.location,nextLocation:w}}Ne({...b,actionData:U,loaderData:z,historyAction:I,location:w,initialized:!0,navigation:Ys,revalidation:"idle",restoreScrollPosition:H,preventScrollReset:q,blockers:G},{viewTransitionOpts:Z,flushSync:D===!0}),I="POP",_=!1,T=!1,v=!1,de=!1,Er?.resolve(),Er=null}async function Fr(w,b){if(typeof w=="number"){r.history.go(w);return}let D=go(P.location,P.matches,c,w,b?.fromRouteId,b?.relative),{path:O,submission:U,error:z}=Nl(!1,D,b),G=P.location,H=Zn(P.location,O,b&&b.state);H={...H,...r.history.encodeLocation(H)};let q=b&&b.replace!=null?b.replace:void 0,Z="PUSH";q===!0?Z="REPLACE":q===!1||U!=null&&ut(U.formMethod)&&U.formAction===P.location.pathname+P.location.search&&(Z="REPLACE");let K=b&&"preventScrollReset"in b?b.preventScrollReset===!0:void 0,W=(b&&b.flushSync)===!0,ae=zr({currentLocation:G,nextLocation:H,historyAction:Z});if(ae){jr(ae,{state:"blocked",location:H,proceed(){jr(ae,{state:"proceeding",proceed:void 0,reset:void 0,location:H}),Fr(w,b)},reset(){let ge=new Map(P.blockers);ge.set(ae,Fn),Ne({blockers:ge})}});return}await vt(Z,H,{submission:U,pendingError:z,preventScrollReset:K,replace:b&&b.replace,enableViewTransition:b&&b.viewTransition,flushSync:W})}function Tn(){Er||(Er=up()),$r(),Ne({revalidation:"loading"});let w=Er.promise;return P.navigation.state==="submitting"?w:P.navigation.state==="idle"?(vt(P.historyAction,P.location,{startUninterruptedRevalidation:!0}),w):(vt(I||P.historyAction,P.navigation.location,{overrideNavigation:P.navigation,enableViewTransition:T===!0}),w)}async function vt(w,b,D){y&&y.abort(),y=null,I=w,v=(D&&D.startUninterruptedRevalidation)===!0,Cn(P.location,P.matches),_=(D&&D.preventScrollReset)===!0,T=(D&&D.enableViewTransition)===!0;let O=l||a,U=D&&D.overrideNavigation,z=D?.initialHydration&&P.matches&&P.matches.length>0&&!k?P.matches:nr(O,b,c),G=(D&&D.flushSync)===!0;if(z&&P.initialized&&!de&&ep(P.location,b)&&!(D&&D.submission&&ut(D.submission.formMethod))){yt(b,{matches:z},{flushSync:G});return}let H=ft(z,O,b.pathname);if(H.active&&H.matches&&(z=H.matches),!z){let{error:Re,notFoundMatches:we,route:_e}=Hr(b.pathname);yt(b,{matches:we,loaderData:{},errors:{[_e.id]:Re}},{flushSync:G});return}y=new AbortController;let q=Xr(r.history,b,y.signal,D&&D.submission),Z=r.unstable_getContext?await r.unstable_getContext():new Dl,K;if(D&&D.pendingError)K=[ir(z).route.id,{type:"error",error:D.pendingError}];else if(D&&D.submission&&ut(D.submission.formMethod)){let Re=await In(q,b,D.submission,z,Z,H.active,D&&D.initialHydration===!0,{replace:D.replace,flushSync:G});if(Re.shortCircuited)return;if(Re.pendingActionResult){let[we,_e]=Re.pendingActionResult;if(dt(_e)&&ti(_e.error)&&_e.error.status===404){y=null,yt(b,{matches:Re.matches,loaderData:{},errors:{[we]:_e.error}});return}}z=Re.matches||z,K=Re.pendingActionResult,U=Xs(b,D.submission),G=!1,H.active=!1,q=Xr(r.history,q.url,q.signal)}let{shortCircuited:W,matches:ae,loaderData:ge,errors:Se}=await vi(q,b,z,Z,H.active,U,D&&D.submission,D&&D.fetcherSubmission,D&&D.replace,D&&D.initialHydration===!0,G,K);W||(y=null,yt(b,{matches:ae||z,...jl(K),loaderData:ge,errors:Se}))}async function In(w,b,D,O,U,z,G,H={}){$r();let q=sp(b,D);if(Ne({navigation:q},{flushSync:H.flushSync===!0}),z){let W=await Tr(O,b.pathname,w.signal);if(W.type==="aborted")return{shortCircuited:!0};if(W.type==="error"){if(W.partialMatches.length===0){let{matches:ge,route:Se}=$i(a);return{matches:ge,pendingActionResult:[Se.id,{type:"error",error:W.error}]}}let ae=ir(W.partialMatches).route.id;return{matches:W.partialMatches,pendingActionResult:[ae,{type:"error",error:W.error}]}}else if(W.matches)O=W.matches;else{let{notFoundMatches:ae,error:ge,route:Se}=Hr(b.pathname);return{matches:ae,pendingActionResult:[Se.id,{type:"error",error:ge}]}}}let Z,K=Xi(O,b);if(!K.route.action&&!K.route.lazy)Z={type:"error",error:pt(405,{method:w.method,pathname:b.pathname,routeId:K.route.id})};else{let W=rn(i,s,w,O,K,G?[]:n,U),ae=await Bt(w,W,U,null);if(Z=ae[K.route.id],!Z){for(let ge of O)if(ae[ge.route.id]){Z=ae[ge.route.id];break}}if(w.signal.aborted)return{shortCircuited:!0}}if(Cr(Z)){let W;return H&&H.replace!=null?W=H.replace:W=Fl(Z.response.headers.get("Location"),new URL(w.url),c)===P.location.pathname+P.location.search,await $t(w,Z,!0,{submission:D,replace:W}),{shortCircuited:!0}}if(dt(Z)){let W=ir(O,K.route.id);return(H&&H.replace)!==!0&&(I="PUSH"),{matches:O,pendingActionResult:[W.route.id,Z,K.route.id]}}return{matches:O,pendingActionResult:[K.route.id,Z]}}async function vi(w,b,D,O,U,z,G,H,q,Z,K,W){let ae=z||Xs(b,G),ge=G||H||Hl(ae),Se=!v&&!Z;if(U){if(Se){let Oe=Ei(W);Ne({navigation:ae,...Oe!==void 0?{actionData:Oe}:{}},{flushSync:K})}let se=await Tr(D,b.pathname,w.signal);if(se.type==="aborted")return{shortCircuited:!0};if(se.type==="error"){if(se.partialMatches.length===0){let{matches:Zt,route:Pt}=$i(a);return{matches:Zt,loaderData:{},errors:{[Pt.id]:se.error}}}let Oe=ir(se.partialMatches).route.id;return{matches:se.partialMatches,loaderData:{},errors:{[Oe]:se.error}}}else if(se.matches)D=se.matches;else{let{error:Oe,notFoundMatches:Zt,route:Pt}=Hr(b.pathname);return{matches:Zt,loaderData:{},errors:{[Pt.id]:Oe}}}}let Re=l||a,{dsMatches:we,revalidatingFetchers:_e}=xl(w,O,i,s,r.history,P,D,ge,b,Z?[]:n,Z===!0,de,qe,ve,at,Ke,Re,c,r.patchRoutesOnNavigation!=null,W);if(Me=++We,!r.dataStrategy&&!we.some(se=>se.shouldLoad)&&!we.some(se=>se.route.unstable_middleware)&&_e.length===0){let se=Rn();return yt(b,{matches:D,loaderData:{},errors:W&&dt(W[1])?{[W[0]]:W[1].error}:null,...jl(W),...se?{fetchers:new Map(P.fetchers)}:{}},{flushSync:K}),{shortCircuited:!0}}if(Se){let se={};if(!U){se.navigation=ae;let Oe=Ei(W);Oe!==void 0&&(se.actionData=Oe)}_e.length>0&&(se.fetchers=$s(_e)),Ne(se,{flushSync:K})}_e.forEach(se=>{Rt(se.key),se.controller&&me.set(se.key,se.controller)});let Et=()=>_e.forEach(se=>Rt(se.key));y&&y.signal.addEventListener("abort",Et);let{loaderResults:jt,fetcherResults:wt}=await Ur(we,_e,w,O);if(w.signal.aborted)return{shortCircuited:!0};y&&y.signal.removeEventListener("abort",Et),_e.forEach(se=>me.delete(se.key));let ct=Bi(jt);if(ct)return await $t(w,ct.result,!0,{replace:q}),{shortCircuited:!0};if(ct=Bi(wt),ct)return Ke.add(ct.key),await $t(w,ct.result,!0,{replace:q}),{shortCircuited:!0};let{loaderData:Pn,errors:bt}=$l(P,D,jt,W,_e,wt);Z&&P.errors&&(bt={...P.errors,...bt});let St=Rn(),Jt=bn(Me),Ct=St||Jt||_e.length>0;return{matches:D,loaderData:Pn,errors:bt,...Ct?{fetchers:new Map(P.fetchers)}:{}}}function Ei(w){if(w&&!dt(w[1]))return{[w[0]]:w[1].data};if(P.actionData)return Object.keys(P.actionData).length===0?null:P.actionData}function $s(w){return w.forEach(b=>{let D=P.fetchers.get(b.key),O=Un(void 0,D?D.data:void 0);P.fetchers.set(b.key,O)}),new Map(P.fetchers)}async function wi(w,b,D,O){Rt(w);let U=(O&&O.flushSync)===!0,z=l||a,G=go(P.location,P.matches,c,D,b,O?.relative),H=nr(z,G,c),q=ft(H,z,G);if(q.active&&q.matches&&(H=q.matches),!H){Ie(w,b,pt(404,{pathname:G}),{flushSync:U});return}let{path:Z,submission:K,error:W}=Nl(!0,G,O);if(W){Ie(w,b,W,{flushSync:U});return}let ae=r.unstable_getContext?await r.unstable_getContext():new Dl,ge=(O&&O.preventScrollReset)===!0;if(K&&ut(K.formMethod)){await An(w,b,Z,H,ae,q.active,U,ge,K);return}at.set(w,{routeId:b,path:Z}),await Ti(w,b,Z,H,ae,q.active,U,ge,K)}async function An(w,b,D,O,U,z,G,H,q){$r(),at.delete(w);let Z=P.fetchers.get(w);Te(w,op(q,Z),{flushSync:G});let K=new AbortController,W=Xr(r.history,D,K.signal,q);if(z){let De=await Tr(O,new URL(W.url).pathname,W.signal,w);if(De.type==="aborted")return;if(De.type==="error"){Ie(w,b,De.error,{flushSync:G});return}else if(De.matches)O=De.matches;else{Ie(w,b,pt(404,{pathname:D}),{flushSync:G});return}}let ae=Xi(O,D);if(!ae.route.action&&!ae.route.lazy){let De=pt(405,{method:q.formMethod,pathname:D,routeId:b});Ie(w,b,De,{flushSync:G});return}me.set(w,K);let ge=We,Se=rn(i,s,W,O,ae,n,U),we=(await Bt(W,Se,U,w))[ae.route.id];if(W.signal.aborted){me.get(w)===K&&me.delete(w);return}if(ve.has(w)){if(Cr(we)||dt(we)){Te(w,rr(void 0));return}}else{if(Cr(we))if(me.delete(w),Me>ge){Te(w,rr(void 0));return}else return Ke.add(w),Te(w,Un(q)),$t(W,we,!1,{fetcherSubmission:q,preventScrollReset:H});if(dt(we)){Ie(w,b,we.error);return}}let _e=P.navigation.location||P.location,Et=Xr(r.history,_e,K.signal),jt=l||a,wt=P.navigation.state!=="idle"?nr(jt,P.navigation.location,c):P.matches;oe(wt,"Didn't find any matches after fetcher action");let ct=++We;nt.set(w,ct);let Pn=Un(q,we.data);P.fetchers.set(w,Pn);let{dsMatches:bt,revalidatingFetchers:St}=xl(Et,U,i,s,r.history,P,wt,q,_e,n,!1,de,qe,ve,at,Ke,jt,c,r.patchRoutesOnNavigation!=null,[ae.route.id,we]);St.filter(De=>De.key!==w).forEach(De=>{let Ir=De.key,Gr=P.fetchers.get(Ir),Dn=Un(void 0,Gr?Gr.data:void 0);P.fetchers.set(Ir,Dn),Rt(Ir),De.controller&&me.set(Ir,De.controller)}),Ne({fetchers:new Map(P.fetchers)});let Jt=()=>St.forEach(De=>Rt(De.key));K.signal.addEventListener("abort",Jt);let{loaderResults:Ct,fetcherResults:se}=await Ur(bt,St,Et,U);if(K.signal.aborted)return;if(K.signal.removeEventListener("abort",Jt),nt.delete(w),me.delete(w),St.forEach(De=>me.delete(De.key)),P.fetchers.has(w)){let De=rr(we.data);P.fetchers.set(w,De)}let Oe=Bi(Ct);if(Oe)return $t(Et,Oe.result,!1,{preventScrollReset:H});if(Oe=Bi(se),Oe)return Ke.add(Oe.key),$t(Et,Oe.result,!1,{preventScrollReset:H});let{loaderData:Zt,errors:Pt}=$l(P,wt,Ct,void 0,St,se);bn(ct),P.navigation.state==="loading"&&ct>Me?(oe(I,"Expected pending action"),y&&y.abort(),yt(P.navigation.location,{matches:wt,loaderData:Zt,errors:Pt,fetchers:new Map(P.fetchers)})):(Ne({errors:Pt,loaderData:Bl(P.loaderData,Zt,wt,Pt),fetchers:new Map(P.fetchers)}),de=!1)}async function Ti(w,b,D,O,U,z,G,H,q){let Z=P.fetchers.get(w);Te(w,Un(q,Z?Z.data:void 0),{flushSync:G});let K=new AbortController,W=Xr(r.history,D,K.signal);if(z){let _e=await Tr(O,new URL(W.url).pathname,W.signal,w);if(_e.type==="aborted")return;if(_e.type==="error"){Ie(w,b,_e.error,{flushSync:G});return}else if(_e.matches)O=_e.matches;else{Ie(w,b,pt(404,{pathname:D}),{flushSync:G});return}}let ae=Xi(O,D);me.set(w,K);let ge=We,Se=rn(i,s,W,O,ae,n,U),we=(await Bt(W,Se,U,w))[ae.route.id];if(me.get(w)===K&&me.delete(w),!W.signal.aborted){if(ve.has(w)){Te(w,rr(void 0));return}if(Cr(we))if(Me>ge){Te(w,rr(void 0));return}else{Ke.add(w),await $t(W,we,!1,{preventScrollReset:H});return}if(dt(we)){Ie(w,b,we.error);return}Te(w,rr(we.data))}}async function $t(w,b,D,{submission:O,fetcherSubmission:U,preventScrollReset:z,replace:G}={}){b.response.headers.has("X-Remix-Revalidate")&&(de=!0);let H=b.response.headers.get("Location");oe(H,"Expected a Location header on the redirect Response"),H=Fl(H,new URL(w.url),c);let q=Zn(P.location,H,{_isRedirect:!0});if(t){let Se=!1;if(b.response.headers.has("X-Remix-Reload-Document"))Se=!0;else if(Jo(H)){const Re=Sc(H,!0);Se=Re.origin!==e.location.origin||gt(Re.pathname,c)==null}if(Se){G?e.location.replace(H):e.location.assign(H);return}}y=null;let Z=G===!0||b.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:K,formAction:W,formEncType:ae}=P.navigation;!O&&!U&&K&&W&&ae&&(O=Hl(P.navigation));let ge=O||U;if(Of.has(b.response.status)&&ge&&ut(ge.formMethod))await vt(Z,q,{submission:{...ge,formAction:H},preventScrollReset:z||_,enableViewTransition:D?T:void 0});else{let Se=Xs(q,O);await vt(Z,q,{overrideNavigation:Se,fetcherSubmission:U,preventScrollReset:z||_,enableViewTransition:D?T:void 0})}}async function Bt(w,b,D,O){let U,z={};try{U=await Kf(h,w,b,O,D,!1)}catch(G){return b.filter(H=>H.shouldLoad).forEach(H=>{z[H.route.id]={type:"error",error:G}}),z}if(w.signal.aborted)return z;for(let[G,H]of Object.entries(U))if(np(H)){let q=H.result;z[G]={type:"redirect",response:Jf(q,w,G,b,c)}}else z[G]=await Xf(H);return z}async function Ur(w,b,D,O){let U=Bt(D,w,O,null),z=Promise.all(b.map(async q=>{if(q.matches&&q.match&&q.request&&q.controller){let K=(await Bt(q.request,q.matches,O,q.key))[q.match.route.id];return{[q.key]:K}}else return Promise.resolve({[q.key]:{type:"error",error:pt(404,{pathname:q.path})}})})),G=await U,H=(await z).reduce((q,Z)=>Object.assign(q,Z),{});return{loaderResults:G,fetcherResults:H}}function $r(){de=!0,at.forEach((w,b)=>{me.has(b)&&qe.add(b),Rt(b)})}function Te(w,b,D={}){P.fetchers.set(w,b),Ne({fetchers:new Map(P.fetchers)},{flushSync:(D&&D.flushSync)===!0})}function Ie(w,b,D,O={}){let U=ir(P.matches,b);Br(w),Ne({errors:{[U.route.id]:D},fetchers:new Map(P.fetchers)},{flushSync:(O&&O.flushSync)===!0})}function wr(w){return je.set(w,(je.get(w)||0)+1),ve.has(w)&&ve.delete(w),P.fetchers.get(w)||Ff}function Br(w){let b=P.fetchers.get(w);me.has(w)&&!(b&&b.state==="loading"&&nt.has(w))&&Rt(w),at.delete(w),nt.delete(w),Ke.delete(w),ve.delete(w),qe.delete(w),P.fetchers.delete(w)}function Ii(w){let b=(je.get(w)||0)-1;b<=0?(je.delete(w),ve.add(w)):je.set(w,b),Ne({fetchers:new Map(P.fetchers)})}function Rt(w){let b=me.get(w);b&&(b.abort(),me.delete(w))}function Yt(w){for(let b of w){let D=wr(b),O=rr(D.data);P.fetchers.set(b,O)}}function Rn(){let w=[],b=!1;for(let D of Ke){let O=P.fetchers.get(D);oe(O,`Expected fetcher: ${D}`),O.state==="loading"&&(Ke.delete(D),w.push(D),b=!0)}return Yt(w),b}function bn(w){let b=[];for(let[D,O]of nt)if(O<w){let U=P.fetchers.get(D);oe(U,`Expected fetcher: ${D}`),U.state==="loading"&&(Rt(D),nt.delete(D),b.push(D))}return Yt(b),b.length>0}function Sn(w,b){let D=P.blockers.get(w)||Fn;return Ut.get(w)!==b&&Ut.set(w,b),D}function Ai(w){P.blockers.delete(w),Ut.delete(w)}function jr(w,b){let D=P.blockers.get(w)||Fn;oe(D.state==="unblocked"&&b.state==="blocked"||D.state==="blocked"&&b.state==="blocked"||D.state==="blocked"&&b.state==="proceeding"||D.state==="blocked"&&b.state==="unblocked"||D.state==="proceeding"&&b.state==="unblocked",`Invalid blocker state transition: ${D.state} -> ${b.state}`);let O=new Map(P.blockers);O.set(w,b),Ne({blockers:O})}function zr({currentLocation:w,nextLocation:b,historyAction:D}){if(Ut.size===0)return;Ut.size>1&&Be(!1,"A router only supports one blocker at a time");let O=Array.from(Ut.entries()),[U,z]=O[O.length-1],G=P.blockers.get(U);if(!(G&&G.state==="proceeding")&&z({currentLocation:w,nextLocation:b,historyAction:D}))return U}function Hr(w){let b=pt(404,{pathname:w}),D=l||a,{matches:O,route:U}=$i(D);return{notFoundMatches:O,route:U,error:b}}function Ri(w,b,D){if(E=w,M=b,C=D||null,!V&&P.navigation===Ys){V=!0;let O=qr(P.location,P.matches);O!=null&&Ne({restoreScrollPosition:O})}return()=>{E=null,M=null,C=null}}function Xt(w,b){return C&&C(w,b.map(O=>pf(O,P.loaderData)))||w.key}function Cn(w,b){if(E&&M){let D=Xt(w,b);E[D]=M()}}function qr(w,b){if(E){let D=Xt(w,b),O=E[D];if(typeof O=="number")return O}return null}function ft(w,b,D){if(r.patchRoutesOnNavigation)if(w){if(Object.keys(w[0].params).length>0)return{active:!0,matches:Yi(b,D,c,!0)}}else return{active:!0,matches:Yi(b,D,c,!0)||[]};return{active:!1,matches:null}}async function Tr(w,b,D,O){if(!r.patchRoutesOnNavigation)return{type:"success",matches:w};let U=w;for(;;){let z=l==null,G=l||a,H=s;try{await r.patchRoutesOnNavigation({signal:D,path:b,matches:U,fetcherKey:O,patch:(K,W)=>{D.aborted||kl(K,W,G,H,i,!1)}})}catch(K){return{type:"error",error:K,partialMatches:U}}finally{z&&!D.aborted&&(a=[...a])}if(D.aborted)return{type:"aborted"};let q=nr(G,b,c);if(q)return{type:"success",matches:q};let Z=Yi(G,b,c,!0);if(!Z||U.length===Z.length&&U.every((K,W)=>K.route.id===Z[W].route.id))return{type:"success",matches:null};U=Z}}function Wr(w){s={},l=ei(w,i,void 0,s)}function bi(w,b,D=!1){let O=l==null;kl(w,b,l||a,s,i,D),O&&(a=[...a],Ne({}))}return Q={get basename(){return c},get future(){return p},get state(){return P},get routes(){return a},get window(){return e},initialize:Or,subscribe:Us,enableScrollRestoration:Ri,navigate:Fr,fetch:wi,revalidate:Tn,createHref:w=>r.history.createHref(w),encodeLocation:w=>r.history.encodeLocation(w),getFetcher:wr,deleteFetcher:Ii,dispose:Fs,getBlocker:Sn,deleteBlocker:Ai,patchRoutes:bi,_internalFetchControllers:me,_internalSetRoutes:Wr,_internalSetStateDoNotUseOrYouWillBreakYourApp(w){Ne(w)}},Q}function jf(r){return r!=null&&("formData"in r&&r.formData!=null||"body"in r&&r.body!==void 0)}function go(r,e,t,n,i,s){let a,l;if(i){a=[];for(let h of e)if(a.push(h),h.route.id===i){l=h;break}}else a=e,l=e[e.length-1];let c=Xo(n||".",Yo(a),gt(r.pathname,t)||r.pathname,s==="path");if(n==null&&(c.search=r.search,c.hash=r.hash),(n==null||n===""||n===".")&&l){let h=Zo(c.search);if(l.route.index&&!h)c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index";else if(!l.route.index&&h){let p=new URLSearchParams(c.search),f=p.getAll("index");p.delete("index"),f.filter(E=>E).forEach(E=>p.append("index",E));let g=p.toString();c.search=g?`?${g}`:""}}return t!=="/"&&(c.pathname=Sf({basename:t,pathname:c.pathname})),dr(c)}function Nl(r,e,t){if(!t||!jf(t))return{path:e};if(t.formMethod&&!ip(t.formMethod))return{path:e,error:pt(405,{method:t.formMethod})};let n=()=>({path:e,error:pt(400,{type:"invalid-body"})}),s=(t.formMethod||"get").toUpperCase(),a=Uc(e);if(t.body!==void 0){if(t.formEncType==="text/plain"){if(!ut(s))return n();let f=typeof t.body=="string"?t.body:t.body instanceof FormData||t.body instanceof URLSearchParams?Array.from(t.body.entries()).reduce((g,[E,C])=>`${g}${E}=${C}
`,""):String(t.body);return{path:e,submission:{formMethod:s,formAction:a,formEncType:t.formEncType,formData:void 0,json:void 0,text:f}}}else if(t.formEncType==="application/json"){if(!ut(s))return n();try{let f=typeof t.body=="string"?JSON.parse(t.body):t.body;return{path:e,submission:{formMethod:s,formAction:a,formEncType:t.formEncType,formData:void 0,json:f,text:void 0}}}catch{return n()}}}oe(typeof FormData=="function","FormData is not available in this environment");let l,c;if(t.formData)l=vo(t.formData),c=t.formData;else if(t.body instanceof FormData)l=vo(t.body),c=t.body;else if(t.body instanceof URLSearchParams)l=t.body,c=Ul(l);else if(t.body==null)l=new URLSearchParams,c=new FormData;else try{l=new URLSearchParams(t.body),c=Ul(l)}catch{return n()}let h={formMethod:s,formAction:a,formEncType:t&&t.formEncType||"application/x-www-form-urlencoded",formData:c,json:void 0,text:void 0};if(ut(h.formMethod))return{path:e,submission:h};let p=vr(e);return r&&p.search&&Zo(p.search)&&l.append("index",""),p.search=`?${l}`,{path:dr(p),submission:h}}function xl(r,e,t,n,i,s,a,l,c,h,p,f,g,E,C,M,V,x,k,F){let J=F?dt(F[1])?F[1].error:F[1].data:void 0,Q=i.createURL(s.location),P=i.createURL(c),I;if(p&&s.errors){let v=Object.keys(s.errors)[0];I=a.findIndex(de=>de.route.id===v)}else if(F&&dt(F[1])){let v=F[0];I=a.findIndex(de=>de.route.id===v)-1}let _=F?F[1].statusCode:void 0,y=_&&_>=400,T={currentUrl:Q,currentParams:s.matches[0]?.params||{},nextUrl:P,nextParams:a[0].params,...l,actionResult:J,actionStatus:_},A=a.map((v,de)=>{let{route:qe}=v,me=null;if(I!=null&&de>I?me=!1:qe.lazy?me=!0:qe.loader==null?me=!1:p?me=_o(qe,s.loaderData,s.errors):zf(s.loaderData,s.matches[de],v)&&(me=!0),me!==null)return yo(t,n,r,v,h,e,me);let We=y?!1:f||Q.pathname+Q.search===P.pathname+P.search||Q.search!==P.search||Hf(s.matches[de],v),Me={...T,defaultShouldRevalidate:We},nt=cs(v,Me);return yo(t,n,r,v,h,e,nt,Me)}),R=[];return C.forEach((v,de)=>{if(p||!a.some(je=>je.route.id===v.routeId)||E.has(de))return;let qe=s.fetchers.get(de),me=qe&&qe.state!=="idle"&&qe.data===void 0,We=nr(V,v.path,x);if(!We){if(k&&me)return;R.push({key:de,routeId:v.routeId,path:v.path,matches:null,match:null,request:null,controller:null});return}if(M.has(de))return;let Me=Xi(We,v.path),nt=new AbortController,Ke=Xr(i,v.path,nt.signal),at=null;if(g.has(de))g.delete(de),at=rn(t,n,Ke,We,Me,h,e);else if(me)f&&(at=rn(t,n,Ke,We,Me,h,e));else{let je={...T,defaultShouldRevalidate:y?!1:f};cs(Me,je)&&(at=rn(t,n,Ke,We,Me,h,e,je))}at&&R.push({key:de,routeId:v.routeId,path:v.path,matches:at,match:Me,request:Ke,controller:nt})}),{dsMatches:A,revalidatingFetchers:R}}function _o(r,e,t){if(r.lazy)return!0;if(!r.loader)return!1;let n=e!=null&&r.id in e,i=t!=null&&t[r.id]!==void 0;return!n&&i?!1:typeof r.loader=="function"&&r.loader.hydrate===!0?!0:!n&&!i}function zf(r,e,t){let n=!e||t.route.id!==e.route.id,i=!r.hasOwnProperty(t.route.id);return n||i}function Hf(r,e){let t=r.route.path;return r.pathname!==e.pathname||t!=null&&t.endsWith("*")&&r.params["*"]!==e.params["*"]}function cs(r,e){if(r.route.shouldRevalidate){let t=r.route.shouldRevalidate(e);if(typeof t=="boolean")return t}return e.defaultShouldRevalidate}function kl(r,e,t,n,i,s){let a;if(r){let h=n[r];oe(h,`No route found to patch children into: routeId = ${r}`),h.children||(h.children=[]),a=h.children}else a=t;let l=[],c=[];if(e.forEach(h=>{let p=a.find(f=>kc(h,f));p?c.push({existingRoute:p,newRoute:h}):l.push(h)}),l.length>0){let h=ei(l,i,[r||"_","patch",String(a?.length||"0")],n);a.push(...h)}if(s&&c.length>0)for(let h=0;h<c.length;h++){let{existingRoute:p,newRoute:f}=c[h],g=p,[E]=ei([f],i,[],{},!0);Object.assign(g,{element:E.element?E.element:g.element,errorElement:E.errorElement?E.errorElement:g.errorElement,hydrateFallbackElement:E.hydrateFallbackElement?E.hydrateFallbackElement:g.hydrateFallbackElement})}}function kc(r,e){return"id"in r&&"id"in e&&r.id===e.id?!0:r.index===e.index&&r.path===e.path&&r.caseSensitive===e.caseSensitive?(!r.children||r.children.length===0)&&(!e.children||e.children.length===0)?!0:r.children.every((t,n)=>e.children?.some(i=>kc(t,i))):!1}var Ll=new WeakMap,Lc=({key:r,route:e,manifest:t,mapRouteProperties:n})=>{let i=t[e.id];if(oe(i,"No route found in manifest"),!i.lazy||typeof i.lazy!="object")return;let s=i.lazy[r];if(!s)return;let a=Ll.get(i);a||(a={},Ll.set(i,a));let l=a[r];if(l)return l;let c=(async()=>{let h=cf(r),f=i[r]!==void 0&&r!=="hasErrorBoundary";if(h)Be(!h,"Route property "+r+" is not a supported lazy route property. This property will be ignored."),a[r]=Promise.resolve();else if(f)Be(!1,`Route "${i.id}" has a static property "${r}" defined. The lazy property will be ignored.`);else{let g=await s();g!=null&&(Object.assign(i,{[r]:g}),Object.assign(i,n(i)))}typeof i.lazy=="object"&&(i.lazy[r]=void 0,Object.values(i.lazy).every(g=>g===void 0)&&(i.lazy=void 0))})();return a[r]=c,c},Ml=new WeakMap;function qf(r,e,t,n,i){let s=t[r.id];if(oe(s,"No route found in manifest"),!r.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof r.lazy=="function"){let p=Ml.get(s);if(p)return{lazyRoutePromise:p,lazyHandlerPromise:p};let f=(async()=>{oe(typeof r.lazy=="function","No lazy route function found");let g=await r.lazy(),E={};for(let C in g){let M=g[C];if(M===void 0)continue;let V=df(C),k=s[C]!==void 0&&C!=="hasErrorBoundary";V?Be(!V,"Route property "+C+" is not a supported property to be returned from a lazy route function. This property will be ignored."):k?Be(!k,`Route "${s.id}" has a static property "${C}" defined but its lazy function is also returning a value for this property. The lazy route property "${C}" will be ignored.`):E[C]=M}Object.assign(s,E),Object.assign(s,{...n(s),lazy:void 0})})();return Ml.set(s,f),f.catch(()=>{}),{lazyRoutePromise:f,lazyHandlerPromise:f}}let a=Object.keys(r.lazy),l=[],c;for(let p of a){if(i&&i.includes(p))continue;let f=Lc({key:p,route:r,manifest:t,mapRouteProperties:n});f&&(l.push(f),p===e&&(c=f))}let h=l.length>0?Promise.all(l).then(()=>{}):void 0;return h?.catch(()=>{}),c?.catch(()=>{}),{lazyRoutePromise:h,lazyHandlerPromise:c}}async function Ol(r){let e=r.matches.filter(i=>i.shouldLoad),t={};return(await Promise.all(e.map(i=>i.resolve()))).forEach((i,s)=>{t[e[s].route.id]=i}),t}async function Wf(r){return r.matches.some(e=>e.route.unstable_middleware)?Mc(r,()=>Ol(r)):Ol(r)}function Mc(r,e){return Gf(r,e,n=>n,tp,t);function t(n,i,s){if(s)return Promise.resolve(Object.assign(s.value,{[i]:{type:"error",result:n}}));{let{matches:a}=r,l=Math.min(a.findIndex(h=>h.route.id===i)||0,a.findIndex(h=>h.unstable_shouldCallHandler())||0),c=ir(a,a[l].route.id).route.id;return Promise.resolve({[c]:{type:"error",result:n}})}}}async function Gf(r,e,t,n,i){let{matches:s,request:a,params:l,context:c}=r,h=s.flatMap(f=>f.route.unstable_middleware?f.route.unstable_middleware.map(g=>[f.route.id,g]):[]);return await Oc({request:a,params:l,context:c},h,e,t,n,i)}async function Oc(r,e,t,n,i,s,a=0){let{request:l}=r;if(l.signal.aborted)throw l.signal.reason??new Error(`Request aborted: ${l.method} ${l.url}`);let c=e[a];if(!c)return await t();let[h,p]=c,f,g=async()=>{if(f)throw new Error("You may only call `next()` once per middleware");try{return f={value:await Oc(r,e,t,n,i,s,a+1)},f.value}catch(E){return f={value:await s(E,h,f)},f.value}};try{let E=await p(r,g),C=E!=null?n(E):void 0;return i(C)?C:f?C??f.value:(f={value:await g()},f.value)}catch(E){return await s(E,h,f)}}function Fc(r,e,t,n,i){let s=Lc({key:"unstable_middleware",route:n.route,manifest:e,mapRouteProperties:r}),a=qf(n.route,ut(t.method)?"action":"loader",e,r,i);return{middleware:s,route:a.lazyRoutePromise,handler:a.lazyHandlerPromise}}function yo(r,e,t,n,i,s,a,l=null){let c=!1,h=Fc(r,e,t,n,i);return{...n,_lazyPromises:h,shouldLoad:a,unstable_shouldRevalidateArgs:l,unstable_shouldCallHandler(p){return c=!0,l?typeof p=="boolean"?cs(n,{...l,defaultShouldRevalidate:p}):cs(n,l):a},resolve(p){return c||a||p&&!ut(t.method)&&(n.route.lazy||n.route.loader)?Qf({request:t,match:n,lazyHandlerPromise:h?.handler,lazyRoutePromise:h?.route,handlerOverride:p,scopedContext:s}):Promise.resolve({type:"data",result:void 0})}}}function rn(r,e,t,n,i,s,a,l=null){return n.map(c=>c.route.id!==i.route.id?{...c,shouldLoad:!1,unstable_shouldRevalidateArgs:l,unstable_shouldCallHandler:()=>!1,_lazyPromises:Fc(r,e,t,c,s),resolve:()=>Promise.resolve({type:"data",result:void 0})}:yo(r,e,t,c,s,a,!0,l))}async function Kf(r,e,t,n,i,s){t.some(h=>h._lazyPromises?.middleware)&&await Promise.all(t.map(h=>h._lazyPromises?.middleware));let a={request:e,params:t[0].params,context:i,matches:t},c=await r({...a,fetcherKey:n,unstable_runClientMiddleware:h=>{let p=a;return Mc(p,()=>h({...p,fetcherKey:n,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}}))}});try{await Promise.all(t.flatMap(h=>[h._lazyPromises?.handler,h._lazyPromises?.route]))}catch{}return c}async function Qf({request:r,match:e,lazyHandlerPromise:t,lazyRoutePromise:n,handlerOverride:i,scopedContext:s}){let a,l,c=ut(r.method),h=c?"action":"loader",p=f=>{let g,E=new Promise((V,x)=>g=x);l=()=>g(),r.signal.addEventListener("abort",l);let C=V=>typeof f!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${h}" [routeId: ${e.route.id}]`)):f({request:r,params:e.params,context:s},...V!==void 0?[V]:[]),M=(async()=>{try{return{type:"data",result:await(i?i(x=>C(x)):C())}}catch(V){return{type:"error",result:V}}})();return Promise.race([M,E])};try{let f=c?e.route.action:e.route.loader;if(t||n)if(f){let g,[E]=await Promise.all([p(f).catch(C=>{g=C}),t,n]);if(g!==void 0)throw g;a=E}else{await t;let g=c?e.route.action:e.route.loader;if(g)[a]=await Promise.all([p(g),n]);else if(h==="action"){let E=new URL(r.url),C=E.pathname+E.search;throw pt(405,{method:r.method,pathname:C,routeId:e.route.id})}else return{type:"data",result:void 0}}else if(f)a=await p(f);else{let g=new URL(r.url),E=g.pathname+g.search;throw pt(404,{pathname:E})}}catch(f){return{type:"error",result:f}}finally{l&&r.signal.removeEventListener("abort",l)}return a}async function Yf(r){let e=r.headers.get("Content-Type");return e&&/\bapplication\/json\b/.test(e)?r.body==null?null:r.json():r.text()}async function Xf(r){let{result:e,type:t}=r;if($c(e)){let n;try{n=await Yf(e)}catch(i){return{type:"error",error:i}}return t==="error"?{type:"error",error:new us(e.status,e.statusText,n),statusCode:e.status,headers:e.headers}:{type:"data",data:n,statusCode:e.status,headers:e.headers}}return t==="error"?zl(e)?e.data instanceof Error?{type:"error",error:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:new us(e.init?.status||500,void 0,e.data),statusCode:ti(e)?e.status:void 0,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"error",error:e,statusCode:ti(e)?e.status:void 0}:zl(e)?{type:"data",data:e.data,statusCode:e.init?.status,headers:e.init?.headers?new Headers(e.init.headers):void 0}:{type:"data",data:e}}function Jf(r,e,t,n,i){let s=r.headers.get("Location");if(oe(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!Jo(s)){let a=n.slice(0,n.findIndex(l=>l.route.id===t)+1);s=go(new URL(e.url),a,i,s),r.headers.set("Location",s)}return r}function Fl(r,e,t){if(Jo(r)){let n=r,i=n.startsWith("//")?new URL(e.protocol+n):new URL(n),s=gt(i.pathname,t)!=null;if(i.origin===e.origin&&s)return i.pathname+i.search+i.hash}return r}function Xr(r,e,t,n){let i=r.createURL(Uc(e)).toString(),s={signal:t};if(n&&ut(n.formMethod)){let{formMethod:a,formEncType:l}=n;s.method=a.toUpperCase(),l==="application/json"?(s.headers=new Headers({"Content-Type":l}),s.body=JSON.stringify(n.json)):l==="text/plain"?s.body=n.text:l==="application/x-www-form-urlencoded"&&n.formData?s.body=vo(n.formData):s.body=n.formData}return new Request(i,s)}function vo(r){let e=new URLSearchParams;for(let[t,n]of r.entries())e.append(t,typeof n=="string"?n:n.name);return e}function Ul(r){let e=new FormData;for(let[t,n]of r.entries())e.append(t,n);return e}function Zf(r,e,t,n=!1,i=!1){let s={},a=null,l,c=!1,h={},p=t&&dt(t[1])?t[1].error:void 0;return r.forEach(f=>{if(!(f.route.id in e))return;let g=f.route.id,E=e[g];if(oe(!Cr(E),"Cannot handle redirect results in processLoaderData"),dt(E)){let C=E.error;if(p!==void 0&&(C=p,p=void 0),a=a||{},i)a[g]=C;else{let M=ir(r,g);a[M.route.id]==null&&(a[M.route.id]=C)}n||(s[g]=xc),c||(c=!0,l=ti(E.error)?E.error.status:500),E.headers&&(h[g]=E.headers)}else s[g]=E.data,E.statusCode&&E.statusCode!==200&&!c&&(l=E.statusCode),E.headers&&(h[g]=E.headers)}),p!==void 0&&t&&(a={[t[0]]:p},t[2]&&(s[t[2]]=void 0)),{loaderData:s,errors:a,statusCode:l||200,loaderHeaders:h}}function $l(r,e,t,n,i,s){let{loaderData:a,errors:l}=Zf(e,t,n);return i.filter(c=>!c.matches||c.matches.some(h=>h.shouldLoad)).forEach(c=>{let{key:h,match:p,controller:f}=c;if(f&&f.signal.aborted)return;let g=s[h];if(oe(g,"Did not find corresponding fetcher result"),dt(g)){let E=ir(r.matches,p?.route.id);l&&l[E.route.id]||(l={...l,[E.route.id]:g.error}),r.fetchers.delete(h)}else if(Cr(g))oe(!1,"Unhandled fetcher revalidation redirect");else{let E=rr(g.data);r.fetchers.set(h,E)}}),{loaderData:a,errors:l}}function Bl(r,e,t,n){let i=Object.entries(e).filter(([,s])=>s!==xc).reduce((s,[a,l])=>(s[a]=l,s),{});for(let s of t){let a=s.route.id;if(!e.hasOwnProperty(a)&&r.hasOwnProperty(a)&&s.route.loader&&(i[a]=r[a]),n&&n.hasOwnProperty(a))break}return i}function jl(r){return r?dt(r[1])?{actionData:{}}:{actionData:{[r[0]]:r[1].data}}:{}}function ir(r,e){return(e?r.slice(0,r.findIndex(n=>n.route.id===e)+1):[...r]).reverse().find(n=>n.route.hasErrorBoundary===!0)||r[0]}function $i(r){let e=r.length===1?r[0]:r.find(t=>t.index||!t.path||t.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function pt(r,{pathname:e,routeId:t,method:n,type:i,message:s}={}){let a="Unknown Server Error",l="Unknown @remix-run/router error";return r===400?(a="Bad Request",n&&e&&t?l=`You made a ${n} request to "${e}" but did not provide a \`loader\` for route "${t}", so there is no way to handle the request.`:i==="invalid-body"&&(l="Unable to encode submission body")):r===403?(a="Forbidden",l=`Route "${t}" does not match URL "${e}"`):r===404?(a="Not Found",l=`No route matches URL "${e}"`):r===405&&(a="Method Not Allowed",n&&e&&t?l=`You made a ${n.toUpperCase()} request to "${e}" but did not provide an \`action\` for route "${t}", so there is no way to handle the request.`:n&&(l=`Invalid request method "${n.toUpperCase()}"`)),new us(r||500,a,new Error(l),!0)}function Bi(r){let e=Object.entries(r);for(let t=e.length-1;t>=0;t--){let[n,i]=e[t];if(Cr(i))return{key:n,result:i}}}function Uc(r){let e=typeof r=="string"?vr(r):r;return dr({...e,hash:""})}function ep(r,e){return r.pathname!==e.pathname||r.search!==e.search?!1:r.hash===""?e.hash!=="":r.hash===e.hash?!0:e.hash!==""}function tp(r){return r!=null&&typeof r=="object"&&Object.entries(r).every(([e,t])=>typeof e=="string"&&rp(t))}function rp(r){return r!=null&&typeof r=="object"&&"type"in r&&"result"in r&&(r.type==="data"||r.type==="error")}function np(r){return $c(r.result)&&Mf.has(r.result.status)}function dt(r){return r.type==="error"}function Cr(r){return(r&&r.type)==="redirect"}function zl(r){return typeof r=="object"&&r!=null&&"type"in r&&"data"in r&&"init"in r&&r.type==="DataWithResponseInit"}function $c(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.headers=="object"&&typeof r.body<"u"}function ip(r){return Lf.has(r.toUpperCase())}function ut(r){return xf.has(r.toUpperCase())}function Zo(r){return new URLSearchParams(r).getAll("index").some(e=>e==="")}function Xi(r,e){let t=typeof e=="string"?vr(e).search:e.search;if(r[r.length-1].route.index&&Zo(t||""))return r[r.length-1];let n=Dc(r);return n[n.length-1]}function Hl(r){let{formMethod:e,formAction:t,formEncType:n,text:i,formData:s,json:a}=r;if(!(!e||!t||!n)){if(i!=null)return{formMethod:e,formAction:t,formEncType:n,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:e,formAction:t,formEncType:n,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:e,formAction:t,formEncType:n,formData:void 0,json:a,text:void 0}}}function Xs(r,e){return e?{state:"loading",location:r,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:r,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function sp(r,e){return{state:"submitting",location:r,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function Un(r,e){return r?{state:"loading",formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function op(r,e){return{state:"submitting",formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text,data:e?e.data:void 0}}function rr(r){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:r}}function ap(r,e){try{let t=r.sessionStorage.getItem(Nc);if(t){let n=JSON.parse(t);for(let[i,s]of Object.entries(n||{}))s&&Array.isArray(s)&&e.set(i,new Set(s||[]))}}catch{}}function lp(r,e){if(e.size>0){let t={};for(let[n,i]of e)t[n]=[...i];try{r.sessionStorage.setItem(Nc,JSON.stringify(t))}catch(n){Be(!1,`Failed to save applied view transitions in sessionStorage (${n}).`)}}}function up(){let r,e,t=new Promise((n,i)=>{r=async s=>{n(s);try{await t}catch{}},e=async s=>{i(s);try{await t}catch{}}});return{promise:t,resolve:r,reject:e}}var kr=_t(null);kr.displayName="DataRouter";var hi=_t(null);hi.displayName="DataRouterState";_t(!1);var ea=_t({isTransitioning:!1});ea.displayName="ViewTransition";var Bc=_t(new Map);Bc.displayName="Fetchers";var cp=_t(null);cp.displayName="Await";var Ft=_t(null);Ft.displayName="Navigation";var As=_t(null);As.displayName="Location";var Qt=_t({outlet:null,matches:[],isDataRoute:!1});Qt.displayName="Route";var ta=_t(null);ta.displayName="RouteError";function hp(r,{relative:e}={}){oe(di(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=ye(Ft),{hash:i,pathname:s,search:a}=fi(r,{relative:e}),l=s;return t!=="/"&&(l=s==="/"?t:kt([t,s])),n.createHref({pathname:l,search:a,hash:i})}function di(){return ye(As)!=null}function Lr(){return oe(di(),"useLocation() may be used only in the context of a <Router> component."),ye(As).location}var jc="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zc(r){ye(Ft).static||Ec(r)}function Hc(){let{isDataRoute:r}=ye(Qt);return r?Ap():dp()}function dp(){oe(di(),"useNavigate() may be used only in the context of a <Router> component.");let r=ye(kr),{basename:e,navigator:t}=ye(Ft),{matches:n}=ye(Qt),{pathname:i}=Lr(),s=JSON.stringify(Yo(n)),a=Is(!1);return zc(()=>{a.current=!0}),cn((c,h={})=>{if(Be(a.current,jc),!a.current)return;if(typeof c=="number"){t.go(c);return}let p=Xo(c,JSON.parse(s),i,h.relative==="path");r==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:kt([e,p.pathname])),(h.replace?t.replace:t.push)(p,h.state,h)},[e,t,s,i,r])}_t(null);function fi(r,{relative:e}={}){let{matches:t}=ye(Qt),{pathname:n}=Lr(),i=JSON.stringify(Yo(t));return mt(()=>Xo(r,JSON.parse(i),n,e==="path"),[r,i,n,e])}function fp(r,e,t,n,i){oe(di(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=ye(Ft),{matches:a}=ye(Qt),l=a[a.length-1],c=l?l.params:{},h=l?l.pathname:"/",p=l?l.pathnameBase:"/",f=l&&l.route;{let k=f&&f.path||"";qc(h,!f||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let g=Lr(),E;E=g;let C=E.pathname||"/",M=C;if(p!=="/"){let k=p.replace(/^\//,"").split("/");M="/"+C.replace(/^\//,"").split("/").slice(k.length).join("/")}let V=nr(r,{pathname:M});return Be(f||V!=null,`No routes matched location "${E.pathname}${E.search}${E.hash}" `),Be(V==null||V[V.length-1].route.element!==void 0||V[V.length-1].route.Component!==void 0||V[V.length-1].route.lazy!==void 0,`Matched leaf route at location "${E.pathname}${E.search}${E.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),yp(V&&V.map(k=>Object.assign({},k,{params:Object.assign({},c,k.params),pathname:kt([p,s.encodeLocation?s.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?p:kt([p,s.encodeLocation?s.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),a,t,n,i)}function pp(){let r=Ip(),e=ti(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},a=null;return console.error("Error handled by React Router default ErrorBoundary:",r),a=re(It,null,re("p",null,"💿 Hey developer 👋"),re("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",re("code",{style:s},"ErrorBoundary")," or"," ",re("code",{style:s},"errorElement")," prop on your route.")),re(It,null,re("h2",null,"Unexpected Application Error!"),re("h3",{style:{fontStyle:"italic"}},e),t?re("pre",{style:i},t):null,a)}var mp=re(pp,null),gp=class extends xt{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){this.props.unstable_onError?this.props.unstable_onError(r,e):console.error("React Router caught the following error during render",r)}render(){return this.state.error!==void 0?re(Qt.Provider,{value:this.props.routeContext},re(ta.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function _p({routeContext:r,match:e,children:t}){let n=ye(kr);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),re(Qt.Provider,{value:r},t)}function yp(r,e=[],t=null,n=null,i=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let s=r,a=t?.errors;if(a!=null){let h=s.findIndex(p=>p.route.id&&a?.[p.route.id]!==void 0);oe(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,h+1))}let l=!1,c=-1;if(t)for(let h=0;h<s.length;h++){let p=s[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=h),p.route.id){let{loaderData:f,errors:g}=t,E=p.route.loader&&!f.hasOwnProperty(p.route.id)&&(!g||g[p.route.id]===void 0);if(p.route.lazy||E){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((h,p,f)=>{let g,E=!1,C=null,M=null;t&&(g=a&&p.route.id?a[p.route.id]:void 0,C=p.route.errorElement||mp,l&&(c<0&&f===0?(qc("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,M=null):c===f&&(E=!0,M=p.route.hydrateFallbackElement||null)));let V=e.concat(s.slice(0,f+1)),x=()=>{let k;return g?k=C:E?k=M:p.route.Component?k=re(p.route.Component,null):p.route.element?k=p.route.element:k=h,re(_p,{match:p,routeContext:{outlet:h,matches:V,isDataRoute:t!=null},children:k})};return t&&(p.route.ErrorBoundary||p.route.errorElement||f===0)?re(gp,{location:t.location,revalidation:t.revalidation,component:C,error:g,children:x(),routeContext:{outlet:null,matches:V,isDataRoute:!0},unstable_onError:n}):x()},null)}function ra(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function vp(r){let e=ye(kr);return oe(e,ra(r)),e}function Ep(r){let e=ye(hi);return oe(e,ra(r)),e}function wp(r){let e=ye(Qt);return oe(e,ra(r)),e}function na(r){let e=wp(r),t=e.matches[e.matches.length-1];return oe(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function Tp(){return na("useRouteId")}function Ip(){let r=ye(ta),e=Ep("useRouteError"),t=na("useRouteError");return r!==void 0?r:e.errors?.[t]}function Ap(){let{router:r}=vp("useNavigate"),e=na("useNavigate"),t=Is(!1);return zc(()=>{t.current=!0}),cn(async(i,s={})=>{Be(t.current,jc),t.current&&(typeof i=="number"?r.navigate(i):await r.navigate(i,{fromRouteId:e,...s}))},[r,e])}var ql={};function qc(r,e,t){!e&&!ql[r]&&(ql[r]=!0,Be(!1,t))}var Wl={};function Gl(r,e){!r&&!Wl[e]&&(Wl[e]=!0,console.warn(e))}function Rp(r){let e={hasErrorBoundary:r.hasErrorBoundary||r.ErrorBoundary!=null||r.errorElement!=null};return r.Component&&(r.element&&Be(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(e,{element:re(r.Component),Component:void 0})),r.HydrateFallback&&(r.hydrateFallbackElement&&Be(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(e,{hydrateFallbackElement:re(r.HydrateFallback),HydrateFallback:void 0})),r.ErrorBoundary&&(r.errorElement&&Be(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(e,{errorElement:re(r.ErrorBoundary),ErrorBoundary:void 0})),e}var bp=["HydrateFallback","hydrateFallbackElement"],Sp=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function Cp({router:r,flushSync:e,unstable_onError:t}){let[n,i]=it(r.state),[s,a]=it(),[l,c]=it({isTransitioning:!1}),[h,p]=it(),[f,g]=it(),[E,C]=it(),M=Is(new Map),V=cn(Q=>{i(P=>(Q.errors&&t&&Object.entries(Q.errors).forEach(([I,_])=>{P.errors?.[I]!==_&&t(_)}),Q))},[t]),x=cn((Q,{deletedFetchers:P,flushSync:I,viewTransitionOpts:_})=>{Q.fetchers.forEach((T,A)=>{T.data!==void 0&&M.current.set(A,T.data)}),P.forEach(T=>M.current.delete(T)),Gl(I===!1||e!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let y=r.window!=null&&r.window.document!=null&&typeof r.window.document.startViewTransition=="function";if(Gl(_==null||y,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!_||!y){e&&I?e(()=>V(Q)):vl(()=>V(Q));return}if(e&&I){e(()=>{f&&(h&&h.resolve(),f.skipTransition()),c({isTransitioning:!0,flushSync:!0,currentLocation:_.currentLocation,nextLocation:_.nextLocation})});let T=r.window.document.startViewTransition(()=>{e(()=>V(Q))});T.finished.finally(()=>{e(()=>{p(void 0),g(void 0),a(void 0),c({isTransitioning:!1})})}),e(()=>g(T));return}f?(h&&h.resolve(),f.skipTransition(),C({state:Q,currentLocation:_.currentLocation,nextLocation:_.nextLocation})):(a(Q),c({isTransitioning:!0,flushSync:!1,currentLocation:_.currentLocation,nextLocation:_.nextLocation}))},[r.window,e,f,h,V]);Ec(()=>r.subscribe(x),[r,x]),Wt(()=>{l.isTransitioning&&!l.flushSync&&p(new Sp)},[l]),Wt(()=>{if(h&&s&&r.window){let Q=s,P=h.promise,I=r.window.document.startViewTransition(async()=>{vl(()=>V(Q)),await P});I.finished.finally(()=>{p(void 0),g(void 0),a(void 0),c({isTransitioning:!1})}),g(I)}},[s,h,r.window,V]),Wt(()=>{h&&s&&n.location.key===s.location.key&&h.resolve()},[h,f,n.location,s]),Wt(()=>{!l.isTransitioning&&E&&(a(E.state),c({isTransitioning:!0,flushSync:!1,currentLocation:E.currentLocation,nextLocation:E.nextLocation}),C(void 0))},[l.isTransitioning,E]);let k=mt(()=>({createHref:r.createHref,encodeLocation:r.encodeLocation,go:Q=>r.navigate(Q),push:(Q,P,I)=>r.navigate(Q,{state:P,preventScrollReset:I?.preventScrollReset}),replace:(Q,P,I)=>r.navigate(Q,{replace:!0,state:P,preventScrollReset:I?.preventScrollReset})}),[r]),F=r.basename||"/",J=mt(()=>({router:r,navigator:k,static:!1,basename:F,unstable_onError:t}),[r,k,F,t]);return re(It,null,re(kr.Provider,{value:J},re(hi.Provider,{value:n},re(Bc.Provider,{value:M.current},re(ea.Provider,{value:l},re(Vp,{basename:F,location:n.location,navigationType:n.historyAction,navigator:k},re(Pp,{routes:r.routes,future:r.future,state:n,unstable_onError:t})))))),null)}var Pp=zd(Dp);function Dp({routes:r,future:e,state:t,unstable_onError:n}){return fp(r,void 0,t,n,e)}function Vp({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:i,static:s=!1}){oe(!di(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=r.replace(/^\/*/,"/"),l=mt(()=>({basename:a,navigator:i,static:s,future:{}}),[a,i,s]);typeof t=="string"&&(t=vr(t));let{pathname:c="/",search:h="",hash:p="",state:f=null,key:g="default"}=t,E=mt(()=>{let C=gt(c,a);return C==null?null:{location:{pathname:C,search:h,hash:p,state:f,key:g},navigationType:n}},[a,c,h,p,f,g,n]);return Be(E!=null,`<Router basename="${a}"> is not able to match the URL "${c}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:re(Ft.Provider,{value:l},re(As.Provider,{children:e,value:E}))}var Ji="get",Zi="application/x-www-form-urlencoded";function Rs(r){return r!=null&&typeof r.tagName=="string"}function Np(r){return Rs(r)&&r.tagName.toLowerCase()==="button"}function xp(r){return Rs(r)&&r.tagName.toLowerCase()==="form"}function kp(r){return Rs(r)&&r.tagName.toLowerCase()==="input"}function Lp(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function Mp(r,e){return r.button===0&&(!e||e==="_self")&&!Lp(r)}var ji=null;function Op(){if(ji===null)try{new FormData(document.createElement("form"),0),ji=!1}catch{ji=!0}return ji}var Fp=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Js(r){return r!=null&&!Fp.has(r)?(Be(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Zi}"`),null):r}function Up(r,e){let t,n,i,s,a;if(xp(r)){let l=r.getAttribute("action");n=l?gt(l,e):null,t=r.getAttribute("method")||Ji,i=Js(r.getAttribute("enctype"))||Zi,s=new FormData(r)}else if(Np(r)||kp(r)&&(r.type==="submit"||r.type==="image")){let l=r.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=r.getAttribute("formaction")||l.getAttribute("action");if(n=c?gt(c,e):null,t=r.getAttribute("formmethod")||l.getAttribute("method")||Ji,i=Js(r.getAttribute("formenctype"))||Js(l.getAttribute("enctype"))||Zi,s=new FormData(l,r),!Op()){let{name:h,type:p,value:f}=r;if(p==="image"){let g=h?`${h}.`:"";s.append(`${g}x`,"0"),s.append(`${g}y`,"0")}else h&&s.append(h,f)}}else{if(Rs(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Ji,n=null,i=Zi,a=r}return s&&i==="text/plain"&&(a=s,s=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function ia(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function $p(r,e,t){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&gt(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function Bp(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function jp(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function zp(r,e,t){let n=await Promise.all(r.map(async i=>{let s=e.routes[i.route.id];if(s){let a=await Bp(s,t);return a.links?a.links():[]}return[]}));return Gp(n.flat(1).filter(jp).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function Kl(r,e,t,n,i,s){let a=(c,h)=>t[h]?c.route.id!==t[h].route.id:!0,l=(c,h)=>t[h].pathname!==c.pathname||t[h].route.path?.endsWith("*")&&t[h].params["*"]!==c.params["*"];return s==="assets"?e.filter((c,h)=>a(c,h)||l(c,h)):s==="data"?e.filter((c,h)=>{let p=n.routes[c.route.id];if(!p||!p.hasLoader)return!1;if(a(c,h)||l(c,h))return!0;if(c.route.shouldRevalidate){let f=c.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Hp(r,e,{includeHydrateFallback:t}={}){return qp(r.map(n=>{let i=e.routes[n.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),t&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function qp(r){return[...new Set(r)]}function Wp(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function Gp(r,e){let t=new Set;return new Set(e),r.reduce((n,i)=>{let s=JSON.stringify(Wp(i));return t.has(s)||(t.add(s),n.push({key:s,link:i})),n},[])}function Wc(){let r=ye(kr);return ia(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function Kp(){let r=ye(hi);return ia(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var sa=_t(void 0);sa.displayName="FrameworkContext";function Gc(){let r=ye(sa);return ia(r,"You must render this element inside a <HydratedRouter> element"),r}function Qp(r,e){let t=ye(sa),[n,i]=it(!1),[s,a]=it(!1),{onFocus:l,onBlur:c,onMouseEnter:h,onMouseLeave:p,onTouchStart:f}=e,g=Is(null);Wt(()=>{if(r==="render"&&a(!0),r==="viewport"){let M=x=>{x.forEach(k=>{a(k.isIntersecting)})},V=new IntersectionObserver(M,{threshold:.5});return g.current&&V.observe(g.current),()=>{V.disconnect()}}},[r]),Wt(()=>{if(n){let M=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(M)}}},[n]);let E=()=>{i(!0)},C=()=>{i(!1),a(!1)};return t?r!=="intent"?[s,g,{}]:[s,g,{onFocus:$n(l,E),onBlur:$n(c,C),onMouseEnter:$n(h,E),onMouseLeave:$n(p,C),onTouchStart:$n(f,E)}]:[!1,g,{}]}function $n(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function Yp({page:r,...e}){let{router:t}=Wc(),n=mt(()=>nr(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?re(Jp,{page:r,matches:n,...e}):null}function Xp(r){let{manifest:e,routeModules:t}=Gc(),[n,i]=it([]);return Wt(()=>{let s=!1;return zp(r,e,t).then(a=>{s||i(a)}),()=>{s=!0}},[r,e,t]),n}function Jp({page:r,matches:e,...t}){let n=Lr(),{manifest:i,routeModules:s}=Gc(),{basename:a}=Wc(),{loaderData:l,matches:c}=Kp(),h=mt(()=>Kl(r,e,c,i,n,"data"),[r,e,c,i,n]),p=mt(()=>Kl(r,e,c,i,n,"assets"),[r,e,c,i,n]),f=mt(()=>{if(r===n.pathname+n.search+n.hash)return[];let C=new Set,M=!1;if(e.forEach(x=>{let k=i.routes[x.route.id];!k||!k.hasLoader||(!h.some(F=>F.route.id===x.route.id)&&x.route.id in l&&s[x.route.id]?.shouldRevalidate||k.hasClientLoader?M=!0:C.add(x.route.id))}),C.size===0)return[];let V=$p(r,a,"data");return M&&C.size>0&&V.searchParams.set("_routes",e.filter(x=>C.has(x.route.id)).map(x=>x.route.id).join(",")),[V.pathname+V.search]},[a,l,n,i,h,e,r,s]),g=mt(()=>Hp(p,i),[p,i]),E=Xp(p);return re(It,null,f.map(C=>re("link",{key:C,rel:"prefetch",as:"fetch",href:C,...t})),g.map(C=>re("link",{key:C,rel:"modulepreload",href:C,...t})),E.map(({key:C,link:M})=>re("link",{key:C,nonce:t.nonce,...M})))}function Zp(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Kc=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Kc&&(window.__reactRouterVersion="7.8.2")}catch{}function em(r,e){return Bf({basename:e?.basename,unstable_getContext:e?.unstable_getContext,future:e?.future,history:of({window:e?.window}),hydrationData:tm(),routes:r,mapRouteProperties:Rp,hydrationRouteProperties:bp,dataStrategy:e?.dataStrategy,patchRoutesOnNavigation:e?.patchRoutesOnNavigation,window:e?.window}).initialize()}function tm(){let r=window?.__staticRouterHydrationData;return r&&r.errors&&(r={...r,errors:rm(r.errors)}),r}function rm(r){if(!r)return null;let e=Object.entries(r),t={};for(let[n,i]of e)if(i&&i.__type==="RouteErrorResponse")t[n]=new us(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",t[n]=a}catch{}}if(t[n]==null){let s=new Error(i.message);s.stack="",t[n]=s}}else t[n]=i;return t}var Qc=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yc=Qo(function({onClick:e,discover:t="render",prefetch:n="none",relative:i,reloadDocument:s,replace:a,state:l,target:c,to:h,preventScrollReset:p,viewTransition:f,...g},E){let{basename:C}=ye(Ft),M=typeof h=="string"&&Qc.test(h),V,x=!1;if(typeof h=="string"&&M&&(V=h,Kc))try{let y=new URL(window.location.href),T=h.startsWith("//")?new URL(y.protocol+h):new URL(h),A=gt(T.pathname,C);T.origin===y.origin&&A!=null?h=A+T.search+T.hash:x=!0}catch{Be(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=hp(h,{relative:i}),[F,J,Q]=Qp(n,g),P=om(h,{replace:a,state:l,target:c,preventScrollReset:p,relative:i,viewTransition:f});function I(y){e&&e(y),y.defaultPrevented||P(y)}let _=re("a",{...g,...Q,href:V||k,onClick:x||s?e:I,ref:Zp(E,J),target:c,"data-discover":!M&&t==="render"?"true":void 0});return F&&!M?re(It,null,_,re(Yp,{page:k})):_});Yc.displayName="Link";var nm=Qo(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:i=!1,style:s,to:a,viewTransition:l,children:c,...h},p){let f=fi(a,{relative:h.relative}),g=Lr(),E=ye(hi),{navigator:C,basename:M}=ye(Ft),V=E!=null&&hm(f)&&l===!0,x=C.encodeLocation?C.encodeLocation(f).pathname:f.pathname,k=g.pathname,F=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;t||(k=k.toLowerCase(),F=F?F.toLowerCase():null,x=x.toLowerCase()),F&&M&&(F=gt(F,M)||F);const J=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let Q=k===x||!i&&k.startsWith(x)&&k.charAt(J)==="/",P=F!=null&&(F===x||!i&&F.startsWith(x)&&F.charAt(x.length)==="/"),I={isActive:Q,isPending:P,isTransitioning:V},_=Q?e:void 0,y;typeof n=="function"?y=n(I):y=[n,Q?"active":null,P?"pending":null,V?"transitioning":null].filter(Boolean).join(" ");let T=typeof s=="function"?s(I):s;return re(Yc,{...h,"aria-current":_,className:y,ref:p,style:T,to:a,viewTransition:l},typeof c=="function"?c(I):c)});nm.displayName="NavLink";var im=Qo(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:i,state:s,method:a=Ji,action:l,onSubmit:c,relative:h,preventScrollReset:p,viewTransition:f,...g},E)=>{let C=um(),M=cm(l,{relative:h}),V=a.toLowerCase()==="get"?"get":"post",x=typeof l=="string"&&Qc.test(l);return re("form",{ref:E,method:V,action:M,onSubmit:n?c:F=>{if(c&&c(F),F.defaultPrevented)return;F.preventDefault();let J=F.nativeEvent.submitter,Q=J?.getAttribute("formmethod")||a;C(J||F.currentTarget,{fetcherKey:e,method:Q,navigate:t,replace:i,state:s,relative:h,preventScrollReset:p,viewTransition:f})},...g,"data-discover":!x&&r==="render"?"true":void 0})});im.displayName="Form";function sm(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Xc(r){let e=ye(kr);return oe(e,sm(r)),e}function om(r,{target:e,replace:t,state:n,preventScrollReset:i,relative:s,viewTransition:a}={}){let l=Hc(),c=Lr(),h=fi(r,{relative:s});return cn(p=>{if(Mp(p,e)){p.preventDefault();let f=t!==void 0?t:dr(c)===dr(h);l(r,{replace:f,state:n,preventScrollReset:i,relative:s,viewTransition:a})}},[c,l,h,t,n,e,r,i,s,a])}var am=0,lm=()=>`__${String(++am)}__`;function um(){let{router:r}=Xc("useSubmit"),{basename:e}=ye(Ft),t=Tp();return cn(async(n,i={})=>{let{action:s,method:a,encType:l,formData:c,body:h}=Up(n,e);if(i.navigate===!1){let p=i.fetcherKey||lm();await r.fetch(p,t,i.action||s,{preventScrollReset:i.preventScrollReset,formData:c,body:h,formMethod:i.method||a,formEncType:i.encType||l,flushSync:i.flushSync})}else await r.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:c,body:h,formMethod:i.method||a,formEncType:i.encType||l,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[r,e,t])}function cm(r,{relative:e}={}){let{basename:t}=ye(Ft),n=ye(Qt);oe(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),s={...fi(r||".",{relative:e})},a=Lr();if(r==null){s.search=a.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(p=>p==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let p=l.toString();s.search=p?`?${p}`:""}}return(!r||r===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(s.pathname=s.pathname==="/"?t:kt([t,s.pathname])),dr(s)}function hm(r,{relative:e}={}){let t=ye(ea);oe(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Xc("useViewTransitionState"),i=fi(r,{relative:e});if(!t.isTransitioning)return!1;let s=gt(t.currentLocation.pathname,n)||t.currentLocation.pathname,a=gt(t.nextLocation.pathname,n)||t.nextLocation.pathname;return ls(i.pathname,a)!=null||ls(i.pathname,s)!=null}function dm(r){return re(Cp,{flushSync:rf,...r})}const fm="/assets/LOGO-CLmBQeHR.png",pm=()=>ee("div",{className:"navbar",children:ee("img",{src:fm,alt:"iotelligence",className:"navbar-logo"})}),mm=()=>{const[r,e]=it(!1);return ee("div",{children:ee("div",{className:"signIn",children:[ee("h1",{children:"Login"}),ee("form",{onSubmit:n=>{n.preventDefault(),e(!0),setTimeout(()=>{window.location.href="/"},1e3)},children:[ee("input",{type:"email",placeholder:"Enter email (not checked)",required:!0}),ee("input",{type:"password",placeholder:"Enter password (not checked)",required:!0}),ee("button",{type:"submit",disabled:r,children:r?"Logging in...":"Login"})]})]})})};function gm({sensor:r,measurement:e,unit:t}){let n="border-green";return e>=1&&e<=500?n="border-red":e>=501&&e<=1200?n="border-yellow":e>=1201&&e<=1600?n="border-green":n="border-red",ee("div",{className:`sensor-card ${n}`,children:[ee("span",{className:"sensor-label",children:r}),ee("div",{className:"sensor-data",children:[ee("span",{className:"sensor-value",children:e}),e<=1600&&ee("span",{className:"sensor-unit",children:t}),e>=1601&&ee("span",{className:"sensor-unit",children:"Warning pressure is too high ⚠️"}),e<=0&&ee("span",{className:"sensor-unit",children:"No pressure detected ❌"})]})]})}function Ql({heading:r,sensors:e}){return ee("div",{className:"dashboard-section",children:[ee("h2",{className:"dashboard-heading",children:r}),ee("div",{className:"dashboard-grid",children:e.map((t,n)=>ee(gm,{...t},n))})]})}const _m=()=>{};var Yl={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jc=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},ym=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],l=r[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Zc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,l=a?r[i+1]:0,c=i+2<r.length,h=c?r[i+2]:0,p=s>>2,f=(s&3)<<4|l>>4;let g=(l&15)<<2|h>>6,E=h&63;c||(E=64,a||(g=64)),n.push(t[p],t[f],t[g],t[E])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Jc(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):ym(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;const h=i<r.length?t[r.charAt(i)]:64;++i;const f=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||l==null||h==null||f==null)throw new vm;const g=s<<2|l>>4;if(n.push(g),h!==64){const E=l<<4&240|h>>2;if(n.push(E),f!==64){const C=h<<6&192|f;n.push(C)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class vm extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Em=function(r){const e=Jc(r);return Zc.encodeByteArray(e,!0)},hs=function(r){return Em(r).replace(/\./g,"")},wm=function(r){try{return Zc.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im=()=>Tm().__FIREBASE_DEFAULTS__,Am=()=>{if(typeof process>"u"||typeof Yl>"u")return;const r=Yl.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},Rm=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&wm(r[1]);return e&&JSON.parse(e)},oa=()=>{try{return _m()||Im()||Am()||Rm()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},bm=r=>oa()?.emulatorHosts?.[r],Sm=r=>{const e=bm(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},eh=()=>oa()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aa(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Pm(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a={iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...r};return[hs(JSON.stringify(t)),hs(JSON.stringify(a)),""].join(".")}const Wn={};function Vm(){const r={prod:[],emulator:[]};for(const e of Object.keys(Wn))Wn[e]?r.emulator.push(e):r.prod.push(e);return r}function Nm(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let Xl=!1;function xm(r,e){if(typeof window>"u"||typeof document>"u"||!aa(window.location.host)||Wn[r]===e||Wn[r]||Xl)return;Wn[r]=e;function t(g){return`__firebase__banner__${g}`}const n="__firebase__banner",s=Vm().prod.length>0;function a(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,E){g.setAttribute("width","24"),g.setAttribute("id",E),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{Xl=!0,a()},g}function p(g,E){g.setAttribute("id",E),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function f(){const g=Nm(n),E=t("text"),C=document.getElementById(E)||document.createElement("span"),M=t("learnmore"),V=document.getElementById(M)||document.createElement("a"),x=t("preprendIcon"),k=document.getElementById(x)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const F=g.element;l(F),p(V,M);const J=h();c(k,x),F.append(k,C,V,J),document.body.appendChild(F)}s?(C.innerText="Preview backend disconnected.",k.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(k.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lm(){const r=oa()?.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Mm(){return!Lm()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Om(){try{return typeof indexedDB=="object"}catch{return!1}}function Fm(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="FirebaseError";class yn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Um,Object.setPrototypeOf(this,yn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,th.prototype.create)}}class th{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?$m(s,n):"Error",l=`${this.serviceName}: ${a} (${i}).`;return new yn(i,l,n)}}function $m(r,e){return r.replace(Bm,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Bm=/\{\$([^}]+)}/g;function ds(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(Jl(s)&&Jl(a)){if(!ds(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function Jl(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rh(r){return r&&r._delegate?r._delegate:r}class ri{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Cm;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(n)return null;throw i}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Hm(e))try{this.getOrInitializeService({instanceIdentifier:br})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=br){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=br){return this.instances.has(e)}getOptions(e=br){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&a.resolve(i)}return i}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(n)??new Set;i.add(e),this.onInitCallbacks.set(n,i);const s=this.instances.get(n);return s&&e(s,n),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:zm(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=br){return this.component?this.component.multipleInstances?e:br:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zm(r){return r===br?void 0:r}function Hm(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qm{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jm(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ce;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(ce||(ce={}));const Wm={debug:ce.DEBUG,verbose:ce.VERBOSE,info:ce.INFO,warn:ce.WARN,error:ce.ERROR,silent:ce.SILENT},Gm=ce.INFO,Km={[ce.DEBUG]:"log",[ce.VERBOSE]:"log",[ce.INFO]:"info",[ce.WARN]:"warn",[ce.ERROR]:"error"},Qm=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=Km[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nh{constructor(e){this.name=e,this._logLevel=Gm,this._logHandler=Qm,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Wm[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ce.DEBUG,...e),this._logHandler(this,ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ce.VERBOSE,...e),this._logHandler(this,ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ce.INFO,...e),this._logHandler(this,ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ce.WARN,...e),this._logHandler(this,ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ce.ERROR,...e),this._logHandler(this,ce.ERROR,...e)}}const Ym=(r,e)=>e.some(t=>r instanceof t);let Zl,eu;function Xm(){return Zl||(Zl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jm(){return eu||(eu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ih=new WeakMap,Eo=new WeakMap,sh=new WeakMap,Zs=new WeakMap,la=new WeakMap;function Zm(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(ar(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&ih.set(t,r)}).catch(()=>{}),la.set(e,r),e}function eg(r){if(Eo.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});Eo.set(r,e)}let wo={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Eo.get(r);if(e==="objectStoreNames")return r.objectStoreNames||sh.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ar(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function tg(r){wo=r(wo)}function rg(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(eo(this),e,...t);return sh.set(n,e.sort?e.sort():[e]),ar(n)}:Jm().includes(r)?function(...e){return r.apply(eo(this),e),ar(ih.get(this))}:function(...e){return ar(r.apply(eo(this),e))}}function ng(r){return typeof r=="function"?rg(r):(r instanceof IDBTransaction&&eg(r),Ym(r,Xm())?new Proxy(r,wo):r)}function ar(r){if(r instanceof IDBRequest)return Zm(r);if(Zs.has(r))return Zs.get(r);const e=ng(r);return e!==r&&(Zs.set(r,e),la.set(e,r)),e}const eo=r=>la.get(r);function ig(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),l=ar(a);return n&&a.addEventListener("upgradeneeded",c=>{n(ar(a.result),c.oldVersion,c.newVersion,ar(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),l}const sg=["get","getKey","getAll","getAllKeys","count"],og=["put","add","delete","clear"],to=new Map;function tu(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(to.get(e))return to.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=og.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||sg.includes(t)))return;const s=async function(a,...l){const c=this.transaction(a,i?"readwrite":"readonly");let h=c.store;return n&&(h=h.index(l.shift())),(await Promise.all([h[t](...l),i&&c.done]))[0]};return to.set(e,s),s}tg(r=>({...r,get:(e,t,n)=>tu(e,t)||r.get(e,t,n),has:(e,t)=>!!tu(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ag{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lg(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function lg(r){return r.getComponent()?.type==="VERSION"}const To="@firebase/app",ru="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt=new nh("@firebase/app"),ug="@firebase/app-compat",cg="@firebase/analytics-compat",hg="@firebase/analytics",dg="@firebase/app-check-compat",fg="@firebase/app-check",pg="@firebase/auth",mg="@firebase/auth-compat",gg="@firebase/database",_g="@firebase/data-connect",yg="@firebase/database-compat",vg="@firebase/functions",Eg="@firebase/functions-compat",wg="@firebase/installations",Tg="@firebase/installations-compat",Ig="@firebase/messaging",Ag="@firebase/messaging-compat",Rg="@firebase/performance",bg="@firebase/performance-compat",Sg="@firebase/remote-config",Cg="@firebase/remote-config-compat",Pg="@firebase/storage",Dg="@firebase/storage-compat",Vg="@firebase/firestore",Ng="@firebase/ai",xg="@firebase/firestore-compat",kg="firebase",Lg="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io="[DEFAULT]",Mg={[To]:"fire-core",[ug]:"fire-core-compat",[hg]:"fire-analytics",[cg]:"fire-analytics-compat",[fg]:"fire-app-check",[dg]:"fire-app-check-compat",[pg]:"fire-auth",[mg]:"fire-auth-compat",[gg]:"fire-rtdb",[_g]:"fire-data-connect",[yg]:"fire-rtdb-compat",[vg]:"fire-fn",[Eg]:"fire-fn-compat",[wg]:"fire-iid",[Tg]:"fire-iid-compat",[Ig]:"fire-fcm",[Ag]:"fire-fcm-compat",[Rg]:"fire-perf",[bg]:"fire-perf-compat",[Sg]:"fire-rc",[Cg]:"fire-rc-compat",[Pg]:"fire-gcs",[Dg]:"fire-gcs-compat",[Vg]:"fire-fst",[xg]:"fire-fst-compat",[Ng]:"fire-vertex","fire-js":"fire-js",[kg]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fs=new Map,Og=new Map,Ao=new Map;function nu(r,e){try{r.container.addComponent(e)}catch(t){Gt.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ps(r){const e=r.name;if(Ao.has(e))return Gt.debug(`There were multiple attempts to register component ${e}.`),!1;Ao.set(e,r);for(const t of fs.values())nu(t,r);for(const t of Og.values())nu(t,r);return!0}function Fg(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Ug(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $g={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},lr=new th("app","Firebase",$g);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw lr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jg=Lg;function oh(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:Io,automaticDataCollectionEnabled:!0,...e},i=n.name;if(typeof i!="string"||!i)throw lr.create("bad-app-name",{appName:String(i)});if(t||(t=eh()),!t)throw lr.create("no-options");const s=fs.get(i);if(s){if(ds(t,s.options)&&ds(n,s.config))return s;throw lr.create("duplicate-app",{appName:i})}const a=new qm(i);for(const c of Ao.values())a.addComponent(c);const l=new Bg(t,n,a);return fs.set(i,l),l}function zg(r=Io){const e=fs.get(r);if(!e&&r===Io&&eh())return oh();if(!e)throw lr.create("no-app",{appName:r});return e}function nn(r,e,t){let n=Mg[r]??r;t&&(n+=`-${t}`);const i=n.match(/\s|\//),s=e.match(/\s|\//);if(i||s){const a=[`Unable to register library "${n}" with version "${e}":`];i&&a.push(`library name "${n}" contains illegal characters (whitespace or "/")`),i&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gt.warn(a.join(" "));return}ps(new ri(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="firebase-heartbeat-database",qg=1,ni="firebase-heartbeat-store";let ro=null;function ah(){return ro||(ro=ig(Hg,qg,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(ni)}catch(t){console.warn(t)}}}}).catch(r=>{throw lr.create("idb-open",{originalErrorMessage:r.message})})),ro}async function Wg(r){try{const t=(await ah()).transaction(ni),n=await t.objectStore(ni).get(lh(r));return await t.done,n}catch(e){if(e instanceof yn)Gt.warn(e.message);else{const t=lr.create("idb-get",{originalErrorMessage:e?.message});Gt.warn(t.message)}}}async function iu(r,e){try{const n=(await ah()).transaction(ni,"readwrite");await n.objectStore(ni).put(e,lh(r)),await n.done}catch(t){if(t instanceof yn)Gt.warn(t.message);else{const n=lr.create("idb-set",{originalErrorMessage:t?.message});Gt.warn(n.message)}}}function lh(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gg=1024,Kg=30;class Qg{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Xg(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=su();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(i=>i.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>Kg){const i=Jg(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Gt.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=su(),{heartbeatsToSend:t,unsentEntries:n}=Yg(this._heartbeatsCache.heartbeats),i=hs(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Gt.warn(e),""}}}function su(){return new Date().toISOString().substring(0,10)}function Yg(r,e=Gg){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),ou(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ou(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class Xg{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Om()?Fm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Wg(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return iu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return iu(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function ou(r){return hs(JSON.stringify({version:2,heartbeats:r})).length}function Jg(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(r){ps(new ri("platform-logger",e=>new ag(e),"PRIVATE")),ps(new ri("heartbeat",e=>new Qg(e),"PRIVATE")),nn(To,ru,r),nn(To,ru,"esm2020"),nn("fire-js","")}Zg("");var au=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ur,uh;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,_){function y(){}y.prototype=_.prototype,I.D=_.prototype,I.prototype=new y,I.prototype.constructor=I,I.C=function(T,A,R){for(var v=Array(arguments.length-2),de=2;de<arguments.length;de++)v[de-2]=arguments[de];return _.prototype[A].apply(T,v)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,y){y||(y=0);var T=Array(16);if(typeof _=="string")for(var A=0;16>A;++A)T[A]=_.charCodeAt(y++)|_.charCodeAt(y++)<<8|_.charCodeAt(y++)<<16|_.charCodeAt(y++)<<24;else for(A=0;16>A;++A)T[A]=_[y++]|_[y++]<<8|_[y++]<<16|_[y++]<<24;_=I.g[0],y=I.g[1],A=I.g[2];var R=I.g[3],v=_+(R^y&(A^R))+T[0]+3614090360&4294967295;_=y+(v<<7&4294967295|v>>>25),v=R+(A^_&(y^A))+T[1]+3905402710&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(y^R&(_^y))+T[2]+606105819&4294967295,A=R+(v<<17&4294967295|v>>>15),v=y+(_^A&(R^_))+T[3]+3250441966&4294967295,y=A+(v<<22&4294967295|v>>>10),v=_+(R^y&(A^R))+T[4]+4118548399&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(A^_&(y^A))+T[5]+1200080426&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(y^R&(_^y))+T[6]+2821735955&4294967295,A=R+(v<<17&4294967295|v>>>15),v=y+(_^A&(R^_))+T[7]+4249261313&4294967295,y=A+(v<<22&4294967295|v>>>10),v=_+(R^y&(A^R))+T[8]+1770035416&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(A^_&(y^A))+T[9]+2336552879&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(y^R&(_^y))+T[10]+4294925233&4294967295,A=R+(v<<17&4294967295|v>>>15),v=y+(_^A&(R^_))+T[11]+2304563134&4294967295,y=A+(v<<22&4294967295|v>>>10),v=_+(R^y&(A^R))+T[12]+1804603682&4294967295,_=y+(v<<7&4294967295|v>>>25),v=R+(A^_&(y^A))+T[13]+4254626195&4294967295,R=_+(v<<12&4294967295|v>>>20),v=A+(y^R&(_^y))+T[14]+2792965006&4294967295,A=R+(v<<17&4294967295|v>>>15),v=y+(_^A&(R^_))+T[15]+1236535329&4294967295,y=A+(v<<22&4294967295|v>>>10),v=_+(A^R&(y^A))+T[1]+4129170786&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^A&(_^y))+T[6]+3225465664&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^y&(R^_))+T[11]+643717713&4294967295,A=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(A^R))+T[0]+3921069994&4294967295,y=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(y^A))+T[5]+3593408605&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^A&(_^y))+T[10]+38016083&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^y&(R^_))+T[15]+3634488961&4294967295,A=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(A^R))+T[4]+3889429448&4294967295,y=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(y^A))+T[9]+568446438&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^A&(_^y))+T[14]+3275163606&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^y&(R^_))+T[3]+4107603335&4294967295,A=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(A^R))+T[8]+1163531501&4294967295,y=A+(v<<20&4294967295|v>>>12),v=_+(A^R&(y^A))+T[13]+2850285829&4294967295,_=y+(v<<5&4294967295|v>>>27),v=R+(y^A&(_^y))+T[2]+4243563512&4294967295,R=_+(v<<9&4294967295|v>>>23),v=A+(_^y&(R^_))+T[7]+1735328473&4294967295,A=R+(v<<14&4294967295|v>>>18),v=y+(R^_&(A^R))+T[12]+2368359562&4294967295,y=A+(v<<20&4294967295|v>>>12),v=_+(y^A^R)+T[5]+4294588738&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^A)+T[8]+2272392833&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^y)+T[11]+1839030562&4294967295,A=R+(v<<16&4294967295|v>>>16),v=y+(A^R^_)+T[14]+4259657740&4294967295,y=A+(v<<23&4294967295|v>>>9),v=_+(y^A^R)+T[1]+2763975236&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^A)+T[4]+1272893353&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^y)+T[7]+4139469664&4294967295,A=R+(v<<16&4294967295|v>>>16),v=y+(A^R^_)+T[10]+3200236656&4294967295,y=A+(v<<23&4294967295|v>>>9),v=_+(y^A^R)+T[13]+681279174&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^A)+T[0]+3936430074&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^y)+T[3]+3572445317&4294967295,A=R+(v<<16&4294967295|v>>>16),v=y+(A^R^_)+T[6]+76029189&4294967295,y=A+(v<<23&4294967295|v>>>9),v=_+(y^A^R)+T[9]+3654602809&4294967295,_=y+(v<<4&4294967295|v>>>28),v=R+(_^y^A)+T[12]+3873151461&4294967295,R=_+(v<<11&4294967295|v>>>21),v=A+(R^_^y)+T[15]+530742520&4294967295,A=R+(v<<16&4294967295|v>>>16),v=y+(A^R^_)+T[2]+3299628645&4294967295,y=A+(v<<23&4294967295|v>>>9),v=_+(A^(y|~R))+T[0]+4096336452&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~A))+T[7]+1126891415&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~y))+T[14]+2878612391&4294967295,A=R+(v<<15&4294967295|v>>>17),v=y+(R^(A|~_))+T[5]+4237533241&4294967295,y=A+(v<<21&4294967295|v>>>11),v=_+(A^(y|~R))+T[12]+1700485571&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~A))+T[3]+2399980690&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~y))+T[10]+4293915773&4294967295,A=R+(v<<15&4294967295|v>>>17),v=y+(R^(A|~_))+T[1]+2240044497&4294967295,y=A+(v<<21&4294967295|v>>>11),v=_+(A^(y|~R))+T[8]+1873313359&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~A))+T[15]+4264355552&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~y))+T[6]+2734768916&4294967295,A=R+(v<<15&4294967295|v>>>17),v=y+(R^(A|~_))+T[13]+1309151649&4294967295,y=A+(v<<21&4294967295|v>>>11),v=_+(A^(y|~R))+T[4]+4149444226&4294967295,_=y+(v<<6&4294967295|v>>>26),v=R+(y^(_|~A))+T[11]+3174756917&4294967295,R=_+(v<<10&4294967295|v>>>22),v=A+(_^(R|~y))+T[2]+718787259&4294967295,A=R+(v<<15&4294967295|v>>>17),v=y+(R^(A|~_))+T[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(A+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+A&4294967295,I.g[3]=I.g[3]+R&4294967295}n.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var y=_-this.blockSize,T=this.B,A=this.h,R=0;R<_;){if(A==0)for(;R<=y;)i(this,I,R),R+=this.blockSize;if(typeof I=="string"){for(;R<_;)if(T[A++]=I.charCodeAt(R++),A==this.blockSize){i(this,T),A=0;break}}else for(;R<_;)if(T[A++]=I[R++],A==this.blockSize){i(this,T),A=0;break}}this.h=A,this.o+=_},n.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var y=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=y&255,y/=256;for(this.u(I),I=Array(16),_=y=0;4>_;++_)for(var T=0;32>T;T+=8)I[y++]=this.g[_]>>>T&255;return I};function s(I,_){var y=l;return Object.prototype.hasOwnProperty.call(y,I)?y[I]:y[I]=_(I)}function a(I,_){this.h=_;for(var y=[],T=!0,A=I.length-1;0<=A;A--){var R=I[A]|0;T&&R==_||(y[A]=R,T=!1)}this.g=y}var l={};function c(I){return-128<=I&&128>I?s(I,function(_){return new a([_|0],0>_?-1:0)}):new a([I|0],0>I?-1:0)}function h(I){if(isNaN(I)||!isFinite(I))return f;if(0>I)return V(h(-I));for(var _=[],y=1,T=0;I>=y;T++)_[T]=I/y|0,y*=4294967296;return new a(_,0)}function p(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return V(p(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var y=h(Math.pow(_,8)),T=f,A=0;A<I.length;A+=8){var R=Math.min(8,I.length-A),v=parseInt(I.substring(A,A+R),_);8>R?(R=h(Math.pow(_,R)),T=T.j(R).add(h(v))):(T=T.j(y),T=T.add(h(v)))}return T}var f=c(0),g=c(1),E=c(16777216);r=a.prototype,r.m=function(){if(M(this))return-V(this).m();for(var I=0,_=1,y=0;y<this.g.length;y++){var T=this.i(y);I+=(0<=T?T:4294967296+T)*_,_*=4294967296}return I},r.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C(this))return"0";if(M(this))return"-"+V(this).toString(I);for(var _=h(Math.pow(I,6)),y=this,T="";;){var A=J(y,_).g;y=x(y,A.j(_));var R=((0<y.g.length?y.g[0]:y.h)>>>0).toString(I);if(y=A,C(y))return R+T;for(;6>R.length;)R="0"+R;T=R+T}},r.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function C(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function M(I){return I.h==-1}r.l=function(I){return I=x(this,I),M(I)?-1:C(I)?0:1};function V(I){for(var _=I.g.length,y=[],T=0;T<_;T++)y[T]=~I.g[T];return new a(y,~I.h).add(g)}r.abs=function(){return M(this)?V(this):this},r.add=function(I){for(var _=Math.max(this.g.length,I.g.length),y=[],T=0,A=0;A<=_;A++){var R=T+(this.i(A)&65535)+(I.i(A)&65535),v=(R>>>16)+(this.i(A)>>>16)+(I.i(A)>>>16);T=v>>>16,R&=65535,v&=65535,y[A]=v<<16|R}return new a(y,y[y.length-1]&-2147483648?-1:0)};function x(I,_){return I.add(V(_))}r.j=function(I){if(C(this)||C(I))return f;if(M(this))return M(I)?V(this).j(V(I)):V(V(this).j(I));if(M(I))return V(this.j(V(I)));if(0>this.l(E)&&0>I.l(E))return h(this.m()*I.m());for(var _=this.g.length+I.g.length,y=[],T=0;T<2*_;T++)y[T]=0;for(T=0;T<this.g.length;T++)for(var A=0;A<I.g.length;A++){var R=this.i(T)>>>16,v=this.i(T)&65535,de=I.i(A)>>>16,qe=I.i(A)&65535;y[2*T+2*A]+=v*qe,k(y,2*T+2*A),y[2*T+2*A+1]+=R*qe,k(y,2*T+2*A+1),y[2*T+2*A+1]+=v*de,k(y,2*T+2*A+1),y[2*T+2*A+2]+=R*de,k(y,2*T+2*A+2)}for(T=0;T<_;T++)y[T]=y[2*T+1]<<16|y[2*T];for(T=_;T<2*_;T++)y[T]=0;return new a(y,0)};function k(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function F(I,_){this.g=I,this.h=_}function J(I,_){if(C(_))throw Error("division by zero");if(C(I))return new F(f,f);if(M(I))return _=J(V(I),_),new F(V(_.g),V(_.h));if(M(_))return _=J(I,V(_)),new F(V(_.g),_.h);if(30<I.g.length){if(M(I)||M(_))throw Error("slowDivide_ only works with positive integers.");for(var y=g,T=_;0>=T.l(I);)y=Q(y),T=Q(T);var A=P(y,1),R=P(T,1);for(T=P(T,2),y=P(y,2);!C(T);){var v=R.add(T);0>=v.l(I)&&(A=A.add(y),R=v),T=P(T,1),y=P(y,1)}return _=x(I,A.j(_)),new F(A,_)}for(A=f;0<=I.l(_);){for(y=Math.max(1,Math.floor(I.m()/_.m())),T=Math.ceil(Math.log(y)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),R=h(y),v=R.j(_);M(v)||0<v.l(I);)y-=T,R=h(y),v=R.j(_);C(R)&&(R=g),A=A.add(R),I=x(I,v)}return new F(A,I)}r.A=function(I){return J(this,I).h},r.and=function(I){for(var _=Math.max(this.g.length,I.g.length),y=[],T=0;T<_;T++)y[T]=this.i(T)&I.i(T);return new a(y,this.h&I.h)},r.or=function(I){for(var _=Math.max(this.g.length,I.g.length),y=[],T=0;T<_;T++)y[T]=this.i(T)|I.i(T);return new a(y,this.h|I.h)},r.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),y=[],T=0;T<_;T++)y[T]=this.i(T)^I.i(T);return new a(y,this.h^I.h)};function Q(I){for(var _=I.g.length+1,y=[],T=0;T<_;T++)y[T]=I.i(T)<<1|I.i(T-1)>>>31;return new a(y,I.h)}function P(I,_){var y=_>>5;_%=32;for(var T=I.g.length-y,A=[],R=0;R<T;R++)A[R]=0<_?I.i(R+y)>>>_|I.i(R+y+1)<<32-_:I.i(R+y);return new a(A,I.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,uh=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=p,ur=a}).apply(typeof au<"u"?au:typeof self<"u"?self:typeof window<"u"?window:{});var zi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ch,jn,hh,es,Ro,dh,fh,ph;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,d){return o==Array.prototype||o==Object.prototype||(o[u]=d.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof zi=="object"&&zi];for(var u=0;u<o.length;++u){var d=o[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var n=t(this);function i(o,u){if(u)e:{var d=n;o=o.split(".");for(var m=0;m<o.length-1;m++){var S=o[m];if(!(S in d))break e;d=d[S]}o=o[o.length-1],m=d[o],u=u(m),u!=m&&u!=null&&e(d,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var d=0,m=!1,S={next:function(){if(!m&&d<o.length){var N=d++;return{value:u(N,o[N]),done:!1}}return m=!0,{done:!0,value:void 0}}};return S[Symbol.iterator]=function(){return S},S}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,d){return d})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function c(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function h(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,d){return o.call.apply(o.bind,arguments)}function f(o,u,d){if(!o)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var S=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(S,m),o.apply(u,S)}}return function(){return o.apply(u,arguments)}}function g(o,u,d){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:f,g.apply(null,arguments)}function E(o,u){var d=Array.prototype.slice.call(arguments,1);return function(){var m=d.slice();return m.push.apply(m,arguments),o.apply(this,m)}}function C(o,u){function d(){}d.prototype=u.prototype,o.aa=u.prototype,o.prototype=new d,o.prototype.constructor=o,o.Qb=function(m,S,N){for(var $=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)$[Ee-2]=arguments[Ee];return u.prototype[S].apply(m,$)}}function M(o){const u=o.length;if(0<u){const d=Array(u);for(let m=0;m<u;m++)d[m]=o[m];return d}return[]}function V(o,u){for(let d=1;d<arguments.length;d++){const m=arguments[d];if(c(m)){const S=o.length||0,N=m.length||0;o.length=S+N;for(let $=0;$<N;$++)o[S+$]=m[$]}else o.push(m)}}class x{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function k(o){return/^[\s\xa0]*$/.test(o)}function F(){var o=l.navigator;return o&&(o=o.userAgent)?o:""}function J(o){return J[" "](o),o}J[" "]=function(){};var Q=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function P(o,u,d){for(const m in o)u.call(d,o[m],m,o)}function I(o,u){for(const d in o)u.call(void 0,o[d],d,o)}function _(o){const u={};for(const d in o)u[d]=o[d];return u}const y="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(o,u){let d,m;for(let S=1;S<arguments.length;S++){m=arguments[S];for(d in m)o[d]=m[d];for(let N=0;N<y.length;N++)d=y[N],Object.prototype.hasOwnProperty.call(m,d)&&(o[d]=m[d])}}function A(o){var u=1;o=o.split(":");const d=[];for(;0<u&&o.length;)d.push(o.shift()),u--;return o.length&&d.push(o.join(":")),d}function R(o){l.setTimeout(()=>{throw o},0)}function v(){var o=nt;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class de{constructor(){this.h=this.g=null}add(u,d){const m=qe.get();m.set(u,d),this.h?this.h.next=m:this.g=m,this.h=m}}var qe=new x(()=>new me,o=>o.reset());class me{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let We,Me=!1,nt=new de,Ke=()=>{const o=l.Promise.resolve(void 0);We=()=>{o.then(at)}};var at=()=>{for(var o;o=v();){try{o.h.call(o.g)}catch(d){R(d)}var u=qe;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}Me=!1};function je(){this.s=this.s,this.C=this.C}je.prototype.s=!1,je.prototype.ma=function(){this.s||(this.s=!0,this.N())},je.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var Ut=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{const d=()=>{};l.addEventListener("test",d,u),l.removeEventListener("test",d,u)}catch{}return o})();function At(o,u){if(ve.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var d=this.type=o.type,m=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(Q){e:{try{J(u.nodeName);var S=!0;break e}catch{}S=!1}S||(u=null)}}else d=="mouseover"?u=o.fromElement:d=="mouseout"&&(u=o.toElement);this.relatedTarget=u,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Er[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&At.aa.h.call(this)}}C(At,ve);var Er={2:"touch",3:"pen",4:"mouse"};At.prototype.h=function(){At.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Or="closure_listenable_"+(1e6*Math.random()|0),Fs=0;function Us(o,u,d,m,S){this.listener=o,this.proxy=null,this.src=u,this.type=d,this.capture=!!m,this.ha=S,this.key=++Fs,this.da=this.fa=!1}function Ne(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function yt(o){this.src=o,this.g={},this.h=0}yt.prototype.add=function(o,u,d,m,S){var N=o.toString();o=this.g[N],o||(o=this.g[N]=[],this.h++);var $=Tn(o,u,m,S);return-1<$?(u=o[$],d||(u.fa=!1)):(u=new Us(u,this.src,N,!!m,S),u.fa=d,o.push(u)),u};function Fr(o,u){var d=u.type;if(d in o.g){var m=o.g[d],S=Array.prototype.indexOf.call(m,u,void 0),N;(N=0<=S)&&Array.prototype.splice.call(m,S,1),N&&(Ne(u),o.g[d].length==0&&(delete o.g[d],o.h--))}}function Tn(o,u,d,m){for(var S=0;S<o.length;++S){var N=o[S];if(!N.da&&N.listener==u&&N.capture==!!d&&N.ha==m)return S}return-1}var vt="closure_lm_"+(1e6*Math.random()|0),In={};function vi(o,u,d,m,S){if(Array.isArray(u)){for(var N=0;N<u.length;N++)vi(o,u[N],d,m,S);return null}return d=$r(d),o&&o[Or]?o.K(u,d,h(m)?!!m.capture:!1,S):Ei(o,u,d,!1,m,S)}function Ei(o,u,d,m,S,N){if(!u)throw Error("Invalid event type");var $=h(S)?!!S.capture:!!S,Ee=Bt(o);if(Ee||(o[vt]=Ee=new yt(o)),d=Ee.add(u,d,m,$,N),d.proxy)return d;if(m=$s(),d.proxy=m,m.src=o,m.listener=d,o.addEventListener)Ut||(S=$),S===void 0&&(S=!1),o.addEventListener(u.toString(),m,S);else if(o.attachEvent)o.attachEvent(Ti(u.toString()),m);else if(o.addListener&&o.removeListener)o.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return d}function $s(){function o(d){return u.call(o.src,o.listener,d)}const u=$t;return o}function wi(o,u,d,m,S){if(Array.isArray(u))for(var N=0;N<u.length;N++)wi(o,u[N],d,m,S);else m=h(m)?!!m.capture:!!m,d=$r(d),o&&o[Or]?(o=o.i,u=String(u).toString(),u in o.g&&(N=o.g[u],d=Tn(N,d,m,S),-1<d&&(Ne(N[d]),Array.prototype.splice.call(N,d,1),N.length==0&&(delete o.g[u],o.h--)))):o&&(o=Bt(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Tn(u,d,m,S)),(d=-1<o?u[o]:null)&&An(d))}function An(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Or])Fr(u.i,o);else{var d=o.type,m=o.proxy;u.removeEventListener?u.removeEventListener(d,m,o.capture):u.detachEvent?u.detachEvent(Ti(d),m):u.addListener&&u.removeListener&&u.removeListener(m),(d=Bt(u))?(Fr(d,o),d.h==0&&(d.src=null,u[vt]=null)):Ne(o)}}}function Ti(o){return o in In?In[o]:In[o]="on"+o}function $t(o,u){if(o.da)o=!0;else{u=new At(u,this);var d=o.listener,m=o.ha||o.src;o.fa&&An(o),o=d.call(m,u)}return o}function Bt(o){return o=o[vt],o instanceof yt?o:null}var Ur="__closure_events_fn_"+(1e9*Math.random()>>>0);function $r(o){return typeof o=="function"?o:(o[Ur]||(o[Ur]=function(u){return o.handleEvent(u)}),o[Ur])}function Te(){je.call(this),this.i=new yt(this),this.M=this,this.F=null}C(Te,je),Te.prototype[Or]=!0,Te.prototype.removeEventListener=function(o,u,d,m){wi(this,o,u,d,m)};function Ie(o,u){var d,m=o.F;if(m)for(d=[];m;m=m.F)d.push(m);if(o=o.M,m=u.type||u,typeof u=="string")u=new ve(u,o);else if(u instanceof ve)u.target=u.target||o;else{var S=u;u=new ve(m,o),T(u,S)}if(S=!0,d)for(var N=d.length-1;0<=N;N--){var $=u.g=d[N];S=wr($,m,!0,u)&&S}if($=u.g=o,S=wr($,m,!0,u)&&S,S=wr($,m,!1,u)&&S,d)for(N=0;N<d.length;N++)$=u.g=d[N],S=wr($,m,!1,u)&&S}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var d=o.g[u],m=0;m<d.length;m++)Ne(d[m]);delete o.g[u],o.h--}}this.F=null},Te.prototype.K=function(o,u,d,m){return this.i.add(String(o),u,!1,d,m)},Te.prototype.L=function(o,u,d,m){return this.i.add(String(o),u,!0,d,m)};function wr(o,u,d,m){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var S=!0,N=0;N<u.length;++N){var $=u[N];if($&&!$.da&&$.capture==d){var Ee=$.listener,Qe=$.ha||$.src;$.fa&&Fr(o.i,$),S=Ee.call(Qe,m)!==!1&&S}}return S&&!m.defaultPrevented}function Br(o,u,d){if(typeof o=="function")d&&(o=g(o,d));else if(o&&typeof o.handleEvent=="function")o=g(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:l.setTimeout(o,u||0)}function Ii(o){o.g=Br(()=>{o.g=null,o.i&&(o.i=!1,Ii(o))},o.l);const u=o.h;o.h=null,o.m.apply(null,u)}class Rt extends je{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Ii(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Yt(o){je.call(this),this.h=o,this.g={}}C(Yt,je);var Rn=[];function bn(o){P(o.g,function(u,d){this.g.hasOwnProperty(d)&&An(u)},o),o.g={}}Yt.prototype.N=function(){Yt.aa.N.call(this),bn(this)},Yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Sn=l.JSON.stringify,Ai=l.JSON.parse,jr=class{stringify(o){return l.JSON.stringify(o,void 0)}parse(o){return l.JSON.parse(o,void 0)}};function zr(){}zr.prototype.h=null;function Hr(o){return o.h||(o.h=o.i())}function Ri(){}var Xt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Cn(){ve.call(this,"d")}C(Cn,ve);function qr(){ve.call(this,"c")}C(qr,ve);var ft={},Tr=null;function Wr(){return Tr=Tr||new Te}ft.La="serverreachability";function bi(o){ve.call(this,ft.La,o)}C(bi,ve);function w(o){const u=Wr();Ie(u,new bi(u))}ft.STAT_EVENT="statevent";function b(o,u){ve.call(this,ft.STAT_EVENT,o),this.stat=u}C(b,ve);function D(o){const u=Wr();Ie(u,new b(u,o))}ft.Ma="timingevent";function O(o,u){ve.call(this,ft.Ma,o),this.size=u}C(O,ve);function U(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){o()},u)}function z(){this.g=!0}z.prototype.xa=function(){this.g=!1};function G(o,u,d,m,S,N){o.info(function(){if(o.g)if(N)for(var $="",Ee=N.split("&"),Qe=0;Qe<Ee.length;Qe++){var pe=Ee[Qe].split("=");if(1<pe.length){var Je=pe[0];pe=pe[1];var Ze=Je.split("_");$=2<=Ze.length&&Ze[1]=="type"?$+(Je+"="+pe+"&"):$+(Je+"=redacted&")}}else $=null;else $=N;return"XMLHTTP REQ ("+m+") [attempt "+S+"]: "+u+`
`+d+`
`+$})}function H(o,u,d,m,S,N,$){o.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+S+"]: "+u+`
`+d+`
`+N+" "+$})}function q(o,u,d,m){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+K(o,d)+(m?" "+m:"")})}function Z(o,u){o.info(function(){return"TIMEOUT: "+u})}z.prototype.info=function(){};function K(o,u){if(!o.g)return u;if(!u)return null;try{var d=JSON.parse(u);if(d){for(o=0;o<d.length;o++)if(Array.isArray(d[o])){var m=d[o];if(!(2>m.length)){var S=m[1];if(Array.isArray(S)&&!(1>S.length)){var N=S[0];if(N!="noop"&&N!="stop"&&N!="close")for(var $=1;$<S.length;$++)S[$]=""}}}}return Sn(d)}catch{return u}}var W={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ae={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ge;function Se(){}C(Se,zr),Se.prototype.g=function(){return new XMLHttpRequest},Se.prototype.i=function(){return{}},ge=new Se;function Re(o,u,d,m){this.j=o,this.i=u,this.l=d,this.R=m||1,this.U=new Yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new we}function we(){this.i=null,this.g="",this.h=!1}var _e={},Et={};function jt(o,u,d){o.L=1,o.v=Pi(zt(u)),o.m=d,o.P=!0,wt(o,null)}function wt(o,u){o.F=Date.now(),bt(o),o.A=zt(o.v);var d=o.A,m=o.R;Array.isArray(m)||(m=[String(m)]),$a(d.i,"t",m),o.C=0,d=o.j.J,o.h=new we,o.g=il(o.j,d?u:null,!o.m),0<o.O&&(o.M=new Rt(g(o.Y,o,o.g),o.O)),u=o.U,d=o.g,m=o.ca;var S="readystatechange";Array.isArray(S)||(S&&(Rn[0]=S.toString()),S=Rn);for(var N=0;N<S.length;N++){var $=vi(d,S[N],m||u.handleEvent,!1,u.h||u);if(!$)break;u.g[$.key]=$}u=o.H?_(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),w(),G(o.i,o.u,o.A,o.l,o.R,o.m)}Re.prototype.ca=function(o){o=o.target;const u=this.M;u&&Ht(o)==3?u.j():this.Y(o)},Re.prototype.Y=function(o){try{if(o==this.g)e:{const Ze=Ht(this.g);var u=this.g.Ba();const Yr=this.g.Z();if(!(3>Ze)&&(Ze!=3||this.g&&(this.h.h||this.g.oa()||Ga(this.g)))){this.J||Ze!=4||u==7||(u==8||0>=Yr?w(3):w(2)),Jt(this);var d=this.g.Z();this.X=d;t:if(ct(this)){var m=Ga(this.g);o="";var S=m.length,N=Ht(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){se(this),Ct(this);var $="";break t}this.h.i=new l.TextDecoder}for(u=0;u<S;u++)this.h.h=!0,o+=this.h.i.decode(m[u],{stream:!(N&&u==S-1)});m.length=0,this.h.g+=o,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=d==200,H(this.i,this.u,this.A,this.l,this.R,Ze,d),this.o){if(this.T&&!this.K){t:{if(this.g){var Ee,Qe=this.g;if((Ee=Qe.g?Qe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!k(Ee)){var pe=Ee;break t}}pe=null}if(d=pe)q(this.i,this.l,d,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Oe(this,d);else{this.o=!1,this.s=3,D(12),se(this),Ct(this);break e}}if(this.P){d=!0;let Tt;for(;!this.J&&this.C<$.length;)if(Tt=Pn(this,$),Tt==Et){Ze==4&&(this.s=4,D(14),d=!1),q(this.i,this.l,null,"[Incomplete Response]");break}else if(Tt==_e){this.s=4,D(15),q(this.i,this.l,$,"[Invalid Chunk]"),d=!1;break}else q(this.i,this.l,Tt,null),Oe(this,Tt);if(ct(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ze!=4||$.length!=0||this.h.h||(this.s=1,D(16),d=!1),this.o=this.o&&d,!d)q(this.i,this.l,$,"[Invalid Chunked Response]"),se(this),Ct(this);else if(0<$.length&&!this.W){this.W=!0;var Je=this.j;Je.g==this&&Je.ba&&!Je.M&&(Je.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Hs(Je),Je.M=!0,D(11))}}else q(this.i,this.l,$,null),Oe(this,$);Ze==4&&se(this),this.o&&!this.J&&(Ze==4?el(this.j,this):(this.o=!1,bt(this)))}else Vd(this.g),d==400&&0<$.indexOf("Unknown SID")?(this.s=3,D(12)):(this.s=0,D(13)),se(this),Ct(this)}}}catch{}finally{}};function ct(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Pn(o,u){var d=o.C,m=u.indexOf(`
`,d);return m==-1?Et:(d=Number(u.substring(d,m)),isNaN(d)?_e:(m+=1,m+d>u.length?Et:(u=u.slice(m,m+d),o.C=m+d,u)))}Re.prototype.cancel=function(){this.J=!0,se(this)};function bt(o){o.S=Date.now()+o.I,St(o,o.I)}function St(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=U(g(o.ba,o),u)}function Jt(o){o.B&&(l.clearTimeout(o.B),o.B=null)}Re.prototype.ba=function(){this.B=null;const o=Date.now();0<=o-this.S?(Z(this.i,this.A),this.L!=2&&(w(),D(17)),se(this),this.s=2,Ct(this)):St(this,this.S-o)};function Ct(o){o.j.G==0||o.J||el(o.j,o)}function se(o){Jt(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,bn(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function Oe(o,u){try{var d=o.j;if(d.G!=0&&(d.g==o||Gr(d.h,o))){if(!o.K&&Gr(d.h,o)&&d.G==3){try{var m=d.Da.g.parse(u)}catch{m=null}if(Array.isArray(m)&&m.length==3){var S=m;if(S[0]==0){e:if(!d.u){if(d.g)if(d.g.F+3e3<o.F)Li(d),xi(d);else break e;zs(d),D(18)}}else d.za=S[1],0<d.za-d.T&&37500>S[2]&&d.F&&d.v==0&&!d.C&&(d.C=U(g(d.Za,d),6e3));if(1>=Ir(d.h)&&d.ca){try{d.ca()}catch{}d.ca=void 0}}else Rr(d,11)}else if((o.K||d.g==o)&&Li(d),!k(u))for(S=d.Da.g.parse(u),u=0;u<S.length;u++){let pe=S[u];if(d.T=pe[0],pe=pe[1],d.G==2)if(pe[0]=="c"){d.K=pe[1],d.ia=pe[2];const Je=pe[3];Je!=null&&(d.la=Je,d.j.info("VER="+d.la));const Ze=pe[4];Ze!=null&&(d.Aa=Ze,d.j.info("SVER="+d.Aa));const Yr=pe[5];Yr!=null&&typeof Yr=="number"&&0<Yr&&(m=1.5*Yr,d.L=m,d.j.info("backChannelRequestTimeoutMs_="+m)),m=d;const Tt=o.g;if(Tt){const Oi=Tt.g?Tt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oi){var N=m.h;N.g||Oi.indexOf("spdy")==-1&&Oi.indexOf("quic")==-1&&Oi.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(Dn(N,N.h),N.h=null))}if(m.D){const qs=Tt.g?Tt.g.getResponseHeader("X-HTTP-Session-Id"):null;qs&&(m.ya=qs,Ae(m.I,m.D,qs))}}d.G=3,d.l&&d.l.ua(),d.ba&&(d.R=Date.now()-o.F,d.j.info("Handshake RTT: "+d.R+"ms")),m=d;var $=o;if(m.qa=nl(m,m.J?m.ia:null,m.W),$.K){Na(m.h,$);var Ee=$,Qe=m.L;Qe&&(Ee.I=Qe),Ee.B&&(Jt(Ee),bt(Ee)),m.g=$}else Ja(m);0<d.i.length&&ki(d)}else pe[0]!="stop"&&pe[0]!="close"||Rr(d,7);else d.G==3&&(pe[0]=="stop"||pe[0]=="close"?pe[0]=="stop"?Rr(d,7):js(d):pe[0]!="noop"&&d.l&&d.l.ta(pe),d.v=0)}}w(4)}catch{}}var Zt=class{constructor(o,u){this.g=o,this.map=u}};function Pt(o){this.l=o||10,l.PerformanceNavigationTiming?(o=l.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function De(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ir(o){return o.h?1:o.g?o.g.size:0}function Gr(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function Dn(o,u){o.g?o.g.add(u):o.h=u}function Na(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Pt.prototype.cancel=function(){if(this.i=xa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const o of this.g.values())o.cancel();this.g.clear()}};function xa(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(const d of o.g.values())u=u.concat(d.D);return u}return M(o.i)}function gd(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var u=[],d=o.length,m=0;m<d;m++)u.push(o[m]);return u}u=[],d=0;for(m in o)u[d++]=o[m];return u}function _d(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var u=[];o=o.length;for(var d=0;d<o;d++)u.push(d);return u}u=[],d=0;for(const m in o)u[d++]=m;return u}}}function ka(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var d=_d(o),m=gd(o),S=m.length,N=0;N<S;N++)u.call(void 0,m[N],d&&d[N],o)}var La=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yd(o,u){if(o){o=o.split("&");for(var d=0;d<o.length;d++){var m=o[d].indexOf("="),S=null;if(0<=m){var N=o[d].substring(0,m);S=o[d].substring(m+1)}else N=o[d];u(N,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Ar(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Ar){this.h=o.h,Si(this,o.j),this.o=o.o,this.g=o.g,Ci(this,o.s),this.l=o.l;var u=o.i,d=new xn;d.i=u.i,u.g&&(d.g=new Map(u.g),d.h=u.h),Ma(this,d),this.m=o.m}else o&&(u=String(o).match(La))?(this.h=!1,Si(this,u[1]||"",!0),this.o=Vn(u[2]||""),this.g=Vn(u[3]||"",!0),Ci(this,u[4]),this.l=Vn(u[5]||"",!0),Ma(this,u[6]||"",!0),this.m=Vn(u[7]||"")):(this.h=!1,this.i=new xn(null,this.h))}Ar.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Nn(u,Oa,!0),":");var d=this.g;return(d||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Nn(u,Oa,!0),"@"),o.push(encodeURIComponent(String(d)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.s,d!=null&&o.push(":",String(d))),(d=this.l)&&(this.g&&d.charAt(0)!="/"&&o.push("/"),o.push(Nn(d,d.charAt(0)=="/"?wd:Ed,!0))),(d=this.i.toString())&&o.push("?",d),(d=this.m)&&o.push("#",Nn(d,Id)),o.join("")};function zt(o){return new Ar(o)}function Si(o,u,d){o.j=d?Vn(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function Ci(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function Ma(o,u,d){u instanceof xn?(o.i=u,Ad(o.i,o.h)):(d||(u=Nn(u,Td)),o.i=new xn(u,o.h))}function Ae(o,u,d){o.i.set(u,d)}function Pi(o){return Ae(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Vn(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Nn(o,u,d){return typeof o=="string"?(o=encodeURI(o).replace(u,vd),d&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function vd(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Oa=/[#\/\?@]/g,Ed=/[#\?:]/g,wd=/[#\?]/g,Td=/[#\?@]/g,Id=/#/g;function xn(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function er(o){o.g||(o.g=new Map,o.h=0,o.i&&yd(o.i,function(u,d){o.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}r=xn.prototype,r.add=function(o,u){er(this),this.i=null,o=Kr(this,o);var d=this.g.get(o);return d||this.g.set(o,d=[]),d.push(u),this.h+=1,this};function Fa(o,u){er(o),u=Kr(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Ua(o,u){return er(o),u=Kr(o,u),o.g.has(u)}r.forEach=function(o,u){er(this),this.g.forEach(function(d,m){d.forEach(function(S){o.call(u,S,m,this)},this)},this)},r.na=function(){er(this);const o=Array.from(this.g.values()),u=Array.from(this.g.keys()),d=[];for(let m=0;m<u.length;m++){const S=o[m];for(let N=0;N<S.length;N++)d.push(u[m])}return d},r.V=function(o){er(this);let u=[];if(typeof o=="string")Ua(this,o)&&(u=u.concat(this.g.get(Kr(this,o))));else{o=Array.from(this.g.values());for(let d=0;d<o.length;d++)u=u.concat(o[d])}return u},r.set=function(o,u){return er(this),this.i=null,o=Kr(this,o),Ua(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},r.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function $a(o,u,d){Fa(o,u),0<d.length&&(o.i=null,o.g.set(Kr(o,u),M(d)),o.h+=d.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const o=[],u=Array.from(this.g.keys());for(var d=0;d<u.length;d++){var m=u[d];const N=encodeURIComponent(String(m)),$=this.V(m);for(m=0;m<$.length;m++){var S=N;$[m]!==""&&(S+="="+encodeURIComponent(String($[m]))),o.push(S)}}return this.i=o.join("&")};function Kr(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function Ad(o,u){u&&!o.j&&(er(o),o.i=null,o.g.forEach(function(d,m){var S=m.toLowerCase();m!=S&&(Fa(this,m),$a(this,S,d))},o)),o.j=u}function Rd(o,u){const d=new z;if(l.Image){const m=new Image;m.onload=E(tr,d,"TestLoadImage: loaded",!0,u,m),m.onerror=E(tr,d,"TestLoadImage: error",!1,u,m),m.onabort=E(tr,d,"TestLoadImage: abort",!1,u,m),m.ontimeout=E(tr,d,"TestLoadImage: timeout",!1,u,m),l.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=o}else u(!1)}function bd(o,u){const d=new z,m=new AbortController,S=setTimeout(()=>{m.abort(),tr(d,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:m.signal}).then(N=>{clearTimeout(S),N.ok?tr(d,"TestPingServer: ok",!0,u):tr(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(S),tr(d,"TestPingServer: error",!1,u)})}function tr(o,u,d,m,S){try{S&&(S.onload=null,S.onerror=null,S.onabort=null,S.ontimeout=null),m(d)}catch{}}function Sd(){this.g=new jr}function Cd(o,u,d){const m=d||"";try{ka(o,function(S,N){let $=S;h(S)&&($=Sn(S)),u.push(m+N+"="+encodeURIComponent($))})}catch(S){throw u.push(m+"type="+encodeURIComponent("_badmap")),S}}function Di(o){this.l=o.Ub||null,this.j=o.eb||!1}C(Di,zr),Di.prototype.g=function(){return new Vi(this.l,this.j)},Di.prototype.i=(function(o){return function(){return o}})({});function Vi(o,u){Te.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}C(Vi,Te),r=Vi.prototype,r.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,Ln(this)},r.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||l).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,kn(this)),this.readyState=0},r.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,Ln(this)),this.g&&(this.readyState=3,Ln(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ba(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ba(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}r.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?kn(this):Ln(this),this.readyState==3&&Ba(this)}},r.Ra=function(o){this.g&&(this.response=this.responseText=o,kn(this))},r.Qa=function(o){this.g&&(this.response=o,kn(this))},r.ga=function(){this.g&&kn(this)};function kn(o){o.readyState=4,o.l=null,o.j=null,o.v=null,Ln(o)}r.setRequestHeader=function(o,u){this.u.append(o,u)},r.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const o=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,o.push(d[0]+": "+d[1]),d=u.next();return o.join(`\r
`)};function Ln(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Vi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function ja(o){let u="";return P(o,function(d,m){u+=m,u+=":",u+=d,u+=`\r
`}),u}function Bs(o,u,d){e:{for(m in d){var m=!1;break e}m=!0}m||(d=ja(d),typeof o=="string"?d!=null&&encodeURIComponent(String(d)):Ae(o,u,d))}function Ve(o){Te.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}C(Ve,Te);var Pd=/^https?$/i,Dd=["POST","PUT"];r=Ve.prototype,r.Ha=function(o){this.J=o},r.ea=function(o,u,d,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ge.g(),this.v=this.o?Hr(this.o):Hr(ge),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(N){za(this,N);return}if(o=d||"",d=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var S in m)d.set(S,m[S]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(const N of m.keys())d.set(N,m.get(N));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(d.keys()).find(N=>N.toLowerCase()=="content-type"),S=l.FormData&&o instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Dd,u,void 0))||m||S||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[N,$]of d)this.g.setRequestHeader(N,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wa(this),this.u=!0,this.g.send(o),this.u=!1}catch(N){za(this,N)}};function za(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,Ha(o),Ni(o)}function Ha(o){o.A||(o.A=!0,Ie(o,"complete"),Ie(o,"error"))}r.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ie(this,"complete"),Ie(this,"abort"),Ni(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ni(this,!0)),Ve.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?qa(this):this.bb())},r.bb=function(){qa(this)};function qa(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Ht(o)!=4||o.Z()!=2)){if(o.u&&Ht(o)==4)Br(o.Ea,0,o);else if(Ie(o,"readystatechange"),Ht(o)==4){o.h=!1;try{const $=o.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var m;if(m=$===0){var S=String(o.D).match(La)[1]||null;!S&&l.self&&l.self.location&&(S=l.self.location.protocol.slice(0,-1)),m=!Pd.test(S?S.toLowerCase():"")}d=m}if(d)Ie(o,"complete"),Ie(o,"success");else{o.m=6;try{var N=2<Ht(o)?o.g.statusText:""}catch{N=""}o.l=N+" ["+o.Z()+"]",Ha(o)}}finally{Ni(o)}}}}function Ni(o,u){if(o.g){Wa(o);const d=o.g,m=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||Ie(o,"ready");try{d.onreadystatechange=m}catch{}}}function Wa(o){o.I&&(l.clearTimeout(o.I),o.I=null)}r.isActive=function(){return!!this.g};function Ht(o){return o.g?o.g.readyState:0}r.Z=function(){try{return 2<Ht(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Ai(u)}};function Ga(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Vd(o){const u={};o=(o.g&&2<=Ht(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<o.length;m++){if(k(o[m]))continue;var d=A(o[m]);const S=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const N=u[S]||[];u[S]=N,N.push(d)}I(u,function(m){return m.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Mn(o,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[o]||u}function Ka(o){this.Aa=0,this.i=[],this.j=new z,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Mn("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Mn("baseRetryDelayMs",5e3,o),this.cb=Mn("retryDelaySeedMs",1e4,o),this.Wa=Mn("forwardChannelMaxRetries",2,o),this.wa=Mn("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Pt(o&&o.concurrentRequestLimit),this.Da=new Sd,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Ka.prototype,r.la=8,r.G=1,r.connect=function(o,u,d,m){D(0),this.W=o,this.H=u||{},d&&m!==void 0&&(this.H.OSID=d,this.H.OAID=m),this.F=this.X,this.I=nl(this,null,this.W),ki(this)};function js(o){if(Qa(o),o.G==3){var u=o.U++,d=zt(o.I);if(Ae(d,"SID",o.K),Ae(d,"RID",u),Ae(d,"TYPE","terminate"),On(o,d),u=new Re(o,o.j,u),u.L=2,u.v=Pi(zt(d)),d=!1,l.navigator&&l.navigator.sendBeacon)try{d=l.navigator.sendBeacon(u.v.toString(),"")}catch{}!d&&l.Image&&(new Image().src=u.v,d=!0),d||(u.g=il(u.j,null),u.g.ea(u.v)),u.F=Date.now(),bt(u)}rl(o)}function xi(o){o.g&&(Hs(o),o.g.cancel(),o.g=null)}function Qa(o){xi(o),o.u&&(l.clearTimeout(o.u),o.u=null),Li(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&l.clearTimeout(o.s),o.s=null)}function ki(o){if(!De(o.h)&&!o.s){o.s=!0;var u=o.Ga;We||Ke(),Me||(We(),Me=!0),nt.add(u,o),o.B=0}}function Nd(o,u){return Ir(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=U(g(o.Ga,o,u),tl(o,o.B)),o.B++,!0)}r.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;const S=new Re(this,this.j,o);let N=this.o;if(this.S&&(N?(N=_(N),T(N,this.S)):N=this.S),this.m!==null||this.O||(S.H=N,N=null),this.P)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var m=this.i[d];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(u+=m,4096<u){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=Xa(this,S,u),d=zt(this.I),Ae(d,"RID",o),Ae(d,"CVER",22),this.D&&Ae(d,"X-HTTP-Session-Id",this.D),On(this,d),N&&(this.O?u="headers="+encodeURIComponent(String(ja(N)))+"&"+u:this.m&&Bs(d,this.m,N)),Dn(this.h,S),this.Ua&&Ae(d,"TYPE","init"),this.P?(Ae(d,"$req",u),Ae(d,"SID","null"),S.T=!0,jt(S,d,null)):jt(S,d,u),this.G=2}}else this.G==3&&(o?Ya(this,o):this.i.length==0||De(this.h)||Ya(this))};function Ya(o,u){var d;u?d=u.l:d=o.U++;const m=zt(o.I);Ae(m,"SID",o.K),Ae(m,"RID",d),Ae(m,"AID",o.T),On(o,m),o.m&&o.o&&Bs(m,o.m,o.o),d=new Re(o,o.j,d,o.B+1),o.m===null&&(d.H=o.o),u&&(o.i=u.D.concat(o.i)),u=Xa(o,d,1e3),d.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Dn(o.h,d),jt(d,m,u)}function On(o,u){o.H&&P(o.H,function(d,m){Ae(u,m,d)}),o.l&&ka({},function(d,m){Ae(u,m,d)})}function Xa(o,u,d){d=Math.min(o.i.length,d);var m=o.l?g(o.l.Na,o.l,o):null;e:{var S=o.i;let N=-1;for(;;){const $=["count="+d];N==-1?0<d?(N=S[0].g,$.push("ofs="+N)):N=0:$.push("ofs="+N);let Ee=!0;for(let Qe=0;Qe<d;Qe++){let pe=S[Qe].g;const Je=S[Qe].map;if(pe-=N,0>pe)N=Math.max(0,S[Qe].g-100),Ee=!1;else try{Cd(Je,$,"req"+pe+"_")}catch{m&&m(Je)}}if(Ee){m=$.join("&");break e}}}return o=o.i.splice(0,d),u.D=o,m}function Ja(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;We||Ke(),Me||(We(),Me=!0),nt.add(u,o),o.v=0}}function zs(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=U(g(o.Fa,o),tl(o,o.v)),o.v++,!0)}r.Fa=function(){if(this.u=null,Za(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=U(g(this.ab,this),o)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,D(10),xi(this),Za(this))};function Hs(o){o.A!=null&&(l.clearTimeout(o.A),o.A=null)}function Za(o){o.g=new Re(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=zt(o.qa);Ae(u,"RID","rpc"),Ae(u,"SID",o.K),Ae(u,"AID",o.T),Ae(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&Ae(u,"TO",o.ja),Ae(u,"TYPE","xmlhttp"),On(o,u),o.m&&o.o&&Bs(u,o.m,o.o),o.L&&(o.g.I=o.L);var d=o.g;o=o.ia,d.L=1,d.v=Pi(zt(u)),d.m=null,d.P=!0,wt(d,o)}r.Za=function(){this.C!=null&&(this.C=null,xi(this),zs(this),D(19))};function Li(o){o.C!=null&&(l.clearTimeout(o.C),o.C=null)}function el(o,u){var d=null;if(o.g==u){Li(o),Hs(o),o.g=null;var m=2}else if(Gr(o.h,u))d=u.D,Na(o.h,u),m=1;else return;if(o.G!=0){if(u.o)if(m==1){d=u.m?u.m.length:0,u=Date.now()-u.F;var S=o.B;m=Wr(),Ie(m,new O(m,d)),ki(o)}else Ja(o);else if(S=u.s,S==3||S==0&&0<u.X||!(m==1&&Nd(o,u)||m==2&&zs(o)))switch(d&&0<d.length&&(u=o.h,u.i=u.i.concat(d)),S){case 1:Rr(o,5);break;case 4:Rr(o,10);break;case 3:Rr(o,6);break;default:Rr(o,2)}}}function tl(o,u){let d=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(d*=2),d*u}function Rr(o,u){if(o.j.info("Error code "+u),u==2){var d=g(o.fb,o),m=o.Xa;const S=!m;m=new Ar(m||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Si(m,"https"),Pi(m),S?Rd(m.toString(),d):bd(m.toString(),d)}else D(2);o.G=0,o.l&&o.l.sa(u),rl(o),Qa(o)}r.fb=function(o){o?(this.j.info("Successfully pinged google.com"),D(2)):(this.j.info("Failed to ping google.com"),D(1))};function rl(o){if(o.G=0,o.ka=[],o.l){const u=xa(o.h);(u.length!=0||o.i.length!=0)&&(V(o.ka,u),V(o.ka,o.i),o.h.i.length=0,M(o.i),o.i.length=0),o.l.ra()}}function nl(o,u,d){var m=d instanceof Ar?zt(d):new Ar(d);if(m.g!="")u&&(m.g=u+"."+m.g),Ci(m,m.s);else{var S=l.location;m=S.protocol,u=u?u+"."+S.hostname:S.hostname,S=+S.port;var N=new Ar(null);m&&Si(N,m),u&&(N.g=u),S&&Ci(N,S),d&&(N.l=d),m=N}return d=o.D,u=o.ya,d&&u&&Ae(m,d,u),Ae(m,"VER",o.la),On(o,m),m}function il(o,u,d){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new Ve(new Di({eb:d})):new Ve(o.pa),u.Ha(o.J),u}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function sl(){}r=sl.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Mi(){}Mi.prototype.g=function(o,u){return new ht(o,u)};function ht(o,u){Te.call(this),this.g=new Ka(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!k(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!k(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new Qr(this)}C(ht,Te),ht.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ht.prototype.close=function(){js(this.g)},ht.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var d={};d.__data__=o,o=d}else this.u&&(d={},d.__data__=Sn(o),o=d);u.i.push(new Zt(u.Ya++,o)),u.G==3&&ki(u)},ht.prototype.N=function(){this.g.l=null,delete this.j,js(this.g),delete this.g,ht.aa.N.call(this)};function ol(o){Cn.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(const d in u){o=d;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}C(ol,Cn);function al(){qr.call(this),this.status=1}C(al,qr);function Qr(o){this.g=o}C(Qr,sl),Qr.prototype.ua=function(){Ie(this.g,"a")},Qr.prototype.ta=function(o){Ie(this.g,new ol(o))},Qr.prototype.sa=function(o){Ie(this.g,new al)},Qr.prototype.ra=function(){Ie(this.g,"b")},Mi.prototype.createWebChannel=Mi.prototype.g,ht.prototype.send=ht.prototype.o,ht.prototype.open=ht.prototype.m,ht.prototype.close=ht.prototype.close,ph=function(){return new Mi},fh=function(){return Wr()},dh=ft,Ro={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},W.NO_ERROR=0,W.TIMEOUT=8,W.HTTP_ERROR=6,es=W,ae.COMPLETE="complete",hh=ae,Ri.EventType=Xt,Xt.OPEN="a",Xt.CLOSE="b",Xt.ERROR="c",Xt.MESSAGE="d",Te.prototype.listen=Te.prototype.K,jn=Ri,Ve.prototype.listenOnce=Ve.prototype.L,Ve.prototype.getLastError=Ve.prototype.Ka,Ve.prototype.getLastErrorCode=Ve.prototype.Ba,Ve.prototype.getStatus=Ve.prototype.Z,Ve.prototype.getResponseJson=Ve.prototype.Oa,Ve.prototype.getResponseText=Ve.prototype.oa,Ve.prototype.send=Ve.prototype.ea,Ve.prototype.setWithCredentials=Ve.prototype.Ha,ch=Ve}).apply(typeof zi<"u"?zi:typeof self<"u"?self:typeof window<"u"?window:{});const lu="@firebase/firestore",uu="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tt.UNAUTHENTICATED=new tt(null),tt.GOOGLE_CREDENTIALS=new tt("google-credentials-uid"),tt.FIRST_PARTY=new tt("first-party-uid"),tt.MOCK_USER=new tt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vn="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xr=new nh("@firebase/firestore");function Jr(){return xr.logLevel}function j(r,...e){if(xr.logLevel<=ce.DEBUG){const t=e.map(ua);xr.debug(`Firestore (${vn}): ${r}`,...t)}}function Kt(r,...e){if(xr.logLevel<=ce.ERROR){const t=e.map(ua);xr.error(`Firestore (${vn}): ${r}`,...t)}}function hn(r,...e){if(xr.logLevel<=ce.WARN){const t=e.map(ua);xr.warn(`Firestore (${vn}): ${r}`,...t)}}function ua(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,mh(r,n,t)}function mh(r,e,t){let n=`FIRESTORE (${vn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Kt(n),new Error(n)}function Pe(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||mh(e,i,n)}function he(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Y extends yn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class e_{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(tt.UNAUTHENTICATED)))}shutdown(){}}class t_{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class r_{constructor(e){this.t=e,this.currentUser=tt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Pe(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let s=new sn;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new sn,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const c=s;e.enqueueRetryable((async()=>{await c.promise,await i(this.currentUser)}))},l=c=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((c=>l(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new sn)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((n=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Pe(typeof n.accessToken=="string",31837,{l:n}),new gh(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Pe(e===null||typeof e=="string",2055,{h:e}),new tt(e)}}class n_{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=tt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class i_{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new n_(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(tt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cu{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class s_{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ug(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Pe(this.o===void 0,3512);const n=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,j("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>n(s)))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new cu(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Pe(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new cu(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o_(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ca{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=o_(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function le(r,e){return r<e?-1:r>e?1:0}function bo(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const i=r.charAt(n),s=e.charAt(n);if(i!==s)return no(i)===no(s)?le(i,s):no(i)?1:-1}return le(r.length,e.length)}const a_=55296,l_=57343;function no(r){const e=r.charCodeAt(0);return e>=a_&&e<=l_}function dn(r,e,t){return r.length===e.length&&r.every(((n,i)=>t(n,e[i])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="__name__";class Dt{constructor(e,t,n){t===void 0?t=0:t>e.length&&ne(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&ne(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Dt.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Dt?e.forEach((n=>{t.push(n)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Dt.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return le(e.length,t.length)}static compareSegments(e,t){const n=Dt.isNumericId(e),i=Dt.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Dt.extractNumericId(e).compare(Dt.extractNumericId(t)):bo(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ur.fromString(e.substring(4,e.length-2))}}class Ce extends Dt{construct(e,t,n){return new Ce(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Y(B.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((i=>i.length>0)))}return new Ce(t)}static emptyPath(){return new Ce([])}}const u_=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends Dt{construct(e,t,n){return new st(e,t,n)}static isValidIdentifier(e){return u_.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===hu}static keyField(){return new st([hu])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Y(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Y(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Y(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else l==="`"?(a=!a,i++):l!=="."||a?(n+=l,i++):(s(),i++)}if(s(),a)throw new Y(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(t)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(Ce.fromString(e))}static fromName(e){return new X(Ce.fromString(e).popFirst(5))}static empty(){return new X(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new Ce(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c_(r,e,t){if(!t)throw new Y(B.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function h_(r,e,t,n){if(e===!0&&n===!0)throw new Y(B.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function du(r){if(!X.isDocumentKey(r))throw new Y(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function d_(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function f_(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":ne(12329,{type:typeof r})}function ts(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Y(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=f_(r);throw new Y(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $e(r,e){const t={typeString:r};return e&&(t.value=e),t}function pi(r,e){if(!d_(r))throw new Y(B.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const a=r[n];if(i&&typeof a!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new Y(B.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu=-62135596800,pu=1e6;class Ue{static now(){return Ue.fromMillis(Date.now())}static fromDate(e){return Ue.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*pu);return new Ue(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Y(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Y(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<fu)throw new Y(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Y(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pu}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pi(e,Ue._jsonSchema))return new Ue(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-fu;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ue._jsonSchemaVersion="firestore/timestamp/1.0",Ue._jsonSchema={type:$e("string",Ue._jsonSchemaVersion),seconds:$e("number"),nanoseconds:$e("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{static fromTimestamp(e){return new te(e)}static min(){return new te(new Ue(0,0))}static max(){return new te(new Ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ii=-1;function p_(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=te.fromTimestamp(n===1e9?new Ue(t+1,0):new Ue(t,n));return new fr(i,X.empty(),e)}function m_(r){return new fr(r.readTime,r.key,ii)}class fr{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new fr(te.min(),X.empty(),ii)}static max(){return new fr(te.max(),X.empty(),ii)}}function g_(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=X.comparator(r.documentKey,e.documentKey),t!==0?t:le(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const __="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class y_{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bs(r){if(r.code!==B.FAILED_PRECONDITION||r.message!==__)throw r;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ne(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new L(((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof L?t:L.resolve(t)}catch(t){return L.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):L.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):L.reject(t)}static resolve(e){return new L(((t,n)=>{t(e)}))}static reject(e){return new L(((t,n)=>{n(e)}))}static waitFor(e){return new L(((t,n)=>{let i=0,s=0,a=!1;e.forEach((l=>{++i,l.next((()=>{++s,a&&s===i&&t()}),(c=>n(c)))})),a=!0,s===i&&t()}))}static or(e){let t=L.resolve(!1);for(const n of e)t=t.next((i=>i?L.resolve(i):n()));return t}static forEach(e,t){const n=[];return e.forEach(((i,s)=>{n.push(t.call(this,i,s))})),this.waitFor(n)}static mapArray(e,t){return new L(((n,i)=>{const s=e.length,a=new Array(s);let l=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next((p=>{a[h]=p,++l,l===s&&n(a)}),(p=>i(p)))}}))}static doWhile(e,t){return new L(((n,i)=>{const s=()=>{e()===!0?t().next((()=>{s()}),i):n()};s()}))}}function v_(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function En(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ss.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_=-1;function Cs(r){return r==null}function So(r){return r===0&&1/r==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _h="";function w_(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=mu(e)),e=T_(r.get(t),e);return mu(e)}function T_(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case _h:t+="";break;default:t+=s}}return t}function mu(r){return r+_h+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gu(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function mi(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function I_(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e,t){this.comparator=e,this.root=t||Ye.EMPTY}insert(e,t){return new Le(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ye.BLACK,null,null))}remove(e){return new Le(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ye.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Hi(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Hi(this.root,e,this.comparator,!1)}getReverseIterator(){return new Hi(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Hi(this.root,e,this.comparator,!0)}}class Hi{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ye{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Ye.RED,this.left=i??Ye.EMPTY,this.right=s??Ye.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Ye(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ye.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Ye.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ye.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ye.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ne(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ne(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ne(27949);return e+(this.isRed()?0:1)}}Ye.EMPTY=null,Ye.RED=!0,Ye.BLACK=!1;Ye.EMPTY=new class{constructor(){this.size=0}get key(){throw ne(57766)}get value(){throw ne(16141)}get color(){throw ne(16727)}get left(){throw ne(29726)}get right(){throw ne(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Ye(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.comparator=e,this.data=new Le(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new _u(this.data.getIterator())}getIteratorFrom(e){return new _u(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((n=>{t=t.add(n)})),t}isEqual(e){if(!(e instanceof He)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new He(this.comparator);return t.data=e,t}}class _u{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new sr([])}unionWith(e){let t=new He(st.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new sr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return dn(this.fields,e.fields,((t,n)=>t.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new yh("Invalid base64 string: "+s):s}})(e);return new Xe(t)}static fromUint8Array(e){const t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new Xe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xe.EMPTY_BYTE_STRING=new Xe("");const A_=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(r){if(Pe(!!r,39018),typeof r=="string"){let e=0;const t=A_.exec(r);if(Pe(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ke(r.seconds),nanos:ke(r.nanos)}}function ke(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function mr(r){return typeof r=="string"?Xe.fromBase64String(r):Xe.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh="server_timestamp",Eh="__type__",wh="__previous_value__",Th="__local_write_time__";function ha(r){return(r?.mapValue?.fields||{})[Eh]?.stringValue===vh}function Ps(r){const e=r.mapValue.fields[wh];return ha(e)?Ps(e):e}function si(r){const e=pr(r.mapValue.fields[Th].timestampValue);return new Ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,t,n,i,s,a,l,c,h,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=p}}const ms="(default)";class oi{constructor(e,t){this.projectId=e,this.database=t||ms}static empty(){return new oi("","")}get isDefaultDatabase(){return this.database===ms}isEqual(e){return e instanceof oi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="__type__",S_="__max__",qi={mapValue:{}},C_="__vector__",Co="value";function gr(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?ha(r)?4:D_(r)?9007199254740991:P_(r)?10:11:ne(28295,{value:r})}function Mt(r,e){if(r===e)return!0;const t=gr(r);if(t!==gr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return si(r).isEqual(si(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=pr(i.timestampValue),l=pr(s.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos})(r,e);case 5:return r.stringValue===e.stringValue;case 6:return(function(i,s){return mr(i.bytesValue).isEqual(mr(s.bytesValue))})(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return(function(i,s){return ke(i.geoPointValue.latitude)===ke(s.geoPointValue.latitude)&&ke(i.geoPointValue.longitude)===ke(s.geoPointValue.longitude)})(r,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return ke(i.integerValue)===ke(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=ke(i.doubleValue),l=ke(s.doubleValue);return a===l?So(a)===So(l):isNaN(a)&&isNaN(l)}return!1})(r,e);case 9:return dn(r.arrayValue.values||[],e.arrayValue.values||[],Mt);case 10:case 11:return(function(i,s){const a=i.mapValue.fields||{},l=s.mapValue.fields||{};if(gu(a)!==gu(l))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(l[c]===void 0||!Mt(a[c],l[c])))return!1;return!0})(r,e);default:return ne(52216,{left:r})}}function ai(r,e){return(r.values||[]).find((t=>Mt(t,e)))!==void 0}function fn(r,e){if(r===e)return 0;const t=gr(r),n=gr(e);if(t!==n)return le(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(r.booleanValue,e.booleanValue);case 2:return(function(s,a){const l=ke(s.integerValue||s.doubleValue),c=ke(a.integerValue||a.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1})(r,e);case 3:return yu(r.timestampValue,e.timestampValue);case 4:return yu(si(r),si(e));case 5:return bo(r.stringValue,e.stringValue);case 6:return(function(s,a){const l=mr(s),c=mr(a);return l.compareTo(c)})(r.bytesValue,e.bytesValue);case 7:return(function(s,a){const l=s.split("/"),c=a.split("/");for(let h=0;h<l.length&&h<c.length;h++){const p=le(l[h],c[h]);if(p!==0)return p}return le(l.length,c.length)})(r.referenceValue,e.referenceValue);case 8:return(function(s,a){const l=le(ke(s.latitude),ke(a.latitude));return l!==0?l:le(ke(s.longitude),ke(a.longitude))})(r.geoPointValue,e.geoPointValue);case 9:return vu(r.arrayValue,e.arrayValue);case 10:return(function(s,a){const l=s.fields||{},c=a.fields||{},h=l[Co]?.arrayValue,p=c[Co]?.arrayValue,f=le(h?.values?.length||0,p?.values?.length||0);return f!==0?f:vu(h,p)})(r.mapValue,e.mapValue);case 11:return(function(s,a){if(s===qi.mapValue&&a===qi.mapValue)return 0;if(s===qi.mapValue)return 1;if(a===qi.mapValue)return-1;const l=s.fields||{},c=Object.keys(l),h=a.fields||{},p=Object.keys(h);c.sort(),p.sort();for(let f=0;f<c.length&&f<p.length;++f){const g=bo(c[f],p[f]);if(g!==0)return g;const E=fn(l[c[f]],h[p[f]]);if(E!==0)return E}return le(c.length,p.length)})(r.mapValue,e.mapValue);default:throw ne(23264,{he:t})}}function yu(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return le(r,e);const t=pr(r),n=pr(e),i=le(t.seconds,n.seconds);return i!==0?i:le(t.nanos,n.nanos)}function vu(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=fn(t[i],n[i]);if(s)return s}return le(t.length,n.length)}function pn(r){return Po(r)}function Po(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?(function(t){const n=pr(t);return`time(${n.seconds},${n.nanos})`})(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?(function(t){return mr(t).toBase64()})(r.bytesValue):"referenceValue"in r?(function(t){return X.fromName(t).toString()})(r.referenceValue):"geoPointValue"in r?(function(t){return`geo(${t.latitude},${t.longitude})`})(r.geoPointValue):"arrayValue"in r?(function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=Po(s);return n+"]"})(r.arrayValue):"mapValue"in r?(function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${Po(t.fields[a])}`;return i+"}"})(r.mapValue):ne(61005,{value:r})}function rs(r){switch(gr(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ps(r);return e?16+rs(e):16;case 5:return 2*r.stringValue.length;case 6:return mr(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((i,s)=>i+rs(s)),0)})(r.arrayValue);case 10:case 11:return(function(n){let i=0;return mi(n.fields,((s,a)=>{i+=s.length+rs(a)})),i})(r.mapValue);default:throw ne(13486,{value:r})}}function Do(r){return!!r&&"integerValue"in r}function da(r){return!!r&&"arrayValue"in r}function Eu(r){return!!r&&"nullValue"in r}function wu(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function io(r){return!!r&&"mapValue"in r}function P_(r){return(r?.mapValue?.fields||{})[b_]?.stringValue===C_}function Gn(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return mi(r.mapValue.fields,((t,n)=>e.mapValue.fields[t]=Gn(n))),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Gn(r.arrayValue.values[t]);return e}return{...r}}function D_(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===S_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.value=e}static empty(){return new Vt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!io(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gn(t)}setAll(e){let t=st.emptyPath(),n={},i=[];e.forEach(((a,l)=>{if(!t.isImmediateParentOf(l)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=l.popLast()}a?n[l.lastSegment()]=Gn(a):i.push(l.lastSegment())}));const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());io(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];io(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){mi(t,((i,s)=>e[i]=s));for(const i of n)delete e[i]}clone(){return new Vt(Gn(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,t,n,i,s,a,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=l}static newInvalidDocument(e){return new rt(e,0,te.min(),te.min(),te.min(),Vt.empty(),0)}static newFoundDocument(e,t,n,i){return new rt(e,1,t,te.min(),n,i,0)}static newNoDocument(e,t){return new rt(e,2,t,te.min(),te.min(),Vt.empty(),0)}static newUnknownDocument(e,t){return new rt(e,3,t,te.min(),te.min(),Vt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,t){this.position=e,this.inclusive=t}}function Tu(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=X.comparator(X.fromName(a.referenceValue),t.key):n=fn(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function Iu(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Mt(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,t="asc"){this.field=e,this.dir=t}}function V_(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{}class ze extends Ih{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new x_(e,t,n):t==="array-contains"?new M_(e,n):t==="in"?new O_(e,n):t==="not-in"?new F_(e,n):t==="array-contains-any"?new U_(e,n):new ze(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new k_(e,n):new L_(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(fn(t,this.value)):t!==null&&gr(this.value)===gr(t)&&this.matchesComparison(fn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ot extends Ih{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ot(e,t)}matches(e){return Ah(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ah(r){return r.op==="and"}function Rh(r){return N_(r)&&Ah(r)}function N_(r){for(const e of r.filters)if(e instanceof Ot)return!1;return!0}function Vo(r){if(r instanceof ze)return r.field.canonicalString()+r.op.toString()+pn(r.value);if(Rh(r))return r.filters.map((e=>Vo(e))).join(",");{const e=r.filters.map((t=>Vo(t))).join(",");return`${r.op}(${e})`}}function bh(r,e){return r instanceof ze?(function(n,i){return i instanceof ze&&n.op===i.op&&n.field.isEqual(i.field)&&Mt(n.value,i.value)})(r,e):r instanceof Ot?(function(n,i){return i instanceof Ot&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce(((s,a,l)=>s&&bh(a,i.filters[l])),!0):!1})(r,e):void ne(19439)}function Sh(r){return r instanceof ze?(function(t){return`${t.field.canonicalString()} ${t.op} ${pn(t.value)}`})(r):r instanceof Ot?(function(t){return t.op.toString()+" {"+t.getFilters().map(Sh).join(" ,")+"}"})(r):"Filter"}class x_ extends ze{constructor(e,t,n){super(e,t,n),this.key=X.fromName(n.referenceValue)}matches(e){const t=X.comparator(e.key,this.key);return this.matchesComparison(t)}}class k_ extends ze{constructor(e,t){super(e,"in",t),this.keys=Ch("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class L_ extends ze{constructor(e,t){super(e,"not-in",t),this.keys=Ch("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Ch(r,e){return(e.arrayValue?.values||[]).map((t=>X.fromName(t.referenceValue)))}class M_ extends ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return da(t)&&ai(t.arrayValue,this.value)}}class O_ extends ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ai(this.value.arrayValue,t)}}class F_ extends ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(ai(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ai(this.value.arrayValue,t)}}class U_ extends ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!da(t)||!t.arrayValue.values)&&t.arrayValue.values.some((n=>ai(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e,t=null,n=[],i=[],s=null,a=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=l,this.Te=null}}function Au(r,e=null,t=[],n=[],i=null,s=null,a=null){return new $_(r,e,t,n,i,s,a)}function fa(r){const e=he(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((n=>Vo(n))).join(","),t+="|ob:",t+=e.orderBy.map((n=>(function(s){return s.field.canonicalString()+s.dir})(n))).join(","),Cs(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((n=>pn(n))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((n=>pn(n))).join(",")),e.Te=t}return e.Te}function pa(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!V_(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!bh(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!Iu(r.startAt,e.startAt)&&Iu(r.endAt,e.endAt)}function No(r){return X.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e,t=null,n=[],i=[],s=null,a="F",l=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=l,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function B_(r,e,t,n,i,s,a,l){return new Ds(r,e,t,n,i,s,a,l)}function ma(r){return new Ds(r)}function Ru(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function j_(r){return r.collectionGroup!==null}function Kn(r){const e=he(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let l=new He(st.comparator);return a.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(l=l.add(h.field))}))})),l})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new _s(s,n))})),t.has(st.keyField().canonicalString())||e.Ie.push(new _s(st.keyField(),n))}return e.Ie}function Lt(r){const e=he(r);return e.Ee||(e.Ee=z_(e,Kn(r))),e.Ee}function z_(r,e){if(r.limitType==="F")return Au(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map((i=>{const s=i.dir==="desc"?"asc":"desc";return new _s(i.field,s)}));const t=r.endAt?new gs(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new gs(r.startAt.position,r.startAt.inclusive):null;return Au(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function xo(r,e,t){return new Ds(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Vs(r,e){return pa(Lt(r),Lt(e))&&r.limitType===e.limitType}function Ph(r){return`${fa(Lt(r))}|lt:${r.limitType}`}function Zr(r){return`Query(target=${(function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map((i=>Sh(i))).join(", ")}]`),Cs(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map((i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i))).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((i=>pn(i))).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((i=>pn(i))).join(",")),`Target(${n})`})(Lt(r))}; limitType=${r.limitType})`}function Ns(r,e){return e.isFoundDocument()&&(function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):X.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)})(r,e)&&(function(n,i){for(const s of Kn(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(r,e)&&(function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0})(r,e)&&(function(n,i){return!(n.startAt&&!(function(a,l,c){const h=Tu(a,l,c);return a.inclusive?h<=0:h<0})(n.startAt,Kn(n),i)||n.endAt&&!(function(a,l,c){const h=Tu(a,l,c);return a.inclusive?h>=0:h>0})(n.endAt,Kn(n),i))})(r,e)}function H_(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function Dh(r){return(e,t)=>{let n=!1;for(const i of Kn(r)){const s=q_(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function q_(r,e,t){const n=r.field.isKeyField()?X.comparator(e.key,t.key):(function(s,a,l){const c=a.data.field(s),h=l.data.field(s);return c!==null&&h!==null?fn(c,h):ne(42886)})(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return ne(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){mi(this.inner,((t,n)=>{for(const[i,s]of n)e(i,s)}))}isEmpty(){return I_(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W_=new Le(X.comparator);function _r(){return W_}const Vh=new Le(X.comparator);function zn(...r){let e=Vh;for(const t of r)e=e.insert(t.key,t);return e}function G_(r){let e=Vh;return r.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function Pr(){return Qn()}function Nh(){return Qn()}function Qn(){return new Mr((r=>r.toString()),((r,e)=>r.isEqual(e)))}const K_=new He(X.comparator);function fe(...r){let e=K_;for(const t of r)e=e.add(t);return e}const Q_=new He(le);function Y_(){return Q_}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X_(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:So(e)?"-0":e}}function J_(r){return{integerValue:""+r}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(){this._=void 0}}function Z_(r,e,t){return r instanceof ko?(function(i,s){const a={fields:{[Eh]:{stringValue:vh},[Th]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ha(s)&&(s=Ps(s)),s&&(a.fields[wh]=s),{mapValue:a}})(t,e):r instanceof ys?xh(r,e):r instanceof vs?kh(r,e):(function(i,s){const a=ty(i,s),l=bu(a)+bu(i.Ae);return Do(a)&&Do(i.Ae)?J_(l):X_(i.serializer,l)})(r,e)}function ey(r,e,t){return r instanceof ys?xh(r,e):r instanceof vs?kh(r,e):t}function ty(r,e){return r instanceof Lo?(function(n){return Do(n)||(function(s){return!!s&&"doubleValue"in s})(n)})(e)?e:{integerValue:0}:null}class ko extends xs{}class ys extends xs{constructor(e){super(),this.elements=e}}function xh(r,e){const t=Lh(e);for(const n of r.elements)t.some((i=>Mt(i,n)))||t.push(n);return{arrayValue:{values:t}}}class vs extends xs{constructor(e){super(),this.elements=e}}function kh(r,e){let t=Lh(e);for(const n of r.elements)t=t.filter((i=>!Mt(i,n)));return{arrayValue:{values:t}}}class Lo extends xs{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function bu(r){return ke(r.integerValue||r.doubleValue)}function Lh(r){return da(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}function ry(r,e){return r.field.isEqual(e.field)&&(function(n,i){return n instanceof ys&&i instanceof ys||n instanceof vs&&i instanceof vs?dn(n.elements,i.elements,Mt):n instanceof Lo&&i instanceof Lo?Mt(n.Ae,i.Ae):n instanceof ko&&i instanceof ko})(r.transform,e.transform)}class Dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Dr}static exists(e){return new Dr(void 0,e)}static updateTime(e){return new Dr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ns(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class ga{}function Mh(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new iy(r.key,Dr.none()):new _a(r.key,r.data,Dr.none());{const t=r.data,n=Vt.empty();let i=new He(st.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ks(r.key,n,new sr(i.toArray()),Dr.none())}}function ny(r,e,t){r instanceof _a?(function(i,s,a){const l=i.value.clone(),c=Cu(i.fieldTransforms,s,a.transformResults);l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(r,e,t):r instanceof ks?(function(i,s,a){if(!ns(i.precondition,s))return void s.convertToUnknownDocument(a.version);const l=Cu(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(Oh(i)),c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(r,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function Yn(r,e,t,n){return r instanceof _a?(function(s,a,l,c){if(!ns(s.precondition,a))return l;const h=s.value.clone(),p=Pu(s.fieldTransforms,c,a);return h.setAll(p),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null})(r,e,t,n):r instanceof ks?(function(s,a,l,c){if(!ns(s.precondition,a))return l;const h=Pu(s.fieldTransforms,c,a),p=a.data;return p.setAll(Oh(s)),p.setAll(h),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((f=>f.field)))})(r,e,t,n):(function(s,a,l){return ns(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l})(r,e,t)}function Su(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!(function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&dn(n,i,((s,a)=>ry(s,a)))})(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class _a extends ga{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ks extends ga{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Oh(r){const e=new Map;return r.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}})),e}function Cu(r,e,t){const n=new Map;Pe(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,l=e.data.field(s.field);n.set(s.field,ey(a,l,t[i]))}return n}function Pu(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,Z_(s,a,e))}return n}class iy extends ga{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ny(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Yn(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Yn(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Nh();return this.mutations.forEach((i=>{const s=e.get(i.key),a=s.overlayedDocument;let l=this.applyToLocalView(a,s.mutatedFields);l=t.has(i.key)?null:l;const c=Mh(a,l);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(te.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),fe())}isEqual(e){return this.batchId===e.batchId&&dn(this.mutations,e.mutations,((t,n)=>Su(t,n)))&&dn(this.baseMutations,e.baseMutations,((t,n)=>Su(t,n)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe,ue;function Fh(r){if(r===void 0)return Kt("GRPC error has no .code"),B.UNKNOWN;switch(r){case Fe.OK:return B.OK;case Fe.CANCELLED:return B.CANCELLED;case Fe.UNKNOWN:return B.UNKNOWN;case Fe.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Fe.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Fe.INTERNAL:return B.INTERNAL;case Fe.UNAVAILABLE:return B.UNAVAILABLE;case Fe.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Fe.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Fe.NOT_FOUND:return B.NOT_FOUND;case Fe.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Fe.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Fe.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Fe.ABORTED:return B.ABORTED;case Fe.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Fe.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Fe.DATA_LOSS:return B.DATA_LOSS;default:return ne(39323,{code:r})}}(ue=Fe||(Fe={}))[ue.OK=0]="OK",ue[ue.CANCELLED=1]="CANCELLED",ue[ue.UNKNOWN=2]="UNKNOWN",ue[ue.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ue[ue.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ue[ue.NOT_FOUND=5]="NOT_FOUND",ue[ue.ALREADY_EXISTS=6]="ALREADY_EXISTS",ue[ue.PERMISSION_DENIED=7]="PERMISSION_DENIED",ue[ue.UNAUTHENTICATED=16]="UNAUTHENTICATED",ue[ue.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ue[ue.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ue[ue.ABORTED=10]="ABORTED",ue[ue.OUT_OF_RANGE=11]="OUT_OF_RANGE",ue[ue.UNIMPLEMENTED=12]="UNIMPLEMENTED",ue[ue.INTERNAL=13]="INTERNAL",ue[ue.UNAVAILABLE=14]="UNAVAILABLE",ue[ue.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ly(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=new ur([4294967295,4294967295],0);function Du(r){const e=ly().encode(r),t=new uh;return t.update(e),new Uint8Array(t.digest())}function Vu(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ur([t,n],0),new ur([i,s],0)]}class ya{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Hn(`Invalid padding: ${t}`);if(n<0)throw new Hn(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Hn(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Hn(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=ur.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(ur.fromNumber(n)));return i.compare(uy)===1&&(i=new ur([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=Du(e),[n,i]=Vu(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);if(!this.we(a))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new ya(s,i,t);return n.forEach((l=>a.insert(l))),a}insert(e){if(this.ge===0)return;const t=Du(e),[n,i]=Vu(t);for(let s=0;s<this.hashCount;s++){const a=this.ye(n,i,s);this.Se(a)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Hn extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,gi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Ls(te.min(),i,new Le(le),_r(),fe())}}class gi{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new gi(n,t,fe(),fe(),fe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t,n,i){this.be=e,this.removedTargetIds=t,this.key=n,this.De=i}}class Uh{constructor(e,t){this.targetId=e,this.Ce=t}}class $h{constructor(e,t,n=Xe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Nu{constructor(){this.ve=0,this.Fe=xu(),this.Me=Xe.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=fe(),t=fe(),n=fe();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:ne(38017,{changeType:s})}})),new gi(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=xu()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Pe(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class cy{constructor(e){this.Ge=e,this.ze=new Map,this.je=_r(),this.Je=Wi(),this.He=Wi(),this.Ye=new Le(le)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:ne(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((n,i)=>{this.rt(i)&&t(i)}))}st(e){const t=e.targetId,n=e.Ce.count,i=this.ot(t);if(i){const s=i.target;if(No(s))if(n===0){const a=new X(s.path);this.et(t,a,rt.newNoDocument(a,te.min()))}else Pe(n===1,20013,{expectedCount:n});else{const a=this._t(t);if(a!==n){const l=this.ut(e),c=l?this.ct(l,e,a):1;if(c!==0){this.it(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let a,l;try{a=mr(n).toUint8Array()}catch(c){if(c instanceof yh)return hn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new ya(a,i,s)}catch(c){return hn(c instanceof Hn?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.ge===0?null:l}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let i=0;return n.forEach((s=>{const a=this.Ge.ht(),l=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.et(t,s,null),i++)})),i}Tt(e){const t=new Map;this.ze.forEach(((s,a)=>{const l=this.ot(a);if(l){if(s.current&&No(l.target)){const c=new X(l.target.path);this.It(c).has(a)||this.Et(a,c)||this.et(a,c,rt.newNoDocument(c,e))}s.Be&&(t.set(a,s.ke()),s.qe())}}));let n=fe();this.He.forEach(((s,a)=>{let l=!0;a.forEachWhile((c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)})),l&&(n=n.add(s))})),this.je.forEach(((s,a)=>a.setReadTime(e)));const i=new Ls(e,t,this.Ye,this.je,n);return this.je=_r(),this.Je=Wi(),this.He=Wi(),this.Ye=new Le(le),i}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Nu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new He(le),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new He(le),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||j("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Nu),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Wi(){return new Le(X.comparator)}function xu(){return new Le(X.comparator)}const hy={asc:"ASCENDING",desc:"DESCENDING"},dy={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},fy={and:"AND",or:"OR"};class py{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Mo(r,e){return r.useProto3Json||Cs(e)?e:{value:e}}function my(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gy(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function on(r){return Pe(!!r,49232),te.fromTimestamp((function(t){const n=pr(t);return new Ue(n.seconds,n.nanos)})(r))}function _y(r,e){return Oo(r,e).canonicalString()}function Oo(r,e){const t=(function(i){return new Ce(["projects",i.projectId,"databases",i.database])})(r).child("documents");return e===void 0?t:t.child(e)}function Bh(r){const e=Ce.fromString(r);return Pe(Wh(e),10190,{key:e.toString()}),e}function so(r,e){const t=Bh(e);if(t.get(1)!==r.databaseId.projectId)throw new Y(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Y(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new X(zh(t))}function jh(r,e){return _y(r.databaseId,e)}function yy(r){const e=Bh(r);return e.length===4?Ce.emptyPath():zh(e)}function ku(r){return new Ce(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function zh(r){return Pe(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function vy(r,e){let t;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ne(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(h,p){return h.useProto3Json?(Pe(p===void 0||typeof p=="string",58123),Xe.fromBase64String(p||"")):(Pe(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Xe.fromUint8Array(p||new Uint8Array))})(r,e.targetChange.resumeToken),a=e.targetChange.cause,l=a&&(function(h){const p=h.code===void 0?B.UNKNOWN:Fh(h.code);return new Y(p,h.message||"")})(a);t=new $h(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=so(r,n.document.name),s=on(n.document.updateTime),a=n.document.createTime?on(n.document.createTime):te.min(),l=new Vt({mapValue:{fields:n.document.fields}}),c=rt.newFoundDocument(i,s,a,l),h=n.targetIds||[],p=n.removedTargetIds||[];t=new is(h,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=so(r,n.document),s=n.readTime?on(n.readTime):te.min(),a=rt.newNoDocument(i,s),l=n.removedTargetIds||[];t=new is([],l,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=so(r,n.document),s=n.removedTargetIds||[];t=new is([],s,i,null)}else{if(!("filter"in e))return ne(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ay(i,s),l=n.targetId;t=new Uh(l,a)}}return t}function Ey(r,e){return{documents:[jh(r,e.path)]}}function wy(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=jh(r,i);const s=(function(h){if(h.length!==0)return qh(Ot.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);const a=(function(h){if(h.length!==0)return h.map((p=>(function(g){return{field:en(g.field),direction:Ay(g.dir)}})(p)))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=Mo(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:i}}function Ty(r){let e=yy(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){Pe(n===1,65062);const p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(f){const g=Hh(f);return g instanceof Ot&&Rh(g)?g.getFilters():[g]})(t.where));let a=[];t.orderBy&&(a=(function(f){return f.map((g=>(function(C){return new _s(tn(C.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(g)))})(t.orderBy));let l=null;t.limit&&(l=(function(f){let g;return g=typeof f=="object"?f.value:f,Cs(g)?null:g})(t.limit));let c=null;t.startAt&&(c=(function(f){const g=!!f.before,E=f.values||[];return new gs(E,g)})(t.startAt));let h=null;return t.endAt&&(h=(function(f){const g=!f.before,E=f.values||[];return new gs(E,g)})(t.endAt)),B_(e,i,a,s,l,"F",c,h)}function Iy(r,e){const t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Hh(r){return r.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=tn(t.unaryFilter.field);return ze.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=tn(t.unaryFilter.field);return ze.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=tn(t.unaryFilter.field);return ze.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=tn(t.unaryFilter.field);return ze.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ne(61313);default:return ne(60726)}})(r):r.fieldFilter!==void 0?(function(t){return ze.create(tn(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ne(58110);default:return ne(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(r):r.compositeFilter!==void 0?(function(t){return Ot.create(t.compositeFilter.filters.map((n=>Hh(n))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne(1026)}})(t.compositeFilter.op))})(r):ne(30097,{filter:r})}function Ay(r){return hy[r]}function Ry(r){return dy[r]}function by(r){return fy[r]}function en(r){return{fieldPath:r.canonicalString()}}function tn(r){return st.fromServerFormat(r.fieldPath)}function qh(r){return r instanceof ze?(function(t){if(t.op==="=="){if(wu(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NAN"}};if(Eu(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(wu(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NOT_NAN"}};if(Eu(t.value))return{unaryFilter:{field:en(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:en(t.field),op:Ry(t.op),value:t.value}}})(r):r instanceof Ot?(function(t){const n=t.getFilters().map((i=>qh(i)));return n.length===1?n[0]:{compositeFilter:{op:by(t.op),filters:n}}})(r):ne(54877,{filter:r})}function Wh(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t,n,i,s=te.min(),a=te.min(),l=Xe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new or(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new or(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e){this.yt=e}}function Cy(r){const e=Ty({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?xo(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(){this.Cn=new Dy}addToCollectionParentIndex(e,t){return this.Cn.add(t),L.resolve()}getCollectionParents(e,t){return L.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return L.resolve()}deleteFieldIndex(e,t){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,t){return L.resolve()}getDocumentsMatchingTarget(e,t){return L.resolve(null)}getIndexType(e,t){return L.resolve(0)}getFieldIndexes(e,t){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,t){return L.resolve(fr.min())}getMinOffsetFromCollectionGroup(e,t){return L.resolve(fr.min())}updateCollectionGroup(e,t,n){return L.resolve()}updateIndexEntries(e,t){return L.resolve()}}class Dy{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new He(Ce.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new He(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Gh=41943040;class lt{static withCacheSize(e){return new lt(e,lt.DEFAULT_COLLECTION_PERCENTILE,lt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt.DEFAULT_COLLECTION_PERCENTILE=10,lt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lt.DEFAULT=new lt(Gh,lt.DEFAULT_COLLECTION_PERCENTILE,lt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lt.DISABLED=new lt(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new mn(0)}static cr(){return new mn(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu="LruGarbageCollector",Vy=1048576;function Ou([r,e],[t,n]){const i=le(r,t);return i===0?le(e,n):i}class Ny{constructor(e){this.Ir=e,this.buffer=new He(Ou),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Ou(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class xy{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){j(Mu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){En(t)?j(Mu,"Ignoring IndexedDB error during garbage collection: ",t):await bs(t)}await this.Vr(3e5)}))}}class ky{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((n=>Math.floor(t/100*n)))}nthSequenceNumber(e,t){if(t===0)return L.resolve(Ss.ce);const n=new Ny(t);return this.mr.forEachTarget(e,(i=>n.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>n.Ar(i))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(Lu)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Lu):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,i,s,a,l,c,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((f=>(f>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,a=Date.now(),this.nthSequenceNumber(e,i)))).next((f=>(n=f,l=Date.now(),this.removeTargets(e,n,t)))).next((f=>(s=f,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((f=>(h=Date.now(),Jr()<=ce.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(l-a)+`ms
	Removed ${s} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(h-c)+`ms
Total Duration: ${h-p}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f}))))}}function Ly(r,e){return new ky(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(){this.changes=new Mr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,rt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?L.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(n=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(n!==null&&Yn(n.mutation,i,sr.empty(),Ue.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.getLocalViewOfDocuments(e,n,fe()).next((()=>n))))}getLocalViewOfDocuments(e,t,n=fe()){const i=Pr();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,n).next((s=>{let a=zn();return s.forEach(((l,c)=>{a=a.insert(l,c.overlayedDocument)})),a}))))}getOverlayedDocuments(e,t){const n=Pr();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,fe())))}populateOverlays(e,t,n){const i=[];return n.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((a,l)=>{t.set(a,l)}))}))}computeViews(e,t,n,i){let s=_r();const a=Qn(),l=(function(){return Qn()})();return t.forEach(((c,h)=>{const p=n.get(h.key);i.has(h.key)&&(p===void 0||p.mutation instanceof ks)?s=s.insert(h.key,h):p!==void 0?(a.set(h.key,p.mutation.getFieldMask()),Yn(p.mutation,h,p.mutation.getFieldMask(),Ue.now())):a.set(h.key,sr.empty())})),this.recalculateAndSaveOverlays(e,s).next((c=>(c.forEach(((h,p)=>a.set(h,p))),t.forEach(((h,p)=>l.set(h,new Oy(p,a.get(h)??null)))),l)))}recalculateAndSaveOverlays(e,t){const n=Qn();let i=new Le(((a,l)=>a-l)),s=fe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((a=>{for(const l of a)l.keys().forEach((c=>{const h=t.get(c);if(h===null)return;let p=n.get(c)||sr.empty();p=l.applyToLocalView(h,p),n.set(c,p);const f=(i.get(l.batchId)||fe()).add(c);i=i.insert(l.batchId,f)}))})).next((()=>{const a=[],l=i.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),h=c.key,p=c.value,f=Nh();p.forEach((g=>{if(!s.has(g)){const E=Mh(t.get(g),n.get(g));E!==null&&f.set(g,E),s=s.add(g)}})),a.push(this.documentOverlayCache.saveOverlays(e,h,f))}return L.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,t,n,i){return(function(a){return X.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):j_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next((s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):L.resolve(Pr());let l=ii,c=s;return a.next((h=>L.forEach(h,((p,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(p)?L.resolve():this.remoteDocumentCache.getEntry(e,p).next((g=>{c=c.insert(p,g)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,c,h,fe()))).next((p=>({batchId:l,changes:G_(p)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new X(t)).next((n=>{let i=zn();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=zn();return this.indexManager.getCollectionParents(e,s).next((l=>L.forEach(l,(c=>{const h=(function(f,g){return new Ds(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next((p=>{p.forEach(((f,g)=>{a=a.insert(f,g)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i)))).next((a=>{s.forEach(((c,h)=>{const p=h.getKey();a.get(p)===null&&(a=a.insert(p,rt.newInvalidDocument(p)))}));let l=zn();return a.forEach(((c,h)=>{const p=s.get(c);p!==void 0&&Yn(p.mutation,h,sr.empty(),Ue.now()),Ns(t,h)&&(l=l.insert(c,h))})),l}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return L.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:on(i.createTime)}})(t)),L.resolve()}getNamedQuery(e,t){return L.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:Cy(i.bundledQuery),readTime:on(i.readTime)}})(t)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.overlays=new Le(X.comparator),this.qr=new Map}getOverlay(e,t){return L.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Pr();return L.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&n.set(i,s)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((i,s)=>{this.St(e,t,s)})),L.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.qr.get(n);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(n)),L.resolve()}getOverlaysForCollection(e,t,n){const i=Pr(),s=t.length+1,a=new X(t.child("")),l=this.overlays.getIteratorFrom(a);for(;l.hasNext();){const c=l.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Le(((h,p)=>h-p));const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let p=s.get(h.largestBatchId);p===null&&(p=Pr(),s=s.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const l=Pr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,p)=>l.set(h,p))),!(l.size()>=i)););return L.resolve(l)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.qr.get(i.largestBatchId).delete(n.key);this.qr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new oy(t,n));let s=this.qr.get(t);s===void 0&&(s=fe(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(){this.sessionToken=Xe.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(){this.Qr=new He(Ge.$r),this.Ur=new He(Ge.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Ge(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((n=>this.addReference(n,t)))}removeReference(e,t){this.Gr(new Ge(e,t))}zr(e,t){e.forEach((n=>this.removeReference(n,t)))}jr(e){const t=new X(new Ce([])),n=new Ge(t,e),i=new Ge(t,e+1),s=[];return this.Ur.forEachInRange([n,i],(a=>{this.Gr(a),s.push(a.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new X(new Ce([])),n=new Ge(t,e),i=new Ge(t,e+1);let s=fe();return this.Ur.forEachInRange([n,i],(a=>{s=s.add(a.key)})),s}containsKey(e){const t=new Ge(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Ge{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return X.comparator(e.key,t.key)||le(e.Yr,t.Yr)}static Kr(e,t){return le(e.Yr,t.Yr)||X.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new He(Ge.$r)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new sy(s,t,n,i);this.mutationQueue.push(a);for(const l of i)this.Zr=this.Zr.add(new Ge(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return L.resolve(a)}lookupMutationBatch(e,t){return L.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ei(n),s=i<0?0:i;return L.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?E_:this.tr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ge(t,0),i=new Ge(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,i],(a=>{const l=this.Xr(a.Yr);s.push(l)})),L.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new He(le);return t.forEach((i=>{const s=new Ge(i,0),a=new Ge(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,a],(l=>{n=n.add(l.Yr)}))})),L.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;X.isDocumentKey(s)||(s=s.child(""));const a=new Ge(new X(s),0);let l=new He(le);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(l=l.add(c.Yr)),!0)}),a),L.resolve(this.ti(l))}ti(e){const t=[];return e.forEach((n=>{const i=this.Xr(n);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){Pe(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return L.forEach(t.mutations,(i=>{const s=new Ge(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new Ge(t,0),i=this.Zr.firstAfterOrEqual(n);return L.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e){this.ri=e,this.docs=(function(){return new Le(X.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return L.resolve(n?n.document.mutableCopy():rt.newInvalidDocument(t))}getEntries(e,t){let n=_r();return t.forEach((i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():rt.newInvalidDocument(i))})),L.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=_r();const a=t.path,l=new X(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:h,value:{document:p}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||g_(m_(p),n)<=0||(i.has(p.key)||Ns(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return L.resolve(s)}getAllFromCollectionGroup(e,t,n,i){ne(9500)}ii(e,t){return L.forEach(this.docs,(n=>t(n)))}newChangeBuffer(e){return new Hy(this)}getSize(e){return L.resolve(this.size)}}class Hy extends My{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(n)})),L.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this.persistence=e,this.si=new Mr((t=>fa(t)),pa),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.oi=0,this._i=new va,this.targetCount=0,this.ai=mn.ur()}forEachTarget(e,t){return this.si.forEach(((n,i)=>t(i))),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),L.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new mn(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,L.resolve()}updateTargetData(e,t){return this.Pr(t),L.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.si.forEach(((a,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.si.delete(a),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)})),L.waitFor(s).next((()=>i))}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return L.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),L.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((a=>{s.push(i.markPotentiallyOrphaned(e,a))})),L.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),L.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return L.resolve(n)}containsKey(e,t){return L.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ss(0),this.li=!1,this.li=!0,this.hi=new By,this.referenceDelegate=e(this),this.Pi=new qy(this),this.indexManager=new Py,this.remoteDocumentCache=(function(i){return new zy(i)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new Sy(t),this.Ii=new Uy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new $y,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new jy(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){j("MemoryPersistence","Starting transaction:",e);const i=new Wy(this.ci.next());return this.referenceDelegate.Ei(),n(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return L.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class Wy extends y_{constructor(e){super(),this.currentSequenceNumber=e}}class Ea{constructor(e){this.persistence=e,this.Ri=new va,this.Vi=null}static mi(e){return new Ea(e)}get fi(){if(this.Vi)return this.Vi;throw ne(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),L.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),L.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),L.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.fi,(n=>{const i=X.fromPath(n);return this.gi(e,i).next((s=>{s||t.removeEntry(i,te.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return L.or([()=>L.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Es{constructor(e,t){this.persistence=e,this.pi=new Mr((n=>w_(n.path)),((n,i)=>n.isEqual(i))),this.garbageCollector=Ly(this,t)}static mi(e,t){return new Es(e,t)}Ei(){}di(e){return L.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>t.next((i=>n+i))))}wr(e){let t=0;return this.pr(e,(n=>{t++})).next((()=>t))}pr(e,t){return L.forEach(this.pi,((n,i)=>this.br(e,n,i).next((s=>s?L.resolve():t(i)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(a=>this.br(e,a,t).next((l=>{l||(n++,s.removeEntry(a,te.min()))})))).next((()=>s.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),L.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),L.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),L.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=rs(e.data.value)),t}br(e,t,n){return L.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.pi.get(t);return L.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=i}static As(e,t){let n=fe(),i=fe();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new wa(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Mm()?8:v_(km())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ys(e,t).next((a=>{s.result=a})).next((()=>{if(!s.result)return this.ws(e,t,i,n).next((a=>{s.result=a}))})).next((()=>{if(s.result)return;const a=new Gy;return this.Ss(e,t,a).next((l=>{if(s.result=l,this.Vs)return this.bs(e,t,a,l.size)}))})).next((()=>s.result))}bs(e,t,n,i){return n.documentReadCount<this.fs?(Jr()<=ce.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",Zr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),L.resolve()):(Jr()<=ce.DEBUG&&j("QueryEngine","Query:",Zr(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.gs*i?(Jr()<=ce.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",Zr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Lt(t))):L.resolve())}ys(e,t){if(Ru(t))return L.resolve(null);let n=Lt(t);return this.indexManager.getIndexType(e,n).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=xo(t,null,"F"),n=Lt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((s=>{const a=fe(...s);return this.ps.getDocuments(e,a).next((l=>this.indexManager.getMinOffset(e,n).next((c=>{const h=this.Ds(t,l);return this.Cs(t,h,a,c.readTime)?this.ys(e,xo(t,null,"F")):this.vs(e,h,t,c)}))))})))))}ws(e,t,n,i){return Ru(t)||i.isEqual(te.min())?L.resolve(null):this.ps.getDocuments(e,n).next((s=>{const a=this.Ds(t,s);return this.Cs(t,a,n,i)?L.resolve(null):(Jr()<=ce.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zr(t)),this.vs(e,a,t,p_(i,ii)).next((l=>l)))}))}Ds(e,t){let n=new He(Dh(e));return t.forEach(((i,s)=>{Ns(e,s)&&(n=n.add(s))})),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return Jr()<=ce.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",Zr(t)),this.ps.getDocumentsMatchingQuery(e,t,fr.min(),n)}vs(e,t,n,i){return this.ps.getDocumentsMatchingQuery(e,n,i).next((s=>(t.forEach((a=>{s=s.insert(a.key,a)})),s)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ta="LocalStore",Qy=3e8;class Yy{constructor(e,t,n,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Le(le),this.xs=new Mr((s=>fa(s)),pa),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fy(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Xy(r,e,t,n){return new Yy(r,e,t,n)}async function Qh(r,e){const t=he(r);return await t.persistence.runTransaction("Handle user change","readonly",(n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(n)))).next((s=>{const a=[],l=[];let c=fe();for(const h of i){a.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}for(const h of s){l.push(h.batchId);for(const p of h.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(n,c).next((h=>({Ls:h,removedBatchIds:a,addedBatchIds:l})))}))}))}function Yh(r){const e=he(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Jy(r,e){const t=he(r),n=e.snapshotVersion;let i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{const a=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;const l=[];e.targetChanges.forEach(((p,f)=>{const g=i.get(f);if(!g)return;l.push(t.Pi.removeMatchingKeys(s,p.removedDocuments,f).next((()=>t.Pi.addMatchingKeys(s,p.addedDocuments,f))));let E=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?E=E.withResumeToken(Xe.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):p.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(p.resumeToken,n)),i=i.insert(f,E),(function(M,V,x){return M.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=Qy?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0})(g,E,p)&&l.push(t.Pi.updateTargetData(s,E))}));let c=_r(),h=fe();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))})),l.push(Zy(s,a,e.documentUpdates).next((p=>{c=p.ks,h=p.qs}))),!n.isEqual(te.min())){const p=t.Pi.getLastRemoteSnapshotVersion(s).next((f=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,n)));l.push(p)}return L.waitFor(l).next((()=>a.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,c,h))).next((()=>c))})).then((s=>(t.Ms=i,s)))}function Zy(r,e,t){let n=fe(),i=fe();return t.forEach((s=>n=n.add(s))),e.getEntries(r,n).next((s=>{let a=_r();return t.forEach(((l,c)=>{const h=s.get(l);c.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(l)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(l,c.readTime),a=a.insert(l,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(l,c)):j(Ta,"Ignoring outdated watch update for ",l,". Current version:",h.version," Watch version:",c.version)})),{ks:a,qs:i}}))}function ev(r,e){const t=he(r);return t.persistence.runTransaction("Allocate target","readwrite",(n=>{let i;return t.Pi.getTargetData(n,e).next((s=>s?(i=s,L.resolve(i)):t.Pi.allocateTargetId(n).next((a=>(i=new or(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,i).next((()=>i)))))))})).then((n=>{const i=t.Ms.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n}))}async function Fo(r,e,t){const n=he(r),i=n.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,(a=>n.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!En(a))throw a;j(Ta,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Ms=n.Ms.remove(e),n.xs.delete(i.target)}function Fu(r,e,t){const n=he(r);let i=te.min(),s=fe();return n.persistence.runTransaction("Execute query","readwrite",(a=>(function(c,h,p){const f=he(c),g=f.xs.get(p);return g!==void 0?L.resolve(f.Ms.get(g)):f.Pi.getTargetData(h,p)})(n,a,Lt(e)).next((l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(a,l.targetId).next((c=>{s=c}))})).next((()=>n.Fs.getDocumentsMatchingQuery(a,e,t?i:te.min(),t?s:fe()))).next((l=>(tv(n,H_(e),l),{documents:l,Qs:s})))))}function tv(r,e,t){let n=r.Os.get(e)||te.min();t.forEach(((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)})),r.Os.set(e,n)}class Uu{constructor(){this.activeTargetIds=Y_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rv{constructor(){this.Mo=new Uu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Uu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nv{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u="ConnectivityMonitor";class Bu{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){j($u,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){j($u,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gi=null;function Uo(){return Gi===null?Gi=(function(){return 268435456+Math.round(2147483648*Math.random())})():Gi++,"0x"+Gi.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo="RestConnection",iv={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sv{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${i}`,this.Wo=this.databaseId.database===ms?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Go(e,t,n,i,s){const a=Uo(),l=this.zo(e,t.toUriEncodedString());j(oo,`Sending RPC '${e}' ${a}:`,l,n);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,s);const{host:h}=new URL(l),p=aa(h);return this.Jo(e,l,c,n,p).then((f=>(j(oo,`Received RPC '${e}' ${a}: `,f),f)),(f=>{throw hn(oo,`RPC '${e}' ${a} failed with error: `,f,"url: ",l,"request:",n),f}))}Ho(e,t,n,i,s,a){return this.Go(e,t,n,i,s)}jo(e,t,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+vn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),n&&n.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){const n=iv[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const et="WebChannelConnection";class av extends sv{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const a=Uo();return new Promise(((l,c)=>{const h=new ch;h.setWithCredentials(!0),h.listenOnce(hh.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case es.NO_ERROR:const f=h.getResponseJson();j(et,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(f)),l(f);break;case es.TIMEOUT:j(et,`RPC '${e}' ${a} timed out`),c(new Y(B.DEADLINE_EXCEEDED,"Request time out"));break;case es.HTTP_ERROR:const g=h.getStatus();if(j(et,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const C=E?.error;if(C&&C.status&&C.message){const M=(function(x){const k=x.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(k)>=0?k:B.UNKNOWN})(C.status);c(new Y(M,C.message))}else c(new Y(B.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new Y(B.UNAVAILABLE,"Connection failed."));break;default:ne(9055,{l_:e,streamId:a,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{j(et,`RPC '${e}' ${a} completed.`)}}));const p=JSON.stringify(i);j(et,`RPC '${e}' ${a} sending request:`,i),h.send(t,"POST",p,n,15)}))}T_(e,t,n){const i=Uo(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=ph(),l=fh(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const p=s.join("");j(et,`Creating RPC '${e}' stream ${i}: ${p}`,c);const f=a.createWebChannel(p,c);this.I_(f);let g=!1,E=!1;const C=new ov({Yo:V=>{E?j(et,`Not sending because RPC '${e}' stream ${i} is closed:`,V):(g||(j(et,`Opening RPC '${e}' stream ${i} transport.`),f.open(),g=!0),j(et,`RPC '${e}' stream ${i} sending:`,V),f.send(V))},Zo:()=>f.close()}),M=(V,x,k)=>{V.listen(x,(F=>{try{k(F)}catch(J){setTimeout((()=>{throw J}),0)}}))};return M(f,jn.EventType.OPEN,(()=>{E||(j(et,`RPC '${e}' stream ${i} transport opened.`),C.o_())})),M(f,jn.EventType.CLOSE,(()=>{E||(E=!0,j(et,`RPC '${e}' stream ${i} transport closed`),C.a_(),this.E_(f))})),M(f,jn.EventType.ERROR,(V=>{E||(E=!0,hn(et,`RPC '${e}' stream ${i} transport errored. Name:`,V.name,"Message:",V.message),C.a_(new Y(B.UNAVAILABLE,"The operation could not be completed")))})),M(f,jn.EventType.MESSAGE,(V=>{if(!E){const x=V.data[0];Pe(!!x,16349);const k=x,F=k?.error||k[0]?.error;if(F){j(et,`RPC '${e}' stream ${i} received error:`,F);const J=F.status;let Q=(function(_){const y=Fe[_];if(y!==void 0)return Fh(y)})(J),P=F.message;Q===void 0&&(Q=B.INTERNAL,P="Unknown error status: "+J+" with message "+F.message),E=!0,C.a_(new Y(Q,P)),f.close()}else j(et,`RPC '${e}' stream ${i} received:`,x),C.u_(x)}})),M(l,dh.STAT_EVENT,(V=>{V.stat===Ro.PROXY?j(et,`RPC '${e}' stream ${i} detected buffering proxy`):V.stat===Ro.NOPROXY&&j(et,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function ao(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(r){return new py(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-n);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ju="PersistentStream";class lv{constructor(e,t,n,i,s,a,l,c){this.Mi=e,this.S_=n,this.b_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Jh(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===B.RESOURCE_EXHAUSTED?(Kt(t.toString()),Kt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,i])=>{this.D_===t&&this.G_(n,i)}),(n=>{e((()=>{const i=new Y(B.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(i)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{n((()=>this.z_(i)))})),this.stream.onMessage((i=>{n((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return j(ju,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(j(ju,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uv extends lv{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=vy(this.serializer,e),n=(function(s){if(!("targetChange"in s))return te.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?te.min():a.readTime?on(a.readTime):te.min()})(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=ku(this.serializer),t.addTarget=(function(s,a){let l;const c=a.target;if(l=No(c)?{documents:Ey(s,c)}:{query:wy(s,c).ft},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){l.resumeToken=gy(s,a.resumeToken);const h=Mo(s,a.expectedCount);h!==null&&(l.expectedCount=h)}else if(a.snapshotVersion.compareTo(te.min())>0){l.readTime=my(s,a.snapshotVersion.toTimestamp());const h=Mo(s,a.expectedCount);h!==null&&(l.expectedCount=h)}return l})(this.serializer,e);const n=Iy(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=ku(this.serializer),t.removeTarget=e,this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{}class hv extends cv{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new Y(B.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,a])=>this.connection.Go(e,Oo(t,n),i,s,a))).catch((s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Y(B.UNKNOWN,s.toString())}))}Ho(e,t,n,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Ho(e,Oo(t,n),i,a,l,s))).catch((a=>{throw a.name==="FirebaseError"?(a.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Y(B.UNKNOWN,a.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class dv{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Kt(t),this.aa=!1):j("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gn="RemoteStore";class fv{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((a=>{n.enqueueAndForget((async()=>{yi(this)&&(j(gn,"Restarting streams for network reachability change."),await(async function(c){const h=he(c);h.Ea.add(4),await _i(h),h.Ra.set("Unknown"),h.Ea.delete(4),await Ms(h)})(this))}))})),this.Ra=new dv(n,i)}}async function Ms(r){if(yi(r))for(const e of r.da)await e(!0)}async function _i(r){for(const e of r.da)await e(!1)}function Zh(r,e){const t=he(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),ba(t)?Ra(t):wn(t).O_()&&Aa(t,e))}function Ia(r,e){const t=he(r),n=wn(t);t.Ia.delete(e),n.O_()&&ed(t,e),t.Ia.size===0&&(n.O_()?n.L_():yi(t)&&t.Ra.set("Unknown"))}function Aa(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}wn(r).Y_(e)}function ed(r,e){r.Va.Ue(e),wn(r).Z_(e)}function Ra(r){r.Va=new cy({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),wn(r).start(),r.Ra.ua()}function ba(r){return yi(r)&&!wn(r).x_()&&r.Ia.size>0}function yi(r){return he(r).Ea.size===0}function td(r){r.Va=void 0}async function pv(r){r.Ra.set("Online")}async function mv(r){r.Ia.forEach(((e,t)=>{Aa(r,e)}))}async function gv(r,e){td(r),ba(r)?(r.Ra.ha(e),Ra(r)):r.Ra.set("Unknown")}async function _v(r,e,t){if(r.Ra.set("Online"),e instanceof $h&&e.state===2&&e.cause)try{await(async function(i,s){const a=s.cause;for(const l of s.targetIds)i.Ia.has(l)&&(await i.remoteSyncer.rejectListen(l,a),i.Ia.delete(l),i.Va.removeTarget(l))})(r,e)}catch(n){j(gn,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await zu(r,n)}else if(e instanceof is?r.Va.Ze(e):e instanceof Uh?r.Va.st(e):r.Va.tt(e),!t.isEqual(te.min()))try{const n=await Yh(r.localStore);t.compareTo(n)>=0&&await(function(s,a){const l=s.Va.Tt(a);return l.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const p=s.Ia.get(h);p&&s.Ia.set(h,p.withResumeToken(c.resumeToken,a))}})),l.targetMismatches.forEach(((c,h)=>{const p=s.Ia.get(c);if(!p)return;s.Ia.set(c,p.withResumeToken(Xe.EMPTY_BYTE_STRING,p.snapshotVersion)),ed(s,c);const f=new or(p.target,c,h,p.sequenceNumber);Aa(s,f)})),s.remoteSyncer.applyRemoteEvent(l)})(r,t)}catch(n){j(gn,"Failed to raise snapshot:",n),await zu(r,n)}}async function zu(r,e,t){if(!En(e))throw e;r.Ea.add(1),await _i(r),r.Ra.set("Offline"),t||(t=()=>Yh(r.localStore)),r.asyncQueue.enqueueRetryable((async()=>{j(gn,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Ms(r)}))}async function Hu(r,e){const t=he(r);t.asyncQueue.verifyOperationInProgress(),j(gn,"RemoteStore received new credentials");const n=yi(t);t.Ea.add(3),await _i(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Ms(t)}async function yv(r,e){const t=he(r);e?(t.Ea.delete(2),await Ms(t)):e||(t.Ea.add(2),await _i(t),t.Ra.set("Unknown"))}function wn(r){return r.ma||(r.ma=(function(t,n,i){const s=he(t);return s.sa(),new uv(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(r.datastore,r.asyncQueue,{Xo:pv.bind(null,r),t_:mv.bind(null,r),r_:gv.bind(null,r),H_:_v.bind(null,r)}),r.da.push((async e=>{e?(r.ma.B_(),ba(r)?Ra(r):r.Ra.set("Unknown")):(await r.ma.stop(),td(r))}))),r.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new sn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((a=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,l=new Sa(e,t,a,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Y(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rd(r,e){if(Kt("AsyncQueue",`${e}: ${r}`),En(r))return new Y(B.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{static emptySet(e){return new an(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||X.comparator(t.key,n.key):(t,n)=>X.comparator(t.key,n.key),this.keyedMap=zn(),this.sortedSet=new Le(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new an;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){this.ga=new Le(X.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ne(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class _n{constructor(e,t,n,i,s,a,l,c,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,i,s){const a=[];return t.forEach((l=>{a.push({type:0,doc:l})})),new _n(e,t,an.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Vs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Ev{constructor(){this.queries=Wu(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=he(t),s=i.queries;i.queries=Wu(),s.forEach(((a,l)=>{for(const c of l.Sa)c.onError(n)}))})(this,new Y(B.ABORTED,"Firestore shutting down"))}}function Wu(){return new Mr((r=>Ph(r)),Vs)}async function wv(r,e){const t=he(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.ba()&&e.Da()&&(n=2):(s=new vv,n=e.Da()?0:1);try{switch(n){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const l=rd(a,`Initialization of query '${Zr(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&Ca(t)}async function Tv(r,e){const t=he(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const a=s.Sa.indexOf(e);a>=0&&(s.Sa.splice(a,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function Iv(r,e){const t=he(r);let n=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const l of a.Sa)l.Fa(i)&&(n=!0);a.wa=i}}n&&Ca(t)}function Av(r,e,t){const n=he(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function Ca(r){r.Ca.forEach((e=>{e.next()}))}var $o,Gu;(Gu=$o||($o={})).Ma="default",Gu.Cache="cache";class Rv{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new _n(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=_n.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==$o.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.key=e}}class id{constructor(e){this.key=e}}class bv{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=fe(),this.mutatedKeys=fe(),this.eu=Dh(e),this.tu=new an(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new qu,i=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,l=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((p,f)=>{const g=i.get(p),E=Ns(this.query,f)?f:null,C=!!g&&this.mutatedKeys.has(g.key),M=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let V=!1;g&&E?g.data.isEqual(E.data)?C!==M&&(n.track({type:3,doc:E}),V=!0):this.su(g,E)||(n.track({type:2,doc:E}),V=!0,(c&&this.eu(E,c)>0||h&&this.eu(E,h)<0)&&(l=!0)):!g&&E?(n.track({type:0,doc:E}),V=!0):g&&!E&&(n.track({type:1,doc:g}),V=!0,(c||h)&&(l=!0)),V&&(E?(a=a.add(E),s=M?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))})),this.query.limit!==null)for(;a.size>this.query.limit;){const p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),n.track({type:1,doc:p})}return{tu:a,iu:n,Cs:l,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort(((p,f)=>(function(E,C){const M=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne(20277,{Rt:V})}};return M(E)-M(C)})(p.type,f.type)||this.eu(p.doc,f.doc))),this.ou(n),i=i??!1;const l=t&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,h=c!==this.Za;return this.Za=c,a.length!==0||h?{snapshot:new _n(this.query,e.tu,s,a,e.mutatedKeys,c===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:l}:{au:l}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new qu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=fe(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const t=[];return e.forEach((n=>{this.Xa.has(n)||t.push(new id(n))})),this.Xa.forEach((n=>{e.has(n)||t.push(new nd(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=fe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _n.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Pa="SyncEngine";class Sv{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Cv{constructor(e){this.key=e,this.hu=!1}}class Pv{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Mr((l=>Ph(l)),Vs),this.Iu=new Map,this.Eu=new Set,this.du=new Le(X.comparator),this.Au=new Map,this.Ru=new va,this.Vu={},this.mu=new Map,this.fu=mn.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Dv(r,e,t=!0){const n=ud(r);let i;const s=n.Tu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await sd(n,e,t,!0),i}async function Vv(r,e){const t=ud(r);await sd(t,e,!0,!1)}async function sd(r,e,t,n){const i=await ev(r.localStore,Lt(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t);let l;return n&&(l=await Nv(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&Zh(r.remoteStore,i),l}async function Nv(r,e,t,n,i){r.pu=(f,g,E)=>(async function(M,V,x,k){let F=V.view.ru(x);F.Cs&&(F=await Fu(M.localStore,V.query,!1).then((({documents:I})=>V.view.ru(I,F))));const J=k&&k.targetChanges.get(V.targetId),Q=k&&k.targetMismatches.get(V.targetId)!=null,P=V.view.applyChanges(F,M.isPrimaryClient,J,Q);return Qu(M,V.targetId,P.au),P.snapshot})(r,f,g,E);const s=await Fu(r.localStore,e,!0),a=new bv(e,s.Qs),l=a.ru(s.documents),c=gi.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),h=a.applyChanges(l,r.isPrimaryClient,c);Qu(r,t,h.au);const p=new Sv(e,t,a);return r.Tu.set(e,p),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),h.snapshot}async function xv(r,e,t){const n=he(r),i=n.Tu.get(e),s=n.Iu.get(i.targetId);if(s.length>1)return n.Iu.set(i.targetId,s.filter((a=>!Vs(a,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Fo(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Ia(n.remoteStore,i.targetId),Bo(n,i.targetId)})).catch(bs)):(Bo(n,i.targetId),await Fo(n.localStore,i.targetId,!0))}async function kv(r,e){const t=he(r),n=t.Tu.get(e),i=t.Iu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Ia(t.remoteStore,n.targetId))}async function od(r,e){const t=he(r);try{const n=await Jy(t.localStore,e);e.targetChanges.forEach(((i,s)=>{const a=t.Au.get(s);a&&(Pe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.hu=!0:i.modifiedDocuments.size>0?Pe(a.hu,14607):i.removedDocuments.size>0&&(Pe(a.hu,42227),a.hu=!1))})),await ld(t,n,e)}catch(n){await bs(n)}}function Ku(r,e,t){const n=he(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Tu.forEach(((s,a)=>{const l=a.view.va(e);l.snapshot&&i.push(l.snapshot)})),(function(a,l){const c=he(a);c.onlineState=l;let h=!1;c.queries.forEach(((p,f)=>{for(const g of f.Sa)g.va(l)&&(h=!0)})),h&&Ca(c)})(n.eventManager,e),i.length&&n.Pu.H_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Lv(r,e,t){const n=he(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Au.get(e),s=i&&i.key;if(s){let a=new Le(X.comparator);a=a.insert(s,rt.newNoDocument(s,te.min()));const l=fe().add(s),c=new Ls(te.min(),new Map,new Le(le),a,l);await od(n,c),n.du=n.du.remove(s),n.Au.delete(e),Da(n)}else await Fo(n.localStore,e,!1).then((()=>Bo(n,e,t))).catch(bs)}function Bo(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach((n=>{r.Ru.containsKey(n)||ad(r,n)}))}function ad(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(Ia(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),Da(r))}function Qu(r,e,t){for(const n of t)n instanceof nd?(r.Ru.addReference(n.key,e),Mv(r,n)):n instanceof id?(j(Pa,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||ad(r,n.key)):ne(19791,{wu:n})}function Mv(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(j(Pa,"New document in limbo: "+t),r.Eu.add(n),Da(r))}function Da(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new X(Ce.fromString(e)),n=r.fu.next();r.Au.set(n,new Cv(t)),r.du=r.du.insert(t,n),Zh(r.remoteStore,new or(Lt(ma(t.path)),n,"TargetPurposeLimboResolution",Ss.ce))}}async function ld(r,e,t){const n=he(r),i=[],s=[],a=[];n.Tu.isEmpty()||(n.Tu.forEach(((l,c)=>{a.push(n.pu(c,e,t).then((h=>{if((h||t)&&n.isPrimaryClient){const p=h?!h.fromCache:t?.targetChanges.get(c.targetId)?.current;n.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(h){i.push(h);const p=wa.As(c.targetId,h);s.push(p)}})))})),await Promise.all(a),n.Pu.H_(i),await(async function(c,h){const p=he(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(f=>L.forEach(h,(g=>L.forEach(g.Es,(E=>p.persistence.referenceDelegate.addReference(f,g.targetId,E))).next((()=>L.forEach(g.ds,(E=>p.persistence.referenceDelegate.removeReference(f,g.targetId,E)))))))))}catch(f){if(!En(f))throw f;j(Ta,"Failed to update sequence numbers: "+f)}for(const f of h){const g=f.targetId;if(!f.fromCache){const E=p.Ms.get(g),C=E.snapshotVersion,M=E.withLastLimboFreeSnapshotVersion(C);p.Ms=p.Ms.insert(g,M)}}})(n.localStore,s))}async function Ov(r,e){const t=he(r);if(!t.currentUser.isEqual(e)){j(Pa,"User change. New user:",e.toKey());const n=await Qh(t.localStore,e);t.currentUser=e,(function(s,a){s.mu.forEach((l=>{l.forEach((c=>{c.reject(new Y(B.CANCELLED,a))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await ld(t,n.Ls)}}function Fv(r,e){const t=he(r),n=t.Au.get(e);if(n&&n.hu)return fe().add(n.key);{let i=fe();const s=t.Iu.get(e);if(!s)return i;for(const a of s){const l=t.Tu.get(a);i=i.unionWith(l.view.nu)}return i}}function ud(r){const e=he(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=od.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Fv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Lv.bind(null,e),e.Pu.H_=Iv.bind(null,e.eventManager),e.Pu.yu=Av.bind(null,e.eventManager),e}class ws{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Xy(this.persistence,new Ky,e.initialUser,this.serializer)}Cu(e){return new Kh(Ea.mi,this.serializer)}Du(e){return new rv}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ws.provider={build:()=>new ws};class Uv extends ws{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Pe(this.persistence.referenceDelegate instanceof Es,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new xy(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?lt.withCacheSize(this.cacheSizeBytes):lt.DEFAULT;return new Kh((n=>Es.mi(n,t)),this.serializer)}}class jo{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Ku(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=Ov.bind(null,this.syncEngine),await yv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Ev})()}createDatastore(e){const t=Xh(e.databaseInfo.databaseId),n=(function(s){return new av(s)})(e.databaseInfo);return(function(s,a,l,c){return new hv(s,a,l,c)})(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return(function(n,i,s,a,l){return new fv(n,i,s,a,l)})(this.localStore,this.datastore,e.asyncQueue,(t=>Ku(this.syncEngine,t,0)),(function(){return Bu.v()?new Bu:new nv})())}createSyncEngine(e,t){return(function(i,s,a,l,c,h,p){const f=new Pv(i,s,a,l,c,h);return p&&(f.gu=!0),f})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){const n=he(t);j(gn,"RemoteStore shutting down."),n.Ea.add(5),await _i(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}jo.provider={build:()=>new jo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Kt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr="FirestoreClient";class Bv{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=tt.UNAUTHENTICATED,this.clientId=ca.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,(async a=>{j(yr,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(n,(a=>(j(yr,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new sn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=rd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function lo(r,e){r.asyncQueue.verifyOperationInProgress(),j(yr,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener((async i=>{n.isEqual(i)||(await Qh(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener((()=>r.terminate())),r._offlineComponents=e}async function Yu(r,e){r.asyncQueue.verifyOperationInProgress();const t=await jv(r);j(yr,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener((n=>Hu(e.remoteStore,n))),r.setAppCheckTokenChangeListener(((n,i)=>Hu(e.remoteStore,i))),r._onlineComponents=e}async function jv(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){j(yr,"Using user provided OfflineComponentProvider");try{await lo(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;hn("Error using user provided cache. Falling back to memory cache: "+t),await lo(r,new ws)}}else j(yr,"Using default OfflineComponentProvider"),await lo(r,new Uv(void 0));return r._offlineComponents}async function zv(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(j(yr,"Using user provided OnlineComponentProvider"),await Yu(r,r._uninitializedComponentsProvider._online)):(j(yr,"Using default OnlineComponentProvider"),await Yu(r,new jo))),r._onlineComponents}async function Xu(r){const e=await zv(r),t=e.eventManager;return t.onListen=Dv.bind(null,e.syncEngine),t.onUnlisten=xv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Vv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=kv.bind(null,e.syncEngine),t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hd="firestore.googleapis.com",Zu=!0;class ec{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Y(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hd,this.ssl=Zu}else this.host=e.host,this.ssl=e.ssl??Zu;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Gh;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Vy)throw new Y(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}h_("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cd(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Y(B.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Y(B.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Y(B.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,i){return n.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Va{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ec({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Y(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Y(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ec(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new e_;switch(n.type){case"firstParty":return new i_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Y(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const n=Ju.get(t);n&&(j("ComponentProvider","Removing Datastore"),Ju.delete(t),n.terminate())})(this),Promise.resolve()}}function Hv(r,e,t,n={}){r=ts(r,Va);const i=aa(e),s=r._getSettings(),a={...s,emulatorOptions:r._getEmulatorOptions()},l=`${e}:${t}`;i&&(Pm(`https://${l}`),xm("Firestore",!0)),s.host!==hd&&s.host!==l&&hn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...s,host:l,ssl:i,emulatorOptions:n};if(!ds(c,a)&&(r._setSettings(c),n.mockUserToken)){let h,p;if(typeof n.mockUserToken=="string")h=n.mockUserToken,p=tt.MOCK_USER;else{h=Dm(n.mockUserToken,r._app?.options.projectId);const f=n.mockUserToken.sub||n.mockUserToken.user_id;if(!f)throw new Y(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new tt(f)}r._authCredentials=new t_(new gh(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Os(this.firestore,e,this._query)}}class ot{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new li(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ot(this.firestore,e,this._key)}toJSON(){return{type:ot._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(pi(t,ot._jsonSchema))return new ot(e,n||null,new X(Ce.fromString(t.referencePath)))}}ot._jsonSchemaVersion="firestore/documentReference/1.0",ot._jsonSchema={type:$e("string",ot._jsonSchemaVersion),referencePath:$e("string")};class li extends Os{constructor(e,t,n){super(e,t,ma(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ot(this.firestore,null,new X(e))}withConverter(e){return new li(this.firestore,e,this._path)}}function qv(r,e,...t){if(r=rh(r),arguments.length===1&&(e=ca.newId()),c_("doc","path",e),r instanceof Va){const n=Ce.fromString(e,...t);return du(n),new ot(r,null,new X(n))}{if(!(r instanceof ot||r instanceof li))throw new Y(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Ce.fromString(e,...t));return du(n),new ot(r.firestore,r instanceof li?r.converter:null,new X(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tc="AsyncQueue";class rc{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Jh(this,"async_queue_retry"),this._c=()=>{const n=ao();n&&j(tc,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=ao();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ao();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new sn;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!En(e))throw e;j(tc,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Kt("INTERNAL UNHANDLED ERROR: ",nc(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const i=Sa.createAndSchedule(this,e,t,n,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&ne(47125,{Pc:nc(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,n)=>t.targetTimeMs-n.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function nc(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(r){return(function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1})(r,["next","error","complete"])}class zo extends Va{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new rc,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rc(e),this._firestoreClient=void 0,await e}}}function Wv(r,e){const t=typeof r=="object"?r:zg(),n=typeof r=="string"?r:ms,i=Fg(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=Sm("firestore");s&&Hv(i,...s)}return i}function Gv(r){if(r._terminated)throw new Y(B.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||Kv(r),r._firestoreClient}function Kv(r){const e=r._freezeSettings(),t=(function(i,s,a,l){return new R_(i,s,a,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,cd(l.experimentalLongPollingOptions),l.useFetchStreams,l.isUsingEmulator)})(r._databaseId,r._app?.options.appId||"",r._persistenceKey,e);r._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new Bv(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&(function(i){const s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nt(Xe.fromBase64String(e))}catch(t){throw new Y(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nt(Xe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Nt._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pi(e,Nt._jsonSchema))return Nt.fromBase64String(e.bytes)}}Nt._jsonSchemaVersion="firestore/bytes/1.0",Nt._jsonSchema={type:$e("string",Nt._jsonSchemaVersion),bytes:$e("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Y(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Y(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Y(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cr._jsonSchemaVersion}}static fromJSON(e){if(pi(e,cr._jsonSchema))return new cr(e.latitude,e.longitude)}}cr._jsonSchemaVersion="firestore/geoPoint/1.0",cr._jsonSchema={type:$e("string",cr._jsonSchemaVersion),latitude:$e("number"),longitude:$e("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:hr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pi(e,hr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new hr(e.vectorValues);throw new Y(B.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}hr._jsonSchemaVersion="firestore/vectorValue/1.0",hr._jsonSchema={type:$e("string",hr._jsonSchemaVersion),vectorValues:$e("object")};const Qv=new RegExp("[~\\*/\\[\\]]");function Yv(r,e,t){if(e.search(Qv)>=0)throw sc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new dd(...e.split("."))._internalPath}catch{throw sc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function sc(r,e,t,n,i){let s=`Function ${e}() called with invalid data`;s+=". ";let a="";return new Y(B.INVALID_ARGUMENT,s+r+a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ot(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Xv(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(pd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Xv extends fd{data(){return super.data()}}function pd(r,e){return typeof e=="string"?Yv(r,e):e instanceof dd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jv(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Y(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Zv{convertValue(e,t="none"){switch(gr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ke(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(mr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ne(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return mi(e,((i,s)=>{n[i]=this.convertValue(s,t)})),n}convertVectorValue(e){const t=e.fields?.[Co].arrayValue?.values?.map((n=>ke(n.doubleValue)));return new hr(t)}convertGeoPoint(e){return new cr(ke(e.latitude),ke(e.longitude))}convertArray(e,t){return(e.values||[]).map((n=>this.convertValue(n,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Ps(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(si(e));default:return null}}convertTimestamp(e){const t=pr(e);return new Ue(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ce.fromString(e);Pe(Wh(n),9688,{name:e});const i=new oi(n.get(1),n.get(3)),s=new X(n.popFirst(5));return i.isEqual(t)||Kt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}class qn{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Vr extends fd{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new ss(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(pd("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(B.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Vr._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Vr._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vr._jsonSchema={type:$e("string",Vr._jsonSchemaVersion),bundleSource:$e("string","DocumentSnapshot"),bundleName:$e("string"),bundle:$e("string")};class ss extends Vr{data(e={}){return super.data(e)}}class ln{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new qn(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new ss(this._firestore,this._userDataWriter,n.key,n,new qn(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Y(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map((l=>{const c=new ss(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qn(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}}))}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((l=>s||l.type!==3)).map((l=>{const c=new ss(i._firestore,i._userDataWriter,l.doc.key,l.doc,new qn(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,p=-1;return l.type!==0&&(h=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),l.type!==1&&(a=a.add(l.doc),p=a.indexOf(l.doc.key)),{type:eE(l.type),doc:c,oldIndex:h,newIndex:p}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Y(B.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ln._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ca.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function eE(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne(61501,{type:r})}}ln._jsonSchemaVersion="firestore/querySnapshot/1.0",ln._jsonSchema={type:$e("string",ln._jsonSchemaVersion),bundleSource:$e("string","QuerySnapshot"),bundleName:$e("string"),bundle:$e("string")};class md extends Zv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ot(this.firestore,null,t)}}function tE(r,...e){r=rh(r);let t={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||ic(e[n])||(t=e[n++]);const i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(ic(e[n])){const c=e[n];e[n]=c.next?.bind(c),e[n+1]=c.error?.bind(c),e[n+2]=c.complete?.bind(c)}let s,a,l;if(r instanceof ot)a=ts(r.firestore,zo),l=ma(r._key.path),s={next:c=>{e[n]&&e[n](rE(a,r,c))},error:e[n+1],complete:e[n+2]};else{const c=ts(r,Os);a=ts(c.firestore,zo),l=c._query;const h=new md(a);s={next:p=>{e[n]&&e[n](new ln(a,h,c,p))},error:e[n+1],complete:e[n+2]},Jv(r._query)}return(function(h,p,f,g){const E=new $v(g),C=new Rv(p,E,f);return h.asyncQueue.enqueueAndForget((async()=>wv(await Xu(h),C))),()=>{E.Nu(),h.asyncQueue.enqueueAndForget((async()=>Tv(await Xu(h),C)))}})(Gv(a),l,i,s)}function rE(r,e,t){const n=t.docs.get(e._key),i=new md(r);return new Vr(r,i,e._key,n,new qn(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){vn=i})(jg),ps(new ri("firestore",((n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),l=new zo(new r_(n.getProvider("auth-internal")),new s_(a,n.getProvider("app-check-internal")),(function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Y(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oi(h.options.projectId,p)})(a,i),a);return s={useFetchStreams:t,...s},l._setSettings(s),l}),"PUBLIC").setMultipleInstances(!0)),nn(lu,uu,e),nn(lu,uu,"esm2020")})();var nE="firebase",iE="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */nn(nE,iE,"app");const sE={apiKey:"AIzaSyDFOBqf8hyd3aMi6iENM6RYMpl7SA-jT_U",authDomain:"database-99996.firebaseapp.com",projectId:"database-99996",storageBucket:"database-99996.firebasestorage.app",messagingSenderId:"114068892226",appId:"1:114068892226:web:04bff3a786380f48e3dbdb",measurementId:"G-1HQS26V8V6"},oE=oh(sE),aE=Wv(oE);function lE(r){let e=[];try{typeof r=="string"?e=JSON.parse(r):Array.isArray(r)?e=r:r!=null&&(e=[r])}catch(t){return console.error("Failed to parse sensors JSON:",t,r),[]}return e.map(t=>({sensor:t.Sensor??t.sensor??"",measurement:Number(t.Measurement??t.measurement??0),unit:t.Unit??t.unit??"",category:t.Category??t.category??""}))}function uE(){const[r,e]=it([]),[t,n]=it([]),[i,s]=it("");return Wt(()=>{const a=qv(aE,"sensors","latestData"),l=tE(a,c=>{if(!c.exists()){s("No Firestore data found.");return}const h=c.data().data;if(!h||typeof h!="string"){s("Invalid Firestore data format.");return}const p=JSON.parse(h),f=lE(p.sensors),g=f.filter(C=>C.category==="Header"),E=f.filter(C=>C.category==="Separator");e(g),n(E),s("")},c=>{console.error("❌ Firestore snapshot error:",c),s("Failed to fetch data.")});return()=>l()},[]),ee("div",{className:"dashboard",children:[i&&ee("p",{className:"error",children:i}),ee(Ql,{heading:"Header Sensors",sensors:r}),ee(Ql,{heading:"Separator Sensors",sensors:t})]})}const oc=({goTo:r})=>{const e=Hc();return ee("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black",children:ee("div",{className:"bg-white/10 backdrop-blur-lg border border-gray-700 rounded-2xl shadow-2xl p-8 w-full max-w-md text-center animate-fadeIn",children:[ee("div",{className:"mx-auto mb-4 w-16 h-16 flex items-center justify-center rounded-full bg-red-500/20",children:ee("span",{className:"text-red-500 text-3xl",children:"⚠️"})}),ee("h1",{className:"text-xl font-semibold text-red-400 mb-2",children:"Invalid URL"}),ee("p",{className:"text-gray-300 mb-6",children:"You have entered a wrong URL. Please go back to previous page."}),ee("button",{onClick:()=>{e(r)},className:"w-full cursor-pointer py-3 rounded-lg bg-red-500 hover:bg-red-600 text-white font-medium shadow-lg transition duration-200",children:"Go Back"})]})})},cE=()=>{const r=a=>{const l=String(a.getDate()).padStart(2,"0"),c=String(a.getMonth()+1).padStart(2,"0"),h=a.getFullYear();return`${l}-${c}-${h}`},e=a=>a.toLocaleTimeString("en-IN",{hour12:!0}),[t,n]=it(r(new Date)),[i,s]=it(e(new Date));return Wt(()=>{const a=setInterval(()=>{const l=new Date;n(r(l)),s(e(l))},1e3);return()=>clearInterval(a)},[]),ee("footer",{className:"footer",children:[ee("div",{className:"footer-left",children:["© DEVELOPED BY IOTELLIGENCE SOFTWARE SOLUTIONS |"," ",ee("a",{className:"footer-link",href:"tel:+919158151405",children:"+91 9158151405"})," ","| 2025"]}),ee("div",{className:"footer-right",children:[ee("span",{children:t}),ee("span",{children:i})]})]})},hE=()=>{const r=em([{path:"/",element:ee(uE,{}),errorElement:ee(oc,{goTo:"/"})},{path:"/login",element:ee(mm,{}),errorElement:ee(oc,{goTo:"/login"})}]);return ee("div",{className:"layout",children:[ee("header",{children:ee(pm,{})}),ee("main",{className:"content",children:ee(dm,{router:r})}),ee("footer",{children:ee(cE,{})})]})};Fd(ee(hE,{}),document.getElementById("app"));
